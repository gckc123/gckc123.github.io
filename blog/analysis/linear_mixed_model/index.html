<!DOCTYPE html>
<html lang="en-us">
    <head>
        
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="StatsNotebook is an open source statistical package based on R.">
<title>
Linear Mixed Model ( Multilevel Model) - StatsNotebook - Simple. Powerful. Reproducible.
</title>



        <meta property="og:title" content="Linear mixed model (Multilevel model) - StatsNotebook - Simple. Powerful. Reproducible." />
<meta property="og:type" content="website" />
<meta property="og:description" content="StatsNotebook is an open source statistical package based on R."/>
<meta property="og:url" content="https://statsnotebook.io/blog/analysis/linear_mixed_model/"/>
<meta property="og:site_name" content="StatsNotebook - Simple. Powerful. Reproducible."/>




<meta property="og:image" content="https://statsnotebook.io/home/profile.jpg"/>




        
<link rel="shortcut icon" href="/img/fav.ico">


        





<link rel="stylesheet" href="/css/main.min.c285da496bdc6eb125783ccd84751cbcdd365cb368c74109eccf557310b03bf7.css" integrity="sha256-woXaSWvcbrEleDzNhHUcvN02XLNox0EJ7M9VcxCwO/c=" crossorigin="anonymous" media="screen">





        
        
        
        
    </head>
    <body>
        <section id="top" class="section">
            
            <div class="container hero  fade-in one ">
                

<h1 class="bold-title is-1">StatsNotebook</h1>


            </div>
            
            <div class="section  fade-in two ">
                
<div class="container">
    <hr>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbar-menu " id="navMenu">
            
            
            
            
            <a class="navbar-item" href="/">
                
                Home
                
            </a>
            
            
            
            <a class="navbar-item" href="/about">
                
                About
                
            </a>
            
            
            
            <a class="navbar-item" href="/blog/analysis">
                
                Analysis Tutorials
                
            </a>
            
            
            
            <a class="navbar-item" href="/blog/dataviz">
                
                Data Viz Tutorials
                
            </a>
            
            
            
            <a class="navbar-item" href="/blog">
                
                Blog
                
            </a>
            
            
            
            <a class="navbar-item" href="/download">
                
                Download
                
            </a>
            
            
            
            <a class="navbar-item" href="/consultation">
                
                Training and consultation
                
            </a>
            
            
            
        </div>
    </nav>
    <hr>
</div>



                
<div class="container">
    <h2 class="title is-1 top-pad strong-post-title">
        <a href="https://statsnotebook.io/blog/analysis/linear_mixed_model/">Linear mixed model (Multilevel model)</a>
    </h2>
    <div class="post-data">
        20 Oct, 2020 |
        22 minutes read
    </div>
    
    <div class="blog-share">
        Share this:
        
        <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Linear%20mixed%20model%20%28Multilevel%20model%29%20https%3a%2f%2fstatsnotebook.io%2fblog%2fanalysis%2flinear_mixed_model%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fab fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>
        
        
        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fstatsnotebook.io%2fblog%2fanalysis%2flinear_mixed_model%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fab fa-facebook-f"></i>
            <span class="hidden">Facebook</span>
        </a>
        
        
        
    </div>
    
    
    
    <p>
        Tags:
        
        <a href="/tags/analysis">Analysis</a>,
        
        <a href="/tags/r-code">R code</a>,
        
        <a href="/tags/linear-model">Linear model</a>,
        
        <a href="/tags/regression">Regression</a>
        
    </p>
    
</div>

<div class="container markdown top-pad">
    <p>Data with multilevel (hierarchical) structure are common in many area of research. In our tutorial on <a href="../moderation_interaction_regression" title="moderation analysis">moderation analysis</a>, we examine the impact of increasing alcohol tax in Queensland on alcohol consumption. We compared changes in alcohol consumption for individuals from Queensland before and after the implementation of tax increase, compared to changes in alcohol consumption in other states. The data were collected from individuals from different postcodes in different states. Therefore, individual observations are <em>nested</em> within postcodes. Since it is likely that individuals from the same postcodes are more similar compared to individuals from different postcodes (because of similar local drinking culture, similar level of exposure to local advertisement, etc), the assumption of independent observation is likely to be violated. <strong>Linear mixed model</strong> (also known as multilevel model and random effect model) can be used to account for the dependencies in the data.</p>

<h4 id="examples-of-nested-data-structure" class="anchor-link"><a href="#examples-of-nested-data-structure">Examples of nested data structure</a></h4>
<p>Other examples of data with nested structure include</p>
<ol>
<li>Longitudinal data - Multiple measurements taken from the same individual are not independent</li>
<li>School data - Students from the same school shared the same learning environment and school culture.</li>
<li>Treatment data - Patients of the same doctor might have more similar outcome compared to patients of different doctors.</li>
</ol>
<p>In this tutorial, we will look at two examples</p>
<ol>
<li><a href="#sleep-deprivation-and-reaction-time-repeated-measures-design" title="Sleep deprivation and reactino time">Sleep deprivation and reaction time</a>
<ul>
<li>A study based on repeated measures of reaction time over 10 days of sleep deprivation (Belenky et al. 2003). Observations are nested within individuals, thus are not independent.</li>
<li>We will first run a <a href="#random-intercept-model">random intercept model</a> that accounts for the repeated measures design (dependencies in the data), and then run a <a href="#random-slope-model">random slope model</a> that allows the effect of sleep deprivation to vary across participants.</li>
</ul>
</li>
<li><a href="#alcohol-tax-and-alcohol-consumption" title="Alcohol tax and alcohol consumption">Alcohol tax and alcohol consumption</a>
<ul>
<li>revisit our alcohol tax example in the <a href="../moderation_interaction_regression/#categorical-independent-variable-and-categorical-moderator" title="moderation analysis">moderation analysis</a> tutorial. Individuals are nested within postcodes, thus the observations are not independent.</li>
</ul>
</li>
</ol>

<h4 id="sleep-deprivation-and-reaction-time-repeated-measures-design" class="anchor-link"><a href="#sleep-deprivation-and-reaction-time-repeated-measures-design">Sleep deprivation and reaction time (repeated measures design)</a></h4>
<p>Belenky et al (2003) studied the relationship between sleep deprivation and reaction time. We have included their data in <strong>StatsNotebook</strong> as the <strong>Sleep</strong> dataset. See <a href="../../data_management/load_example_data">load example data</a> for instruction on loading the data into <strong>StatsNotebook</strong>.</p>
<p>There are three variables in this dataset.</p>
<ol>
<li>Reaction - Reaction time (ms)</li>
<li>Days - Number of days of sleep deprivation. On day 0, the subjects had their normal amount of sleep. Starting that night they were restricted to 3 hours of sleep per night.</li>
<li>Subject - Participant ID.</li>
</ol>

<h5 id="research-question" class="anchor-link"><a href="#research-question">Research question</a></h5>
<p>Does the number of days of sleep deprivation affect reaction time?</p>
<p>It is tempting to address this research question by a simple linear regression (or a correlation analysis). However, linear regression is not appropriate because the data is not independent - Reaction time measured from the same participant are likely to be more similar to reaction time measures across participants.</p>
<p>In this analysis, we will run two separate models - a random intercept model and a random slope model. Prior to running these models, it is always good practice to <a href="/blog/dataviz">visualise the data</a> and conduct <a href="../descriptive">descriptive analysis</a>.</p>

<h5 id="random-intercept-model" class="anchor-link"><a href="#random-intercept-model">Random intercept model</a></h5>
<p>We can account for the dependencies in the data by including a <strong>random intercept</strong> for each individual. To run this model,</p>
<ol>
<li>Click <strong>Analysis</strong> at the top</li>
<li>Click <strong>Regression</strong> and select <strong>Linear Regression (Numeric outcome)</strong> from the menu</li>
<li>In the left panel, select <em>Reaction</em> into <em>Outcome</em>, <em>Days</em> into <em>Covariates</em> and <em>Subject</em> into <em>Random effect</em>.</li>
<li>Click <strong>Code and Run</strong>, the following R code will be generated in a block on the right panel, with output from R below the codes.</li>
</ol>
<p><img src="../img/random_intercept_reaction.png" alt="random intercept model - reaction time" title="random intercept model - reaction time"></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">
<span style="color:#06287e">library</span>(lme4)
<span style="color:#06287e">library</span>(lmerTest)

res <span style="color:#666">&lt;-</span> <span style="color:#06287e">lmer</span>(Reaction <span style="color:#666">~</span> Days <span style="color:#666">+</span> (<span style="color:#40a070">1</span> <span style="color:#666">|</span> Subject),
  data <span style="color:#666">=</span> currentDataset)
<span style="color:#06287e">summary</span>(res)
<span style="color:#06287e">confint</span>(res, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, method <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Wald&#34;</span>)



res.std <span style="color:#666">&lt;-</span> <span style="color:#06287e">resid</span>(res)<span style="color:#666">/</span><span style="color:#06287e">sd</span>(<span style="color:#06287e">resid</span>(res))
<span style="color:#06287e">plot</span>(res.std, ylab<span style="color:#666">=</span><span style="color:#4070a0">&#34;Standardized Residuals&#34;</span>)

<span style="color:#4070a0">&#34;Outlier Test. Observations with a Bonferroni p &lt; .05 might be considered as outliers and might need further investigation.&#34;</span>
car<span style="color:#666">::</span><span style="color:#06287e">outlierTest</span>(res)
car<span style="color:#666">::</span><span style="color:#06287e">infIndexPlot</span>(res)
<span style="color:#06287e">ggplot</span>(<span style="color:#06287e">as.data.frame</span>(res.std), <span style="color:#06287e">aes</span>(sample <span style="color:#666">=</span> res.std)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_qq</span>() <span style="color:#666">+</span>
  <span style="color:#06287e">geom_qq_line</span>()


<span style="color:#4070a0">&#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&#34;</span>
<span style="color:#4070a0">&#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&#34;</span>

</code></pre></div><br/>

<h5 id="r-codes-explained---random-intercept-model" class="anchor-link"><a href="#r-codes-explained---random-intercept-model">R codes explained - Random intercept model</a></h5>
<p>The following are from the top section of the generated codes.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">
<span style="color:#06287e">library</span>(lme4)
<span style="color:#06287e">library</span>(lmerTest)

res <span style="color:#666">&lt;-</span> <span style="color:#06287e">lmer</span>(Reaction <span style="color:#666">~</span> Days <span style="color:#666">+</span> (<span style="color:#40a070">1</span> <span style="color:#666">|</span> Subject),
  data <span style="color:#666">=</span> currentDataset)
<span style="color:#06287e">summary</span>(res)
<span style="color:#06287e">confint</span>(res, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, method <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Wald&#34;</span>)
</code></pre></div><br/>
<p>These codes tell R to run a linear mixed model using the <code>lmer</code> from the <code>lme4</code> library. The left side of the <strong>&ldquo;~&rdquo;</strong> symbol specifies the <em>dependent variable</em>; the right side specifies <em>days</em> as the independent variable. The code <code>(1 | Subject)</code> specifies a random intercept for each participant. The <code>summary</code> function is used to print out the results from the random intercept model and the <code>confint</code> function is used to print the model coefficients with the corresponding 95% confidence intervals.</p>
<p>The following is the model summary from the above codes.</p>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: Reaction ~ Days + (1 | Subject)
   Data: currentDataset

REML criterion at convergence: 1786.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2257 -0.5529  0.0109  0.5188  4.2506 

Random effects:
 Groups   Name        Variance Std.Dev.
 Subject  (Intercept) 1378.2   37.12   
 Residual              960.5   30.99   
Number of obs: 180, groups:  Subject, 18

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept) 251.4051     9.7467  22.8102   25.79   &lt;2e-16 ***
Days         10.4673     0.8042 161.0000   13.02   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
     (Intr)
Days -0.371

######################################################
                 2.5 %    97.5 %
.sig01              NA        NA
.sigma              NA        NA
(Intercept) 232.301892 270.50832
Days          8.891041  12.04353
</code></pre><br/>

<h5 id="interpretation" class="anchor-link"><a href="#interpretation">Interpretation</a></h5>
<p>From the <strong>fixed effects</strong> section of the model summary, we can conclude that there is strong evidence that number of days of sleep deprivation significantly increased reaction time under a significance level of 0.05. On average, for each additional day of sleep deprivation, the reaction time increased by 10.47ms (b = 10.47, SE = 0.80, p &lt; .001).</p>
<pre><code>Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept) 251.4051     9.7467  22.8102   25.79   &lt;2e-16 ***
Days         10.4673     0.8042 161.0000   13.02   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

</code></pre><br/>
<p>We are 95% confident that the average increase was between 8.89 and 12.04.</p>
<pre><code>                 2.5 %    97.5 %
.sig01              NA        NA
.sigma              NA        NA
(Intercept) 232.301892 270.50832
Days          8.891041  12.04353
</code></pre><br/>
<p>In the above, we estimate that the average intercept across all participants is 251.4. Results from the <strong>random effects</strong> section below show that the variance of the intercept for <em>Subject</em> is 1378.2. Taking the square root, the standard deviation of the intercept is thus 37.1.</p>
<pre><code>Random effects:
 Groups   Name        Variance Std.Dev.
 Subject  (Intercept) 1378.2   37.12   
 Residual              960.5   30.99   
Number of obs: 180, groups:  Subject, 18
</code></pre><br/>
<p>We can calculate the <strong>95% coverage interval</strong> as <strong>251.4 ± 1.96*37.1</strong>. The lower bound of the 95% coverage interval is thus 178.7 and the upper bound is 324.1. We therefore estimated that 95% of the participants have an intercept between 178.7 and 324.1. This means that 95% of the participants have a reaction time between 178.7 and 324.1 at Day 0. This is not to be confused with the <strong>95% confidence interval</strong> of the intercept. The <strong>95% confidence interval</strong> is (232.3, 270.5), and this indicates that we are 95% confident that the <em>average intercept</em> is somewhere between 232.3 and 270.5.</p>
<p>In this model, we have accounted for the repeated measures design (observations nested within individuals) by including a random intercept for each participants. Each individual has his/her own intercept. The effect of sleep deprivation on reaction time is assumed to be the same across individuals. This assumption can be relaxed by fitting a <strong>random slope model</strong>.</p>
<p>Before running the <strong>random slope model</strong>, we can store the estimates from the <strong>random intercept model</strong> into a variable for future model comparison. By default, <strong>StatsNotebook</strong> stores the model estimates into the variable <code>res</code>. We now store these estimates into the variable <code>m1</code>. Enter the following code into a new block on the right panel and run it. This line of code must be run right after running the random intercept model.</p>
<pre><code>m1 &lt;- res
</code></pre><br/>

<h5 id="random-slope-model" class="anchor-link"><a href="#random-slope-model">Random slope model</a></h5>
<p>In the random intercept model, we assume that the effect of sleep deprivation on reaction time is the same across individuals. The following shows the scatterplot between reaction time and days of sleep deprivation for each participants.</p>
<p><img src="../img/random_slope_reaction_individuals.png" alt="Random slope individuals" title="random slope individuals"></p>
<p>While for most of the participants, the association is positive (the line of best fit going up towards the top right corner of each plot), there is substantial variations - For some participants, the effect of sleep deprivation seems to be stronger (e.g. participant 308) others relatively weaker (e.g. participant 309). To account for these variations, we can run a random slope model allowing the effect of sleep deprivation to vary across participants.</p>
<p>To run a random slope model,</p>
<ol>
<li>Click <strong>Analysis</strong> at the top</li>
<li>Click <strong>Regression</strong> and select <strong>Linear Regression (Numeric outcome)</strong> from the menu</li>
<li>In the left panel, select <em>Reaction</em> into <em>Outcome</em>, <em>Days</em> into <em>Covariates</em> and <em>Subject</em> into <em>Random effect</em>.</li>
</ol>
<p>The above three steps are the same as running a random intercept model. To specify a random slope for <em>Days</em> for each <em>Subject</em>,</p>
<ol start="4">
<li>Expand the panel <strong>Random Effect</strong></li>
<li>Check <em>Days</em> and select it into <em>Random slope</em></li>
<li>Click <strong>Code and Run</strong>, the following R code will be generated in a block on the right panel, with output from R below the codes.</li>
</ol>
<p><img src="../img/random_slope.png" alt="Random slope" title="random slope"></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">
<span style="color:#06287e">library</span>(lme4)
<span style="color:#06287e">library</span>(lmerTest)

res <span style="color:#666">&lt;-</span> <span style="color:#06287e">lmer</span>(Reaction <span style="color:#666">~</span> Days <span style="color:#666">+</span> (<span style="color:#40a070">1</span> <span style="color:#666">+</span> Days <span style="color:#666">|</span> Subject),
  data <span style="color:#666">=</span> currentDataset)
<span style="color:#06287e">summary</span>(res)
<span style="color:#06287e">confint</span>(res, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, method <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Wald&#34;</span>)



res.std <span style="color:#666">&lt;-</span> <span style="color:#06287e">resid</span>(res)<span style="color:#666">/</span><span style="color:#06287e">sd</span>(<span style="color:#06287e">resid</span>(res))
<span style="color:#06287e">plot</span>(res.std, ylab<span style="color:#666">=</span><span style="color:#4070a0">&#34;Standardized Residuals&#34;</span>)

<span style="color:#4070a0">&#34;Outlier Test. Observations with a Bonferroni p &lt; .05 might be considered as outliers and might need further investigation.&#34;</span>
car<span style="color:#666">::</span><span style="color:#06287e">outlierTest</span>(res)
car<span style="color:#666">::</span><span style="color:#06287e">infIndexPlot</span>(res)
<span style="color:#06287e">ggplot</span>(<span style="color:#06287e">as.data.frame</span>(res.std), <span style="color:#06287e">aes</span>(sample <span style="color:#666">=</span> res.std)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_qq</span>() <span style="color:#666">+</span>
  <span style="color:#06287e">geom_qq_line</span>()

<span style="color:#4070a0">&#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&#34;</span>
<span style="color:#4070a0">&#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&#34;</span>

</code></pre></div><br/>

<h5 id="r-codes-explained---random-slope-model" class="anchor-link"><a href="#r-codes-explained---random-slope-model">R codes explained - Random slope model</a></h5>
<p>The followings are from the top section of the generated codes.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">library</span>(lme4)
<span style="color:#06287e">library</span>(lmerTest)

res <span style="color:#666">&lt;-</span> <span style="color:#06287e">lmer</span>(Reaction <span style="color:#666">~</span> Days <span style="color:#666">+</span> (<span style="color:#40a070">1</span> <span style="color:#666">+</span> Days <span style="color:#666">|</span> Subject),
  data <span style="color:#666">=</span> currentDataset)
<span style="color:#06287e">summary</span>(res)
<span style="color:#06287e">confint</span>(res, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, method <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Wald&#34;</span>)
</code></pre></div><br/>
<p>These codes are very similar to those for the random intercept model, except that now we use the code <code>(1 + Days | Subject)</code> to specify a random intercept for each <em>Subject</em>, and a random slope of <em>Days</em> for each <em>Subject</em>. This allows both the intercept and the slope of days to vary across participants.</p>
<p>The following is the model summary from the above codes.</p>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: Reaction ~ Days + (1 + Days | Subject)
   Data: currentDataset

REML criterion at convergence: 1743.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.9536 -0.4634  0.0231  0.4634  5.1793 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 Subject  (Intercept) 612.10   24.741       
          Days         35.07    5.922   0.07
 Residual             654.94   25.592       
Number of obs: 180, groups:  Subject, 18

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)  251.405      6.825  17.000  36.838  &lt; 2e-16 ***
Days          10.467      1.546  17.000   6.771 3.26e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
     (Intr)
Days -0.138

######################################################
                 2.5 %    97.5 %
.sig01              NA        NA
.sig02              NA        NA
.sig03              NA        NA
.sigma              NA        NA
(Intercept) 238.029141 264.78107
Days          7.437594  13.49698
</code></pre><br/>

<h5 id="interpretation-1" class="anchor-link"><a href="#interpretation-1">Interpretation</a></h5>
<p>From the <strong>fixed effects</strong> section of the model summary, we can conclude that there is strong evidence that number of days of sleep deprivation significantly increased reaction time under a significance level of 0.05. On average, for each additional day of sleep deprivation, reaction time increased by 10.47ms (b = 10.47, SE = 1.55, p &lt; .001).</p>
<pre><code>Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)  251.405      6.825  17.000  36.838  &lt; 2e-16 ***
Days          10.467      1.546  17.000   6.771 3.26e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre><br/>
<p>We are 95% confident that the average increase was between 7.44 and 13.50.</p>
<pre><code>                 2.5 %    97.5 %
.sig01              NA        NA
.sig02              NA        NA
.sig03              NA        NA
.sigma              NA        NA
(Intercept) 238.029141 264.78107
Days          7.437594  13.49698
</code></pre><br/>
<p>From the <strong>fixed effects</strong> section, we estimated the average intercept and average effect of days of sleep deprivation (slopes of <em>Days</em>). We also estimated the corresponding 95% confidence intervals. Using the results from the <strong>random effects</strong> section, we can calculate the coverage intervals for both the intercept and the slope.</p>
<pre><code>Random effects:
 Groups   Name        Variance Std.Dev. Corr
 Subject  (Intercept) 612.10   24.741       
          Days         35.07    5.922   0.07
 Residual             654.94   25.592       
Number of obs: 180, groups:  Subject, 18
</code></pre><br/>
<p>The variance of the intercept and for the slope of <em>Days</em> is 612.1 and 35.1 respectively. Taking their square root, the corresponding standard deviations are 24.7 and 5.9. The 95% coverage interval of the intercept is 251.4 ± 1.96*24.7. The lower bound is 203.0 and the upper bound is 299.8. It is therefore estimated that 95% of the participants had a reaction time between 203.0 and 299.8 at Day 0.</p>
<p>The 95% coverage interval of the slope of <em>Days</em> is 10.5 ± 1.96*5.9. The lower bound is -1.1 and the upper bound is 22.1. It is therefore estimated that for 95% of the participants, the effect of each additional day of sleep deprivation was between -1.1 and 22.1. This is not to be confused with the 95% confidence interval (7.4 and 13.5), which means that we are 95% confident that <em>average effect</em> (across all participants) of each additional day of sleep deprivation on reaction time was between 7.4 and 13.5.</p>

<h5 id="random-intercept-or-random-slope-model" class="anchor-link"><a href="#random-intercept-or-random-slope-model">Random intercept or random slope model?</a></h5>
<p>A random intercept model is more parsimonious. Random slope model is more flexible as it allows the effect of days of sleep deprivation to vary across participants. So which one should we use? We can test the model fit of these two models and select the one that fits the data better. After running the random intercept model, we stored the model estimates into <code>m1</code>. We now store the model estimates from the random slope model into <code>m2</code>.</p>
<p>The following line of code must be run right after the random slope model.</p>
<pre><code>m2 &lt;- res
</code></pre><br/> 
<p>We can now compare the model fit of the random intercept model (stored in <code>m1</code>) and random slope model (stored in <code>m2</code>) with a <strong>likelihood ratio test</strong> using the following line of code.</p>
<pre><code>anova(m1, m2)
</code></pre><br/>
<p>The above code produces the following results.</p>
<pre><code>Data: currentDataset
Models:
m1: Reaction ~ Days + (1 | Subject)
m2: Reaction ~ Days + (1 + Days | Subject)
   npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
m1    4 1802.1 1814.8 -897.04   1794.1                         
m2    6 1763.9 1783.1 -875.97   1751.9 42.139  2  7.072e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre><br/>
<p>Results from the likelihood ratio test shows that the random slope model fits the data significantly better than the random intercept model, χ<sup>2</sup>(2) = 42.1, p &lt; .001. This indicates that there is significant variation (between participants) in the effect of days of sleep deprivation on reaction time.</p>

<h5 id="example-write-up-apa-style" class="anchor-link"><a href="#example-write-up-apa-style">Example write-up (APA style)</a></h5>
<p>Table 1. Results from random slope model.</p>
<table>
<thead>
<tr>
<th>Fixed component</th>
<th>b</th>
<th>95% CI</th>
<th>p</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intercept</td>
<td>251.41</td>
<td>(238.03, 264.78)</td>
<td>&lt; .001</td>
</tr>
<tr>
<td>Days</td>
<td>10.47</td>
<td>(7.44, 13.50)</td>
<td>&lt; .001</td>
</tr>
<tr>
<td><strong>Random component</strong></td>
<td><strong>Variance</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Intercept</td>
<td>612.10</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Days</td>
<td>35.07</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Residual</td>
<td>354.94</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>A random slope model is used to test if sleep deprivation affects reaction time. To account for the repeated measures design, a random intercept was specified for participants. The random slope for days of sleep deprivation was included in the model to allow the effect of sleep deprivation to vary across participants. Results are shown in Table 1. Using a significant level of 0.05, results indicate that sleep deprivation significantly increased reaction time. On average, each additional day of sleep deprivation increased reaction time by 10.47ms (<em>b</em> = 10.47, 95% CI = [7.44, 13.50], <em>p</em> &lt; .001). Model fit comparison between model with and without random slope for sleep deprivation shows that the effect of sleep deprivation varied across participants, χ<sup>2</sup>(2)= 42.14, <em>p</em> &lt; .001. The 95% coverage interval for the random slope of sleep deprivation is (-1.14, 22.07), indicating that the effect of sleep deprivation was between -1.14 and 22.07 for 95% of the participants.</p>

<h4 id="alcohol-tax-and-alcohol-consumption" class="anchor-link"><a href="#alcohol-tax-and-alcohol-consumption">Alcohol tax and alcohol consumption</a></h4>
<p>In our alcohol tax example in the <a href="../moderation_interaction_regression/#categorical-independent-variable-and-categorical-moderator" title="moderation analysis">moderation analysis</a> tutorial, we investigated two research questions in the following scenario.</p>
<p>Suppose that in Australia, Queensland implemented an increase in alcohol tax in 2018 and no change in tax in any other states (e.g. Victoria and New South Wales). We have collected data on alcohol consumption in 2017 and 2019, and we want to test if the change in alcohol consumption (measured in number of standard drinks consumed per month) in Queensland was different from other states.</p>
<ul>
<li>A simple before/ after comparison using only Queensland data is not sufficient to test if the tax increase changed alcohol consumption because there is no comparision group. A before/ after difference can simply be due to a decreasing trend. We need to test if the change of alcohol consumption in Queensland is larger than other states.</li>
<li>In this analysis, we will test the interaction between <em>year</em> and <em>state</em>. (Does <em>state</em> change the effect of <em>year</em> on alcohol consumption?)</li>
</ul>
<p>We have used the built-in <strong>Alcohol</strong> dataset in that example and the dataset can be loaded into <strong>StatsNotebook</strong> using the instructions provided <a href="../../data_management/load_example_data">here</a>.</p>
<p>There are 5 variables in this dataset.</p>
<ol>
<li>Alcohol - Number of standard drinks consumed per month.</li>
<li>Year - 2017 (before tax increase in Queeland) and 2019 (after tax increase)</li>
<li>Postcode - Postcode of participants&rsquo; residence</li>
<li>State - Seven states/territories in Australia, namely, Queensland, New South Wales, Northern Territory, South Australia, Tasmania, Victoria and Western Australia</li>
<li>Remoteness - Capital city or regional area.</li>
</ol>
<p>In our original example, we have performed the moderation analysis using linear regression. However, it is likely that drinking culture differs between different local communities. Therefore, individuals from the same postcode might be more similar than individuals from different postcodes, and this would violate the assumption of independent observation.</p>
<p>In this tutorial, we revisit this example and fit a random intercept model to account for the dependencies due to participants residing in the same postcode.</p>
<p>To fit a random intercept model,</p>
<ol>
<li>Click <strong>Analysis</strong> at the top</li>
<li>Click <strong>Regression</strong> and select <strong>Linear regression (Numeric outcome)</strong> from the menu</li>
<li>In the left panel, select <em>alcohol</em> into <em>Outcome</em>, and select <em>Year</em>, <em>State</em> and <em>Remoteness</em> into <em>Covariates</em>.
<ul>
<li>We have added <em>Remoteness</em> into this analysis to adjust for its effect.</li>
<li>We will need to code <em>Year</em>, <em>State</em> and <em>Remoteness</em> into <strong>factor</strong> because they are <strong>categorical</strong> variables. See <a href="../../data_management/variable_conversion">Converting variable type</a> for step-by-step guide.</li>
<li>For this analysis, because we compared <em>Queensland</em> against all other states, we set <em>QLD</em> as the <strong>reference</strong> level of <em>State</em>. See <a href="../../data_management/set_reference">Setting reference level for categorical variable</a> for step-by-step guide.</li>
</ul>
</li>
<li>Select <em>Postcode</em> into <em>Random Effect</em>.</li>
</ol>
<p><img src="../img/random_slope_instruction1.png" alt="Random slope model instruction 1" title="random slope instruction 1"></p>
<ol start="5">
<li>Expand the panel <strong>Add interaction terms</strong>, select <em>State</em> and <em>Year</em> into <em>Interaction terms</em>.
<ul>
<li>The order of selected variables will determine the horizontal axis of the interaction plot (see interpretaion below). The first selected variable will always go to the horizontal axis. In this example, we click <em>State</em> first followed by <em>Year</em>.</li>
</ul>
</li>
</ol>
<p><img src="../img/add_interaction_term.png" alt="Add interaction term" title="Add interaction term"></p>
<ol start="6">
<li>Expand the panel <strong>Estimated Marginal Means</strong>, select <em>State*Year</em> on the variable list, and select <strong>Pairwise comparison</strong> and <strong>Interaction plot</strong>.</li>
</ol>
<p><img src="../img/moderation_emm.png" alt="Estimated marginal mean" title="Estimated marginal mean"></p>
<ol start="7">
<li>Click <strong>Code and Run</strong>, the following R code will be generated in a block on the right panel, with output from R below the codes.</li>
</ol>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">
<span style="color:#06287e">library</span>(lme4)
<span style="color:#06287e">library</span>(lmerTest)

res <span style="color:#666">&lt;-</span> <span style="color:#06287e">lmer</span>(alcohol <span style="color:#666">~</span> State <span style="color:#666">+</span> Remoteness <span style="color:#666">+</span> Year <span style="color:#666">+</span> State<span style="color:#666">*</span>Year <span style="color:#666">+</span> (<span style="color:#40a070">1</span> <span style="color:#666">|</span> Postcode),
  data <span style="color:#666">=</span> currentDataset)
<span style="color:#06287e">summary</span>(res)
<span style="color:#06287e">confint</span>(res, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, method <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Wald&#34;</span>)



res.std <span style="color:#666">&lt;-</span> <span style="color:#06287e">resid</span>(res)<span style="color:#666">/</span><span style="color:#06287e">sd</span>(<span style="color:#06287e">resid</span>(res))
<span style="color:#06287e">plot</span>(res.std, ylab<span style="color:#666">=</span><span style="color:#4070a0">&#34;Standardized Residuals&#34;</span>)

<span style="color:#4070a0">&#34;Outlier Test. Observations with a Bonferroni p &lt; .05 might be considered as outliers and might need further investigation.&#34;</span>
car<span style="color:#666">::</span><span style="color:#06287e">outlierTest</span>(res)
car<span style="color:#666">::</span><span style="color:#06287e">infIndexPlot</span>(res)
<span style="color:#06287e">ggplot</span>(<span style="color:#06287e">as.data.frame</span>(res.std), <span style="color:#06287e">aes</span>(sample <span style="color:#666">=</span> res.std)) <span style="color:#666">+</span>
  <span style="color:#06287e">geom_qq</span>() <span style="color:#666">+</span>
  <span style="color:#06287e">geom_qq_line</span>()

<span style="color:#4070a0">&#34;Variance inflation factor (VIF &gt;=5 indicates high level of multicollinearity)&#34;</span>
car<span style="color:#666">::</span><span style="color:#06287e">vif</span>(res)

<span style="color:#4070a0">&#34;Estimated Marginal Means&#34;</span>
<span style="color:#06287e">library</span>(emmeans)

emm <span style="color:#666">&lt;-</span> <span style="color:#06287e">emmeans</span>(res, pairwise <span style="color:#666">~</span> State<span style="color:#666">*</span>Year, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>)
<span style="color:#06287e">summary</span>(emm)

<span style="color:#06287e">eff_size</span>(emm, sigma <span style="color:#666">=</span> <span style="color:#06287e">sigma</span>(res), edf <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">Inf</span>)

<span style="color:#06287e">emmip</span>(res, Year <span style="color:#666">~</span> State,
  cov.keep <span style="color:#666">=</span> <span style="color:#40a070">3</span>, at <span style="color:#666">=</span> <span style="color:#06287e">list</span>(),
  CIs <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">TRUE</span>, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, position <span style="color:#666">=</span> <span style="color:#4070a0">&#34;jitter&#34;</span>)


<span style="color:#4070a0">&#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&#34;</span>
<span style="color:#4070a0">&#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&#34;</span>

</code></pre></div><br/>

<h5 id="r-codes-explained---random-intercept-model-1" class="anchor-link"><a href="#r-codes-explained---random-intercept-model-1">R codes explained - Random intercept model</a></h5>
<p>The following are from the top section of the generated codes.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">library</span>(lme4)
<span style="color:#06287e">library</span>(lmerTest)

res <span style="color:#666">&lt;-</span> <span style="color:#06287e">lmer</span>(alcohol <span style="color:#666">~</span> State <span style="color:#666">+</span> Remoteness <span style="color:#666">+</span> Year <span style="color:#666">+</span> State<span style="color:#666">*</span>Year <span style="color:#666">+</span> (<span style="color:#40a070">1</span> <span style="color:#666">|</span> Postcode),
  data <span style="color:#666">=</span> currentDataset)
<span style="color:#06287e">summary</span>(res)
<span style="color:#06287e">confint</span>(res, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, method <span style="color:#666">=</span> <span style="color:#4070a0">&#34;Wald&#34;</span>)
</code></pre></div><br/>
<p>These codes tell R to run a linear mixed model using the <code>lmer</code> from the <code>lme4</code> library. The left side of the <strong>&ldquo;~&rdquo;</strong> symbol specifies the <em>alcohol</em> as the <em>dependent variable</em>; the right side specifices <em>State</em>, <em>Remoteness</em>, <em>Year</em> and the interaction of <em>State and Year</em> as the independent variable. The code <code>(1 | Postcode)</code> specifies a random intercept for each <em>Postcode</em>. The <code>summary</code> function is used to print out the results from the random intercept model.</p>
<p>The following is the model summary from the above codes.</p>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: alcohol ~ State + Remoteness + Year + State * Year + (1 | Postcode)
   Data: currentDataset

REML criterion at convergence: 38231.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.9021 -0.7711 -0.1916  0.5797  4.2157 

Random effects:
 Groups   Name        Variance Std.Dev.
 Postcode (Intercept)   59.24   7.697  
 Residual             2001.97  44.743  
Number of obs: 3666, groups:  Postcode, 35

Fixed effects:
                   Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)          72.639      6.988   28.022  10.395 4.03e-11 ***
StateNSW              2.605      7.652   30.117   0.340  0.73593    
StateNT               1.689      8.302   31.530   0.203  0.84011    
StateSA              -6.905      7.950   30.890  -0.869  0.39179    
StateTAS              2.193      8.889   33.801   0.247  0.80663    
StateVIC             -9.671      7.967   26.721  -1.214  0.23540    
StateWA             -10.466      8.785   41.141  -1.191  0.24036    
RemotenessRegional  -10.373      4.502   23.524  -2.304  0.03036 *  
Year2019            -21.028      5.060 3635.689  -4.156 3.32e-05 ***
StateNSW:Year2019    16.702      6.051 3650.901   2.760  0.00581 ** 
StateNT:Year2019     14.589      6.894 3201.952   2.116  0.03440 *  
StateSA:Year2019     18.909      6.526 3649.459   2.898  0.00378 ** 
StateTAS:Year2019     6.764      7.438 2549.967   0.909  0.36324    
StateVIC:Year2019    15.187      5.953 3634.067   2.551  0.01078 *  
StateWA:Year2019     22.251      7.019 3644.024   3.170  0.00154 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre><br/>

<h5 id="interpretation-2" class="anchor-link"><a href="#interpretation-2">Interpretation</a></h5>
<p>Using a significance level of 0.05, most of the interaction term between Year and States are significant. This indicates that changes in alcohol consumption in Queensland is different from the changes in other states. However, interpreting these coefficients is not straightforward.</p>
<p>An easier way to interpret interactions is to calculate the <strong>Estimated Margainal Means (EMMs)</strong>. We can estimate the mean alcohol consumption by <em>State</em> and <em>Year</em> from our regression model.</p>

<h5 id="r-codes-explained--estimated-marginal-means" class="anchor-link"><a href="#r-codes-explained--estimated-marginal-means">R codes explained = Estimated Marginal Means</a></h5>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#4070a0">&#34;Estimated Marginal Means&#34;</span>
<span style="color:#06287e">library</span>(emmeans)

emm <span style="color:#666">&lt;-</span> <span style="color:#06287e">emmeans</span>(res, pairwise <span style="color:#666">~</span> State<span style="color:#666">*</span>Year, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>)
<span style="color:#06287e">summary</span>(emm)

<span style="color:#06287e">eff_size</span>(emm, sigma <span style="color:#666">=</span> <span style="color:#06287e">sigma</span>(res), edf <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">Inf</span>)

</code></pre></div>
<h5 id="interpretation-3" class="anchor-link"><a href="#interpretation-3">Interpretation</a></h5>
<p>These few lines of codes will produce a long list of output that can be broken down into three major section.</p>
<p><strong>Estimated Marginal Means</strong></p>
<pre><code>$emmeans
 State Year emmean   SE  df asymp.LCL asymp.UCL
 QLD   2017   67.5 6.64 Inf      54.4      80.5
 NSW   2017   70.1 3.80 Inf      62.6      77.5
 NT    2017   69.1 4.94 Inf      59.5      78.8
 SA    2017   60.5 4.33 Inf      52.1      69.0
 TAS   2017   69.6 5.87 Inf      58.1      81.2
 VIC   2017   57.8 4.40 Inf      49.2      66.4
 WA    2017   57.0 5.71 Inf      45.8      68.2
 QLD   2019   46.4 6.45 Inf      33.8      59.1
 NSW   2019   65.7 4.07 Inf      57.8      73.7
 NT    2019   62.7 5.42 Inf      52.1      73.3
 SA    2019   58.4 4.88 Inf      48.9      68.0
 TAS   2019   55.4 5.92 Inf      43.8      67.0
 VIC   2019   51.9 4.60 Inf      42.9      61.0
 WA    2019   58.2 4.57 Inf      49.3      67.2

Results are averaged over the levels of: Remoteness 
Degrees-of-freedom method: asymptotic 
Confidence level used: 0.95 
</code></pre><p>The above table contains estimates for alcohol consumption by <em>State</em> and <em>Year</em>, with 95% confidence intervals. For example, it is estimated that on average, participants in Queensland in 2017 consumed 67.5 standard drinks per month, with a 95% confidence interval of (54.4, 80.5).</p>
<p>It should be noted that the estimates from this random intercept model is very similar to those from a <a href="../moderation_interaction_regression/#interpretation-1">linear regression model</a>. However, the confidence intervals of the random intercept model is wider.</p>
<p>This table is then followed by a long table of pairwise comparisons. However, we will not be interested in most of these comparisons.</p>
<p><strong>Pairwise comparison</strong></p>
<pre><code>$contrasts
 contrast            estimate   SE  df z.ratio p.value
 QLD 2017 - NSW 2017   -2.604 7.65 Inf -0.340  1.0000 
 QLD 2017 - NT 2017    -1.689 8.30 Inf -0.203  1.0000 
 QLD 2017 - SA 2017     6.905 7.95 Inf  0.869  0.9999 
 .
 .
 .
  TAS 2019 - VIC 2019    3.441 7.55 Inf  0.456  1.0000 
 TAS 2019 - WA 2019    -2.829 6.77 Inf -0.418  1.0000 
 VIC 2019 - WA 2019    -6.270 6.54 Inf -0.958  0.9996 
</code></pre><br/>
<p>We will only be interested in the 2017 and 2019 comparison in each state.</p>
<pre><code>contrast            estimate   SE  df z.ratio p.value
QLD 2017 - QLD 2019   21.028 5.06 Inf  4.156  0.0026 
NSW 2017 - NSW 2019    4.326 3.32 Inf  1.302  0.9907 
NT 2017 - NT 2019      6.439 4.68 Inf  1.375  0.9847 
SA 2017 - SA 2019      2.119 4.12 Inf  0.514  1.0000 
TAS 2017 - TAS 2019   14.264 5.45 Inf  2.616  0.3296 
VIC 2017 - VIC 2019    5.841 3.14 Inf  1.863  0.8467 
WA 2017 - WA 2019     -1.223 4.86 Inf -0.251  1.0000 
</code></pre><br/>
These results indicate that there is significant change in Queensland between 2017 and 2019 only. On average, consumption decreased by 21.03 standard drinks. The p-value is adjusted for a family of 14 estimates using Tukey's method. This adjustment is necessary to protect against increased rate of false positives due to multiple testing.  
<p>Lastly, the pairwise comparisons are accompanied by a table of effect sizes.</p>
<p><strong>Effect size</strong></p>
<pre><code>contrast              effect.size     SE  df asymp.LCL asymp.UCL
(QLD 2017 - NSW 2017)    -0.05821 0.1710 Inf  -0.39339   0.27697
(QLD 2017 - NT 2017)     -0.03774 0.1855 Inf  -0.40140   0.32591
(QLD 2017 - SA 2017)      0.15433 0.1777 Inf  -0.19393   0.50258
.
.
.
(TAS 2019 - VIC 2019)     0.07691 0.1688 Inf  -0.25391   0.40773
(TAS 2019 - WA 2019)     -0.06322 0.1514 Inf  -0.35988   0.23344
(VIC 2019 - WA 2019)     -0.14012 0.1463 Inf  -0.42681   0.14657
</code></pre><br/>
<p>Similarly, we will be only interested in the 2017 and 2019 comparison in each state.</p>
<pre><code>(QLD 2017 - QLD 2019)     0.46998 0.1131 Inf   0.24832   0.69164
(NSW 2017 - NSW 2019)     0.09669 0.0743 Inf  -0.04891   0.24228
(NT 2017 - NT 2019)       0.14391 0.1046 Inf  -0.06119   0.34900
(SA 2017 - SA 2019)       0.04736 0.0921 Inf  -0.13307   0.22779
(TAS 2017 - TAS 2019)     0.31880 0.1218 Inf   0.07998   0.55762
(VIC 2017 - VIC 2019)     0.13055 0.0701 Inf  -0.00682   0.26793
(WA 2017 - WA 2019)      -0.02733 0.1087 Inf  -0.24039   0.18572
</code></pre><br/>
<p>These effect sizes can be interpreted according to Cohen&rsquo;s rule: 0.2 represents a small effect size, 0.5 represents a medium effect size and 0.8 represents a large effect size.</p>
<p>The <code>emmeans</code> package provides a handy function <code>emmip</code> to visualise the interaction.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#06287e">emmip</span>(res, Year <span style="color:#666">~</span> State,
  cov.keep <span style="color:#666">=</span> <span style="color:#40a070">3</span>, at <span style="color:#666">=</span> <span style="color:#06287e">list</span>(),
  CIs <span style="color:#666">=</span> <span style="color:#007020;font-weight:bold">TRUE</span>, level <span style="color:#666">=</span> <span style="color:#40a070">0.95</span>, position <span style="color:#666">=</span> <span style="color:#4070a0">&#34;jitter&#34;</span>)


<span style="color:#4070a0">&#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&#34;</span>
<span style="color:#4070a0">&#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&#34;</span>

</code></pre></div><p><img src="../img/random_slope_model_interaction.png" alt="random slope model interaction" title="random slope model interaction"></p>

</div>





                
                <div class="container">
    <hr>
</div>
<div class="container has-text-centered top-pad">
    <a href="#top">
        <i class="fa fa-arrow-up"></i>
    </a>
</div>

<div class="container">
    <hr>
</div>

                <div class="section" id="footer">
    <div class="container has-text-centered">
    
        <span class="footer-text">
            <a href="https://github.com/victoriadrake/hugo-theme-introduction/"><strong>Introduction</strong></a> theme for <a href="http://gohugo.io/">Hugo</a>. Made with <a href="https://victoria.dev"><i class="fa fa-heart"></i> and <i class="fa fa-coffee"></i></a> by open source contributors.
        </span>
    
    </div>
</div>

                
            </div>
        </section>
        
        


<script src="https://statsnotebook.io/js/bundle.2ee571453a8980175e10bda96bda797cc9c4e2e745e488df68d50cef5deb57ff.js" integrity="sha256-LuVxRTqJgBdeEL2pa9p5fMnE4udF5IjfaNUM713rV/8="></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-180705456-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>





        
        
        
        
    </body>
</html>
