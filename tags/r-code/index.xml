<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>R code on StatsNotebook - Simple. Powerful. Reproducible.</title>
    <link>https://statsnotebook.io/tags/r-code/</link>
    <description>Recent content in R code on StatsNotebook - Simple. Powerful. Reproducible.</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 29 Mar 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://statsnotebook.io/tags/r-code/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Age-period-cohort analysis</title>
      <link>https://statsnotebook.io/blog/analysis/age_period_cohort_analysis/</link>
      <pubDate>Mon, 29 Mar 2021 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/age_period_cohort_analysis/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R. Visit our &lt;a href=&#34;https://statsnotebook.io/blog/analysis/&#34;&gt;Analysis section&lt;/a&gt; for other tutorials.&lt;/p&gt;
&lt;p&gt;Epidemiologists and social scientists often apply Age-Period-Cohort analysis to disentangle trends of social/health behvaiors into three components.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Age effect - This represents the effect associated with chronological age. For example, young people are more likely to use cannabis for recreational purpose than older people.&lt;/li&gt;
&lt;li&gt;Period effect - This represents the effect associated with time period that affects all age groups at the same time. For example, changes in legislation with regards to recreational cannabis use is like to influence behaviors across all age group.&lt;/li&gt;
&lt;li&gt;Cohort effect - Epidemiologists and social scientists are often interested in &lt;em&gt;birth cohort&lt;/em&gt;, who experienced the same historical and social events at the same age. Cohort effect thus is often used to refered to the variation due to these unique experiences. For example, the baby boomer generation has a higher rate of cannabis use compared to subsequent cohort at the same age.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this tutorial, we will use a simulalated data based on a nationally representative dataset in Australia and disentangle changes in cannabis use trends into age, period and cohort effect. The challenge of age-period-cohort analysis (APC analysis) has long been identified because the &lt;em&gt;cohort&lt;/em&gt; variabls is often directly calcuated from &lt;em&gt;age&lt;/em&gt; and &lt;em&gt;period&lt;/em&gt; such that&lt;/p&gt;
&lt;p&gt;Cohort = Period - Age&lt;/p&gt;
&lt;p&gt;In this tutorial, we will use the Hierarchical APC-Corss-Classified Random Effect Model (HACP-CCREM; Yang et al, 2008) to test the age, period and cohort effect on weekly cannabis use. This model is a type of mixed effect model in which the &lt;em&gt;Age&lt;/em&gt; effect is entered as a fixed effect and both &lt;em&gt;Cohort&lt;/em&gt; and &lt;em&gt;Period&lt;/em&gt; are entered as random effects. In this setup, the HACP-CCREM is not different from the typical application of mixed model in which the random effects often represent the contextual effects that influence the outcome. In this case, cohort represents the contextual effect of experiencing the same social and historical context at the same age within the same birth cohort and period effect represents the contextual effect of experiencing the same social and historical context at a certain time period that affects all age group.&lt;/p&gt;

&lt;h5 id=&#34;example-dataset&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#example-dataset&#34;&gt;Example dataset&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;In this tutorial, we will use an example dataset simulated based on a national drug survey in Australia.&lt;/p&gt;
&lt;p&gt;This data can be loaded using the following code.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/APC_cannabis.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Supposed that the data was collected every three years between 2001 and 2019, there were 7 repeated cross-sectional surveys.&lt;/p&gt;
&lt;p&gt;In this dataset, there are 8 variables.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Sex - 1: Male; 2: Female&lt;/li&gt;
&lt;li&gt;HighSchool - 0: Not completed high school; 1: completed high school&lt;/li&gt;
&lt;li&gt;remoteness - 1: Major cities; 2: Inner regional area; 3: Remote area&lt;/li&gt;
&lt;li&gt;Year - Year the data was collected: 2001/2004/2007/2010/2013/2016/2019&lt;/li&gt;
&lt;li&gt;cohort_cat - Birth cohort: 1: 1941/50; 2: 1951/60; 3: 1961/70; 4: 1971/80; 5: 1981/90; 6: 1991/2000&lt;/li&gt;
&lt;li&gt;weekly_cannabis - Weekly cannabis use: 0: No; 1: Yes&lt;/li&gt;
&lt;li&gt;AgeR - Recoded age. The value is calculated by dividing the actual age by 10. This is to facilitate model converence when we add the quadratic term of age into the model.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/apc_data.png&#34; alt=&#34;example APC data&#34; title=&#34;example APC data&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;age-period-cohort-model&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#age-period-cohort-model&#34;&gt;Age-Period-Cohort model&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;In this example, we will test the age, period and cohort effect on weekly cannabis use. Since weekly cannabis use is a dichotomized variable (Yes/No), we will firstly fit a mixed effects (multilevel level) logistic model&lt;/p&gt;
&lt;p&gt;At level 1, we have&lt;/p&gt;
&lt;p&gt;&lt;em&gt;logit&lt;/em&gt; P(cannabis&lt;sub&gt;ijk&lt;/sub&gt;) = b&lt;sub&gt;0jk&lt;/sub&gt;+b&lt;sub&gt;1&lt;/sub&gt;Age&lt;sub&gt;ijk&lt;/sub&gt;+b&lt;sub&gt;2&lt;/sub&gt;Age&lt;sup&gt;2&lt;/sup&gt;&lt;sub&gt;ijk&lt;/sub&gt;+b&lt;sub&gt;3&lt;/sub&gt;Female&lt;sub&gt;ijk&lt;/sub&gt;+b&lt;sub&gt;4&lt;/sub&gt;Inner regional&lt;sub&gt;ijk&lt;/sub&gt;+b&lt;sub&gt;5&lt;/sub&gt;Remote area&lt;sub&gt;ijk&lt;/sub&gt;+b&lt;sub&gt;6&lt;/sub&gt;High School&lt;sub&gt;ijk&lt;/sub&gt;&lt;/p&gt;
&lt;p&gt;where &lt;em&gt;Female&lt;/em&gt;, &lt;em&gt;Inner regional&lt;/em&gt;, &lt;em&gt;Remote area&lt;/em&gt; and &lt;em&gt;High School&lt;/em&gt; are indicator variables (i.e. &lt;em&gt;High School&lt;/em&gt; = 0 for participants who haven&amp;rsquo;t finished high school and &lt;em&gt;High School&lt;/em&gt; = 1 for participants who finished high school). R will automatically create these indicator variables when a categorical/factor variable is entered into a model. The quadratic term of age is included to capture the potential quadratic effect of age.&lt;/p&gt;
&lt;p&gt;At level 2, we have&lt;/p&gt;
&lt;p&gt;b&lt;sub&gt;0jk&lt;/sub&gt; = γ&lt;sub&gt;0&lt;/sub&gt;+ u&lt;sub&gt;0j&lt;/sub&gt; + v&lt;sub&gt;0k&lt;/sub&gt;&lt;/p&gt;
&lt;p&gt;where u&lt;sub&gt;0j&lt;/sub&gt; and v&lt;sub&gt;0k&lt;/sub&gt; represents the effect of being in period &lt;em&gt;j&lt;/em&gt; and birth cohort &lt;em&gt;k&lt;/em&gt;, and u&lt;sub&gt;0j&lt;/sub&gt; ~ N(0, τ&lt;sub&gt;u&lt;/sub&gt;) and v&lt;sub&gt;0j&lt;/sub&gt; ~ N(0, τ&lt;sub&gt;v&lt;/sub&gt;). The u&lt;sub&gt;0j&lt;/sub&gt; and v&lt;sub&gt;0k&lt;/sub&gt; have also been referred to as the random effect of period and cohort. It should be noted that the index &lt;em&gt;ijk&lt;/em&gt; is the index for individual &lt;em&gt;i&lt;/em&gt; in period &lt;em&gt;j&lt;/em&gt; and cohort &lt;em&gt;k&lt;/em&gt;.&lt;/p&gt;

&lt;h5 id=&#34;apc-analysis-in-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#apc-analysis-in-statsnotebook&#34;&gt;APC analysis in StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;In this analysis, after loading the data, we will need to&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;convert the variable &lt;em&gt;Sex&lt;/em&gt;, &lt;em&gt;HighSchool&lt;/em&gt;, &lt;em&gt;remoteness&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt;, and &lt;em&gt;cohort_cat&lt;/em&gt; into factor variables;&lt;/li&gt;
&lt;li&gt;centre the age variable at 2 so that the intercept of the model represented the effect of age at 20 years old (i.e. substracting 2 from the age variable); and&lt;/li&gt;
&lt;li&gt;create the quadratic term of age, &lt;em&gt;AgeR2&lt;/em&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;**See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io/blog/data_management/compute_variable/#quadratic-term&#34; title=&#34;Creating quadratic term&#34;&gt;Converting variable type&lt;/a&gt; for a step-by-step guide.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;#Converting Sex, HighSchool, Year, cohort_cat and remoteness into factor variable&lt;/span&gt;
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;factor&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex, exclude &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;))
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;HighSchool &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;factor&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;HighSchool, exclude &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;))
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Year &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;factor&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Year, exclude &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;))
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;cohort_cat &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;factor&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;cohort_cat, exclude &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;))
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;remoteness &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;factor&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;remoteness, exclude &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;))

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;#centre age at 20 years old and create the quadratic term&lt;/span&gt;
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;AgeR &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;AgeR &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;AgeR2 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;AgeR^2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;To fit a Age-Period-Cohort model,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Logistic Regression (Binary outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;weekly_cannabis&lt;/em&gt; into &lt;em&gt;outcome&lt;/em&gt;, &lt;em&gt;AgeR&lt;/em&gt;, &lt;em&gt;AgeR2&lt;/em&gt; (the newly created quadratic term of &lt;em&gt;AgeR&lt;/em&gt;), &lt;em&gt;Sex&lt;/em&gt;, &lt;em&gt;HighSchool&lt;/em&gt; and &lt;em&gt;remoteness&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;, and select &lt;em&gt;cohort_cat&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; into &lt;em&gt;Random Effect&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/apc_instruction1.png&#34; alt=&#34;age-period-cohort analysis instruction 1&#34; title=&#34;age-period-cohort analysis instruction 1&#34;/&gt;&lt;/a&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;glmer&lt;/span&gt;(weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; cohort_cat) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Year),
  family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; binomial,
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)

se &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sqrt&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;diag&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;vcov&lt;/span&gt;(res)))
z &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;qnorm&lt;/span&gt;((&lt;span style=&#34;color:#40a070&#34;&gt;1-0.95&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;exp&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(Est&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;fixef&lt;/span&gt;(res),
  &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;2.5%&amp;#34;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;fixef&lt;/span&gt;(res) &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;se,
  &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;97.5%&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;fixef&lt;/span&gt;(res) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;se))


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.1) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;r-codes-explained&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained&#34;&gt;R codes explained&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The Age-Period-Cohort model in this example is a mixed effects logistic model with random intercepts. The following are from the top section of the generated codes. The analysis uses the &lt;code&gt;glmer&lt;/code&gt; function from the  &lt;code&gt;lme4&lt;/code&gt; library to fit the model, the &lt;code&gt;summary&lt;/code&gt; function to display the model output, and then the &lt;code&gt;confint&lt;/code&gt; function to compute the confidence intervals of the parameters using the Wald&amp;rsquo;s method.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;glmer&lt;/span&gt;(weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; cohort_cat) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Year),
  family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; binomial,
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The next section of the codes extracts the variance-covariance matrix of the parameters, and calculate the odds ratio and the corresponding confidence intervals of each variable.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;se &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sqrt&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;diag&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;vcov&lt;/span&gt;(res)))
z &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;qnorm&lt;/span&gt;((&lt;span style=&#34;color:#40a070&#34;&gt;1-0.95&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;exp&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(Est&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;fixef&lt;/span&gt;(res),
  &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;2.5%&amp;#34;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;fixef&lt;/span&gt;(res) &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;se,
  &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;97.5%&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;fixef&lt;/span&gt;(res) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;se))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The following are excerpt of outputs from the above codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Fixed effects&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
            Estimate Std. Error z value &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;|&lt;/span&gt;z&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;)    
(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;-1.47823&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.19175&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-7.709&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.27e-14&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
AgeR        &lt;span style=&#34;color:#40a070&#34;&gt;-0.49014&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.06268&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-7.819&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;5.32e-15&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
AgeR2        &lt;span style=&#34;color:#40a070&#34;&gt;0.01221&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.01186&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.030&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.303&lt;/span&gt;    
Sex2        &lt;span style=&#34;color:#40a070&#34;&gt;-0.84691&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.03172&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-26.697&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2e-16&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
remoteness2  &lt;span style=&#34;color:#40a070&#34;&gt;0.14050&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.03362&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;4.179&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2.93e-05&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
remoteness3  &lt;span style=&#34;color:#40a070&#34;&gt;0.30242&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.05130&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;5.895&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3.74e-09&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
HighSchool1 &lt;span style=&#34;color:#40a070&#34;&gt;-0.85670&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.03230&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-26.521&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2e-16&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The following are odds ratio calculated by exponentiating the model parameters.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;                  Est      &lt;span style=&#34;color:#40a070&#34;&gt;2.5&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;%     97.5%&lt;/span&gt;
(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;0.2280404&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1566014&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.3320687&lt;/span&gt;
AgeR        &lt;span style=&#34;color:#40a070&#34;&gt;0.6125418&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5417249&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6926162&lt;/span&gt;
AgeR2       &lt;span style=&#34;color:#40a070&#34;&gt;1.0122856&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.9890264&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.0360917&lt;/span&gt;
Sex2        &lt;span style=&#34;color:#40a070&#34;&gt;0.4287377&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.4028924&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.4562409&lt;/span&gt;
remoteness2 &lt;span style=&#34;color:#40a070&#34;&gt;1.1508512&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.0774569&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.2292450&lt;/span&gt;
remoteness3 &lt;span style=&#34;color:#40a070&#34;&gt;1.3531320&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.2236971&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.4962576&lt;/span&gt;
HighSchool1 &lt;span style=&#34;color:#40a070&#34;&gt;0.4245599&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.3985133&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.4523089&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As expected, age is strongly associated with reduced odds of using cannabis weekly. The quadratic term of age is not statistically significant and is very close to zero.&lt;/p&gt;
&lt;p&gt;In the presence of the quadratic term of age and other variables in the model, to better understand the effect of age on cannabis use, we can use the &lt;code&gt;emmeans&lt;/code&gt; package to calculate the probability of weekly cannabis use with the following codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

Age_eff &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;data.frame&lt;/span&gt;()

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;# Age is centred at 20 years old, and is divided by 10.&lt;/span&gt;
&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;# (i.e. 0 means the participant is 20 years old, 1 means 30 years old, etc)&lt;/span&gt;
&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;# We use a for loop to calculate the probability of weekly cannabis use &lt;/span&gt;
&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;# when the age &amp;#34;score&amp;#34; is between 0 and 5, with 0.5 increment.&lt;/span&gt;
&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;# The calculated probability is stored in a new data frame Age_eff&lt;/span&gt;

&lt;span style=&#34;color:#06287e&#34;&gt;for &lt;/span&gt;(i in &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;10&lt;/span&gt;) {
  emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res,  &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2,
  at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  AgeR &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; i&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;, AgeR2 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; (i&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;)^2), type &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;response&amp;#34;&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
  Age_eff &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;data.frame&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)), Age_eff)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The above codes prodce the following output. This can be considered as the &amp;ldquo;average&amp;rdquo; probability averaging across other variables. Note that a score of &amp;ldquo;0&amp;rdquo; for age represents 20 years old and a score of &amp;ldquo;5&amp;rdquo; represents 70 years old. The column &lt;em&gt;prob&lt;/em&gt; is the estimated probability of weekly cannabis use averaged across levels of sex, remoteness, and high school completion.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;   AgeR AgeR2       prob          SE  df   asymp.LCL  asymp.UCL
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;5.0&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;25.00&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01302441&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.002963280&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.008329145&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.02031226&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;4.5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;20.25&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01566169&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.003206712&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.010472891&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.02336060&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;4.0&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16.00&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01893590&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.003566890&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.013074952&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.02735125&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;3.5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;12.25&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.02301558&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.004081239&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.016237876&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.03252876&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;3.0&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;9.00&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.02811552&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.004789430&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.020105526&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.03918906&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;2.5&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;6.25&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.03450870&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.005735311&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.024872334&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.04769591&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;7&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;2.0&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;4.00&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.04254035&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.006973858&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.030786360&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05851100&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.5&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;2.25&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05264362&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.008584237&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.038144305&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.07224044&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;9&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.0&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.00&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.06535550&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.010690410&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.047275202&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.08969955&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;10&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.25&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.08132988&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.013489649&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.058509247&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.11199258&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;11&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.0&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.00&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.10134240&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.017284082&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.072133577&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.14058661&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;We can use the &lt;code&gt;ggplot2&lt;/code&gt; library to visualise the age effect using the following codes. See our &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;DataViz&#34;&gt;Data Visualisation&lt;/a&gt; guide for tutorials about using &lt;code&gt;ggplot2&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;#We transformed back the x axis from &amp;#34;age score&amp;#34; into actual age by adding 2 and then multiplying by 10.&lt;/span&gt;
plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(Age_eff, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; ((AgeR&lt;span style=&#34;color:#40a070&#34;&gt;+2&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;10&lt;/span&gt;), y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; prob)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_point&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_line&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_errorbar&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(ymin &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; asymp.LCL, ymax &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; asymp.UCL), width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Age&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Probability of weeky cannabis use&amp;#34;&lt;/span&gt;)
    
plot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/apc_age_effect.png&#34; alt=&#34;age-period-cohort age effect&#34; title=&#34;age-period-cohort age effect&#34;/&gt;&lt;/a&gt;
&lt;br/&gt;

&lt;h5 id=&#34;testing-the-joint-cohort-and-period-effect&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#testing-the-joint-cohort-and-period-effect&#34;&gt;Testing the joint cohort and period effect&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To test the joint cohort and period effect, we save the current model into a new variable &lt;code&gt;res_cohort_period&lt;/code&gt; using the following codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;res_cohort_period &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; res
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We then rerun the model without the cohort and period effect (i.e. removing the random effect of cohort and period). This can be done by removing the &lt;em&gt;cohort_cat&lt;/em&gt; and &lt;em&gt;year&lt;/em&gt; from random effect in &lt;strong&gt;StatsNotebook&lt;/strong&gt;&amp;rsquo;s menu or by changing the previous codes. The function &lt;code&gt;glm&lt;/code&gt; will be used instead of &lt;code&gt;glmer&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;glm&lt;/span&gt;(weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool,
  family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; binomial,
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above codes can be used to run the analysis without both cohort and period effect. To test the joint cohort and period effect, we can use a likelihood ratio test comparing both models using the &lt;code&gt;anova&lt;/code&gt; function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;anova&lt;/span&gt;(res_cohort_period, res)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;This produces the output below. These results indicate that the model with cohort and period effect fits the data significantly better than the model without, indicating that at least one of the cohort or period effect is significantly different from zero.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Data&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; currentDataset
Models&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
res&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool
res_cohort_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
res_cohort_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;     (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; cohort_cat) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Year)
                  npar   AIC   BIC logLik deviance Chisq Df &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;Chisq)    
res                  &lt;span style=&#34;color:#40a070&#34;&gt;7&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34069&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34136&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-17028&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;34055&lt;/span&gt;                        
res_cohort_period    &lt;span style=&#34;color:#40a070&#34;&gt;9&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;33929&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34014&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-16956&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;33911&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;144.2&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2.2e-16&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
&lt;span style=&#34;color:#666&#34;&gt;---&lt;/span&gt;
Signif. codes&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;***&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;**&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;testing-the-cohort-effect&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#testing-the-cohort-effect&#34;&gt;Testing the cohort effect&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;We can also test the cohort or period effect individually. For example, we can test the cohort effect by running a model with only period effect, and compare this model with the model with both cohort and period effect. The following is generated by removing &lt;em&gt;cohort_cat&lt;/em&gt; from the random effect in &lt;strong&gt;StatsNotebook&lt;/strong&gt;&amp;rsquo;s menu. We save the model output to the variable &lt;em&gt;res_period&lt;/em&gt; instead of the default &lt;em&gt;res&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;glmer&lt;/span&gt;(weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Year),
  family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; binomial,
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;#We add the line of codes to save the model result to the variable res_period&lt;/span&gt;
res_period &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; res
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Similarly, we use the &lt;code&gt;anova&lt;/code&gt; function to compare the model with both cohort and period effect and the model with only period effect.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;anova&lt;/span&gt;(res_cohort_period, res_period)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This test produces the following results. The model with both cohort and period effect fits the data significantly better than the model with only period effect. This indicates that the cohort effect is significantly different from zero.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Data&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; currentDataset
Models&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
res_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
res_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;     (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Year)
res_cohort_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
res_cohort_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;     (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; cohort_cat) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Year)
                  npar   AIC   BIC logLik deviance  Chisq Df &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;Chisq)    
res_period           &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34049&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34125&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-17016&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;34033&lt;/span&gt;                         
res_cohort_period    &lt;span style=&#34;color:#40a070&#34;&gt;9&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;33929&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34014&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-16956&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;33911&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;121.81&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2.2e-16&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
&lt;span style=&#34;color:#666&#34;&gt;---&lt;/span&gt;
Signif. codes&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;***&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;**&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;testing-the-period-effect&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#testing-the-period-effect&#34;&gt;Testing the period effect&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The period effect can be tested similiarly by comparing the model with both cohort and period effect against the model with only the cohort effect with the following codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;glmer&lt;/span&gt;(weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; cohort_cat),
  family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; binomial,
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)

res_cohort &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; res

&lt;span style=&#34;color:#06287e&#34;&gt;anova&lt;/span&gt;(res_cohort_period, res_cohort)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;These codes produce the following results, which indicates that the period effect is also significantly different from zero.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Data&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; currentDataset
Models&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
res_cohort&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
res_cohort&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;     (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; cohort_cat)
res_cohort_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; weekly_cannabis &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; AgeR &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; AgeR2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; HighSchool &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
res_cohort_period&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;     (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; cohort_cat) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;cyw195510  Year)
                  npar   AIC   BIC logLik deviance  Chisq Df &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;Chisq)    
res_cohort           &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;33950&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34026&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-16967&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;33934&lt;/span&gt;                         
res_cohort_period    &lt;span style=&#34;color:#40a070&#34;&gt;9&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;33929&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;34014&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-16956&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;33911&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;23.093&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.543e-06&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
&lt;span style=&#34;color:#666&#34;&gt;---&lt;/span&gt;
Signif. codes&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;***&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;**&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;visualising-the-cohort-effect&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#visualising-the-cohort-effect&#34;&gt;Visualising the cohort effect&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Now that we know there are cohort and period effect on weekly cannabis use. We can visualise both effects. Suppose that we have stored the results from the model with both cohort and period effect into the variable &lt;code&gt;res_cohort_period&lt;/code&gt;. We can use the &lt;code&gt;ranef&lt;/code&gt; function to extract the random effect components, the cohort and period effect, from this model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;#Extract the random effect&lt;/span&gt;
u0 &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;ranef&lt;/span&gt;(res_cohort_period, condVar &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;names&lt;/span&gt;(u0&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Year) &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;est&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;names&lt;/span&gt;(u0&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;cohort_cat) &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;est&amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;#Extract the standard error&lt;/span&gt;
period_eff &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;data.frame&lt;/span&gt;(est &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; u0&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Year, se &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sqrt&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;attr&lt;/span&gt;(u0[[1]], &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;postVar&amp;#34;&lt;/span&gt;)[1, ,]),
  period &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;2001&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2004&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2010&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2013&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2016&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;))
cohort_eff &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;data.frame&lt;/span&gt;(est &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; u0&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;cohort_cat, se &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sqrt&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;attr&lt;/span&gt;(u0[[2]], &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;postVar&amp;#34;&lt;/span&gt;)[1, ,]),
  cohort &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;1941/50&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;1951/60&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;1961/70&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;1971/80&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;1981/90&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;1991/2000&amp;#34;&lt;/span&gt;))

period_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;upper &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; period_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;est &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.96&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;period_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;se
period_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;lower &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; period_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;est &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.96&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;period_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;se
cohort_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;upper &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; cohort_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;est &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.96&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;cohort_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;se
cohort_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;lower &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; cohort_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;est &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.96&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;cohort_eff&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;se

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;#Visualise the period and cohort effect using ggplot2&lt;/span&gt;
plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(period_eff, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; period, y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; est)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_point&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_errorbar&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(ymin &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lower, ymax &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; upper), width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;.2&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Year&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Conditional log odds of the period effect&amp;#34;&lt;/span&gt;)

plot

plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(cohort_eff, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; cohort, y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; est)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_point&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_errorbar&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(ymin &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lower, ymax &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; upper), width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;.2&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Year&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Conditional log odds of the cohort effect&amp;#34;&lt;/span&gt;)

plot

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/apc_period_effect.png&#34; alt=&#34;age-period-cohort period effect&#34; title=&#34;age-period-cohort period effect&#34;/&gt;&lt;/a&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/apc_cohort_effect.png&#34; alt=&#34;age-period-cohort cohort effect&#34; title=&#34;age-period-cohort cohort effect&#34;/&gt;&lt;/a&gt;
</description>
    </item>
    
    <item>
      <title>Animated plots</title>
      <link>https://statsnotebook.io/blog/dataviz/animate/</link>
      <pubDate>Sat, 26 Dec 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/animate/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Animated plots can be created using the &lt;code&gt;gganimate&lt;/code&gt; package, an extension of the &lt;code&gt;ggplot2&lt;/code&gt; package.&lt;/p&gt;
&lt;p&gt;We will use the built-in &lt;strong&gt;Gapminder&lt;/strong&gt; dataset for scatterplot example and the &lt;strong&gt;COVID-19&lt;/strong&gt; data for the line graph, world map and barchart. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;Load example data&#34;&gt;here&lt;/a&gt;. The &lt;strong&gt;UNDP&lt;/strong&gt; data can be downloaded from here &lt;a href=&#34;https://statsnotebook.io/blog/data_management/example_data/HDI_countries.csv&#34;/&gt;
    here
&lt;/a&gt; and the &lt;strong&gt;COVID-19&lt;/strong&gt; data can also be downloaded from here &lt;a href=&#34;https://statsnotebook.io/blog/data_management/example_data/covid19_long.csv&#34;/&gt;
    here
&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this tutorial, we will build&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#animated-scatterplot-1&#34;&gt;Animated scatterplot 1&lt;/a&gt;
        &lt;a href=&#34;#animated-scatterplot-1&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_scatterplot.gif&#34; alt=&#34;Animated scatterplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#animated-scatterplot-2&#34;&gt;Animated scatterplot 2&lt;/a&gt;
        &lt;a href=&#34;#animated-scatterplot-2&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_scatterplot2.gif&#34; alt=&#34;Animated scatterplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#animated-scatterplot-3&#34;&gt;Animated scatterplot 3&lt;/a&gt;
        &lt;a href=&#34;#animated-scatterplot-3&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_scatterplot3.gif&#34; alt=&#34;Animated scatterplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#animated-line-graph&#34;&gt;Animated line graph&lt;/a&gt;
        &lt;a href=&#34;#animated-line-graph&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_line_graph.gif&#34; alt=&#34;Animated line graph&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#animated-world-map&#34;&gt;Animated World Map&lt;/a&gt;
        &lt;a href=&#34;#animated-world-map&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_world_map_1s.gif&#34; alt=&#34;Animated world map&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#animated-bar-chart&#34;&gt;Animated Barchart&lt;/a&gt;
        &lt;a href=&#34;#animated-bar-chart&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_bar_chart.gif&#34; alt=&#34;Animated bar chart&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h5 id=&#34;description-of-the-gapminder-data&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#description-of-the-gapminder-data&#34;&gt;Description of the Gapminder data&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The Gapminder dataset is a dataset of 199 countries compiled from the United Nations Development Programme. This dataset will be used for the scatterplot examples. The following variables will be used.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;lifeExp - Life expectany in years&lt;/li&gt;
&lt;li&gt;gdpPercap - Gross domestic product per capita in US dollar (inflation adjusted)&lt;/li&gt;
&lt;li&gt;continent - Continent of the countries&lt;/li&gt;
&lt;li&gt;pop - Population size&lt;/li&gt;
&lt;li&gt;year - Year&lt;/li&gt;
&lt;li&gt;country - Country name&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/gapminder.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;description-of-the-covid-19-data&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#description-of-the-covid-19-data&#34;&gt;Description of the COVID-19 data&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;This is a data compiled by the Johns Hopkin University between 22nd Jan 2020 and 29th Dec 2020. This dataset will be used for the &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/animate/#animated-line-graph&#34; title=&#34;line graph&#34;&gt;line graph&lt;/a&gt;, &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/animate/#animated-world-map-1&#34; title=&#34;world map&#34;&gt;world map&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/animate/#animated-bar-chart&#34; title=&#34;barchart&#34;&gt;barchart&lt;/a&gt; examples. The data is in wide format and will need to be rearranged into a long format. The following variables will be used.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Country - Country name&lt;/li&gt;
&lt;li&gt;Lat - Latitude of the country&lt;/li&gt;
&lt;li&gt;Long - Longitude of the country&lt;/li&gt;
&lt;li&gt;Date - Date.&lt;/li&gt;
&lt;li&gt;total_case - Number of total case since 22/01/2020.&lt;/li&gt;
&lt;li&gt;new_case - Number of new cases each day.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/covid19_long.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;animated-scatterplot-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#animated-scatterplot-1&#34;&gt;Animated scatterplot 1&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;In this example, we will use the &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/animate/#description-of-the-gapminder-data&#34; title=&#34;COVID-19 data&#34;&gt;Gapminder&lt;/a&gt; data
To build a basis animated scatterplot visualising the association between two numerica variables (e.g. Life expectancy and Per capital GDP [in log scale]), and animate over a third variable (e.g. Year),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Correlation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Scatterplot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Scatterplot&lt;/strong&gt; panel, select &lt;em&gt;lifeExp&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt;, &lt;em&gt;gdpPercap&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt; and &lt;em&gt;year&lt;/em&gt; to &lt;em&gt;Frame&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;To show the data in different color, select &lt;em&gt;continent&lt;/em&gt; to &lt;em&gt;Fill color&lt;/em&gt;. We will need to code &lt;em&gt;continent&lt;/em&gt; into &lt;strong&gt;factor&lt;/strong&gt; because they are &lt;strong&gt;categorical&lt;/strong&gt; variables. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for a step-by-step guide.&lt;/li&gt;
&lt;li&gt;To show the display the data point by population size, select &lt;em&gt;pop&lt;/em&gt; to &lt;em&gt;Size&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Scatterplot&lt;/strong&gt; panel
&lt;ul&gt;
&lt;li&gt;check &lt;strong&gt;Log scale for the horizontal axis&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Set the &lt;strong&gt;width&lt;/strong&gt; and &lt;strong&gt;height&lt;/strong&gt; of the plot in pixels. In this example, both width and height are set to 700.&lt;/li&gt;
&lt;li&gt;Enter the file name of the plot, in this example, we set the file name to &amp;ldquo;animated_scatterplot&amp;rdquo;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To fine tune the plot, expand the &lt;strong&gt;Label, Settings and Theme&lt;/strong&gt; panel
&lt;ul&gt;
&lt;li&gt;Click &lt;strong&gt;Switch to Advanced Mode&lt;/strong&gt; for customisable setting (e.g. font size, color schemes, etc).&lt;/li&gt;
&lt;li&gt;For &lt;strong&gt;Title&lt;/strong&gt;, we will use &amp;ldquo;Scatterplot of Per capita gross domestic product (log-scale) and Life expectancy&amp;rdquo;&lt;/li&gt;
&lt;li&gt;For &lt;strong&gt;horizontal axis&lt;/strong&gt;, we will use &amp;ldquo;Per capita gross domestic product, US$, (inflation adjusted)&amp;rdquo;&lt;/li&gt;
&lt;li&gt;For &lt;strong&gt;Vertical axis&lt;/strong&gt;, we will use &amp;ldquo;Life expectancy&amp;rdquo;&lt;/li&gt;
&lt;li&gt;For &lt;strong&gt;Legends&lt;/strong&gt;, we will set &amp;ldquo;Continent&amp;rdquo; as Color Fill Label and &amp;ldquo;Population&amp;rdquo; as Size label. We will also set the Legend position to &amp;ldquo;Right&amp;rdquo;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R Codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(continent, pop) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lifeExp, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; gdpPercap, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; pop)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; continent), na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_x_log10&lt;/span&gt;()&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Per capita gross domestic product (log-scale) and Life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Per capita gross domestic product, US$, (inflation adjusted)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population&amp;#34;&lt;/span&gt;)
plot

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_time&lt;/span&gt;(year)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;year: {frame_time}&amp;#34;&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;animated_scatterplot.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Animated plot saved at &amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;getwd&lt;/span&gt;()) 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/animated_scatterplot_ex1.gif&#34; alt=&#34;animated scatterplot&#34; title=&#34;animated scatterplot&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;further-customisation-with-manual-codings&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#further-customisation-with-manual-codings&#34;&gt;Further customisation with manual codings&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;First, we can adjust the scale of population to million by changing the line&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lifeExp, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; gdpPercap, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; pop)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lifeExp, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; gdpPercap, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; pop&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;1000000&lt;/span&gt;)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;To reflect the new scale, we change the legend label by changing the line&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population (millions)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Second, we can adjust the size of the bubble and break point of the legend by changing the line&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;), breaks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;250&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;750&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;1250&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The smallest bubble will now have a size of 2 and the largest one will have a size of 20. The break point of the legend will be at 250, 750 and 1250 (millions).&lt;/p&gt;
&lt;p&gt;Third, we can change the number presentation in the x-axis from scientic notation to normal by changing the line&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;scale_x_log10&lt;/span&gt;()&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;scale_x_log10&lt;/span&gt;(labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Forth, we can adjust the size of the font in various section of the plots (e.g. title, x-axis/y-axis title, etc) by adding the following codes at the end of the &lt;strong&gt;ggplot&lt;/strong&gt; function. We will need to also add the &lt;strong&gt;+&lt;/strong&gt; sign to the previous line of code to concatenate the codes for the &lt;strong&gt;ggplot&lt;/strong&gt; function. The last line of code is to adjust the size of the color legend.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;guides&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;guide_legend&lt;/span&gt;(override.aes &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;)))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;complete-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#complete-r-codes&#34;&gt;Complete R codes&lt;/a&gt;&lt;/h5&gt;
&lt;br/&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(continent, pop) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lifeExp, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; gdpPercap, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; pop&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;1000000&lt;/span&gt;)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; continent), na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;), breaks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;250&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;750&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;1250&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_x_log10&lt;/span&gt;(labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Per capita gross domestic product (log-scale) and Life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Per capita Gross domestic product, US$ (inflation adjusted)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population (millions)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;guides&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;guide_legend&lt;/span&gt;(override.aes &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;)))
plot

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_time&lt;/span&gt;(year)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Year: {frame_time}&amp;#34;&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;656&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;animated_scatterplot.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Animated plot saved at &amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;getwd&lt;/span&gt;()) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/animated_scatterplot_ex2.gif&#34; alt=&#34;animated scatterplot&#34; title=&#34;animated scatterplot&#34;/&gt;&lt;/a&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;h5 id=&#34;animated-scatterplot-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#animated-scatterplot-2&#34;&gt;Animated scatterplot 2&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To plot different continent in different sub-plot, follow the above steps and add the following line to the &lt;strong&gt;ggplot&lt;/strong&gt; function. Depending the position you insert this line, you will need to add a &lt;strong&gt;+&lt;/strong&gt; sign to the previous line and also the end of this line.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; continent)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-1&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Below is the complete R codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(continent, pop) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lifeExp, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; gdpPercap, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; pop&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;1000000&lt;/span&gt;)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; continent), na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;), breaks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;250&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;750&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;1250&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; continent)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_x_log10&lt;/span&gt;(labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Per capita gross domestic product (log-scale) and Life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Per capita Gross domestic product, US$ (inflation adjusted)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population (millions)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;guides&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;guide_legend&lt;/span&gt;(override.aes &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;)))
plot

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_time&lt;/span&gt;(year)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Year: {frame_time}&amp;#34;&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;656&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;animated_scatterplot.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Animated plot saved at &amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;getwd&lt;/span&gt;()) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-2&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/animated_scatterplot_ex3.gif&#34; alt=&#34;animated scatterplot&#34; title=&#34;animated scatterplot&#34;/&gt;&lt;/a&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;h5 id=&#34;animated-scatterplot-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#animated-scatterplot-3&#34;&gt;Animated scatterplot 3&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To show year in different color and continents in different frame, the steps will be very similar to those in the above examples, except that now we select &lt;em&gt;year&lt;/em&gt; into &lt;em&gt;Fill color&lt;/em&gt; and &lt;em&gt;continent&lt;/em&gt; into &lt;em&gt;Frame&lt;/em&gt;.&lt;/p&gt;

&lt;h5 id=&#34;complete-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#complete-r-codes-1&#34;&gt;Complete R Codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;In the codes below, we have also included all the customisation codes from above.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(year, pop) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lifeExp, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; gdpPercap, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; pop&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;1000000&lt;/span&gt;)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; year), na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;12&lt;/span&gt;), breaks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;250&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;750&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;1250&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_x_log10&lt;/span&gt;(labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Per capita gross domestic product (log-scale) and life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Per capita gross domestic product, US$ (inflation adjusted)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Life expectancy&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Year&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Year&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))
plot

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_states&lt;/span&gt;(continent, transition_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, state_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent: {closest_state}&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;enter_fade&lt;/span&gt;()&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;exit_shrink&lt;/span&gt;()
&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;656&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;animated_scatterplot.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Animated plot saved at &amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;getwd&lt;/span&gt;()) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-3&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/animated_scatterplot_ex4.gif&#34; alt=&#34;animated scatterplot&#34; title=&#34;animated scatterplot&#34;/&gt;&lt;/a&gt;
&lt;br/&gt;&lt;/p&gt;

&lt;h5 id=&#34;animated-line-graph&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#animated-line-graph&#34;&gt;Animated line graph&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Animated line graph is often used to show the evoluation of a time series. Creating an animated line graph in &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt; is similar to creating a &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/line_graph/&#34; title=&#34;static line graph&#34;&gt;static line graph&lt;/a&gt;. In this example, we limit the data to Australia and New Zealand. To do this, we will need to run the following codes after loading the data.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;filter&lt;/span&gt;(Country &lt;span style=&#34;color:#666&#34;&gt;%in%&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Australia&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;New Zealand&amp;#34;&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;To create a line graph showing the number of new COVID-19 cases in Australia and New Zealand, we can&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Line&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Line graph/ Time Series&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Line graph&lt;/strong&gt; panel, select &lt;em&gt;new_case&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt;, &lt;em&gt;date&lt;/em&gt; to &lt;em&gt;Horizontal axis&lt;/em&gt; and &lt;em&gt;Country&lt;/em&gt; to &lt;em&gt;Fill color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;We will need to code &lt;em&gt;Country&lt;/em&gt; into &lt;strong&gt;factor&lt;/strong&gt; because they are &lt;strong&gt;categorical&lt;/strong&gt; variables. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for a step-by-step guide.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Line Graph Setting&lt;/strong&gt; panel, check &lt;em&gt;Animate&lt;/em&gt;
&lt;ul&gt;
&lt;li&gt;We can set the Width and Height for your animated plot. In this example, we use 700 for width and 656 for height.&lt;/li&gt;
&lt;li&gt;We can also set the file name of the plot.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To set the title, horizontal and vertical axis and font size, we can expand the &lt;strong&gt;Label and Theme&lt;/strong&gt; panel, and
&lt;ul&gt;
&lt;li&gt;Click on &lt;strong&gt;Switch to Advanced mode&lt;/strong&gt; and set the corresponding attributes.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;br/&gt;

&lt;h5 id=&#34;r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-2&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; new_case, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; date, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Country)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_line&lt;/span&gt;(na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.8&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of new COVID19 cases&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Date&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of new cases&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Country&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; 
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.title.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;16&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.text.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;))
plot

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_reveal&lt;/span&gt;(date)

&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;656&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;animated_linegraph.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Animated plot saved at &amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;getwd&lt;/span&gt;())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-4&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-4&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/animated_line_graph.gif&#34; alt=&#34;animated scatterplot&#34; title=&#34;animated scatterplot&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;animated-world-map&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#animated-world-map&#34;&gt;Animated world map&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Point-and-click menu for plotting world map is not yet available in &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;. To draw the boundary of each countries, we will use world map data returned by the &lt;code&gt;map_data&lt;/code&gt; from &lt;code&gt;ggplot2&lt;/code&gt;. After loading the &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/animate/#description-of-the-covid-19-data&#34; title=&#34;COVID-19 data&#34;&gt;COVID-19&lt;/a&gt; data, we run the following code to load the world map data into the variable &lt;code&gt;world_map&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;world_map &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;map_data&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;world&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We then only retain rows with 1 or more cases by using the following line.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;filter&lt;/span&gt;(total_case &lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We will use the &lt;code&gt;geom_polygon&lt;/code&gt; function to draw the boundary of each country based on the latitude and longitude data from the variable &lt;code&gt;world_map&lt;/code&gt;. We use the size of the data point to represent the number of total cases in each country by using the &lt;code&gt;size&lt;/code&gt; aesthetic. Finally, we use the &lt;code&gt;theme&lt;/code&gt; function to setup the canvas for plotting maps with &lt;code&gt;ggplot&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We use the following codes to set up the plot.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_polygon&lt;/span&gt;(data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; world_map, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;lightgray&amp;#34;&lt;/span&gt;, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; long, y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lat, group &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; group)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_point&lt;/span&gt;(data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; covid19_long, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Long, y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Lat, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; total_case), alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;red&amp;#34;&lt;/span&gt;, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;red&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;scale_size_continuous&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;), labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.ticks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.line &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.border &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        plot.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;35&lt;/span&gt;),
        plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;25&lt;/span&gt;),
        legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.02&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;0.08&lt;/span&gt;),
        legend.justification &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.02&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;0.08&lt;/span&gt;),
        legend.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;),
        legend.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;12&lt;/span&gt;)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of cases&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We then use the &lt;code&gt;transition_states&lt;/code&gt; function from the &lt;code&gt;gganimate&lt;/code&gt; library to specify the transition to be based on the &lt;strong&gt;data&lt;/strong&gt; variable.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_states&lt;/span&gt;(date, transition_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, state_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of COVID-19 cases&amp;#34;&lt;/span&gt;,
       subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Date: {closest_state}&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Lastly, we use the &lt;code&gt;animate&lt;/code&gt; function to create the animated plot. We can use the &lt;em&gt;weight&lt;/em&gt; and &lt;em&gt;height&lt;/em&gt; parameter to set the size of the plot. we can use the &lt;em&gt;nframes&lt;/em&gt; parameter to set the total number of frame in the animation, and the &lt;em&gt;fps&lt;/em&gt; parameter to set the frame per second. We then use the &lt;code&gt;anim_save&lt;/code&gt; function to save the plot.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, nframes&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;800&lt;/span&gt;, fps &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;30&lt;/span&gt;, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1200&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;800&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())

&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;tmp_map.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt; 

&lt;h5 id=&#34;complete-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#complete-r-codes-2&#34;&gt;Complete R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Suppose the &lt;strong&gt;COVID-19&lt;/strong&gt; data was alreadly loaded into the dataframe &lt;strong&gt;currentDataset&lt;/strong&gt;, the following is the complete code for creating an animated world map showing the evolution of COVID-19 around the world.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;world_map &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;map_data&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;world&amp;#34;&lt;/span&gt;)

currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;filter&lt;/span&gt;(total_case &lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;)

plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_polygon&lt;/span&gt;(data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; world_map, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;lightgray&amp;#34;&lt;/span&gt;, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; long, y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; lat, group &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; group)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_point&lt;/span&gt;(data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Long, y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Lat, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; total_case), alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;red&amp;#34;&lt;/span&gt;, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;red&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;scale_size_continuous&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;), labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.ticks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.line &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.border &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        plot.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;35&lt;/span&gt;),
        plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;25&lt;/span&gt;),
        legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.02&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;0.08&lt;/span&gt;),
        legend.justification &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.02&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;0.08&lt;/span&gt;),
        legend.title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt;),
        legend.text &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;12&lt;/span&gt;)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of cases&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_states&lt;/span&gt;(date, transition_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, state_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of COVID-19 cases&amp;#34;&lt;/span&gt;,
       subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Date: {closest_state}&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, nframes&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;800&lt;/span&gt;, fps &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;30&lt;/span&gt;, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1200&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;800&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())

&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;tmp_map.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt; 

&lt;h5 id=&#34;output-from-the-above-r-codes-5&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-5&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/animated_world_map_1.gif&#34; alt=&#34;animated world map&#34; title=&#34;animated world map&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;animated-bar-chart&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#animated-bar-chart&#34;&gt;Animated bar chart&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Point-and-click menu for creating racing barchart is not yet available in &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;. Both the &lt;code&gt;geom_bar&lt;/code&gt; and &lt;code&gt;geom_tile&lt;/code&gt; can be used to create animated bar chart. In this example, we use &lt;code&gt;geom_tile&lt;/code&gt;. After loading the &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/animate/#description-of-the-covid-19-data&#34; title=&#34;COVID-19 data&#34;&gt;COVID-19&lt;/a&gt; data, we run the following code to rank the countries by number of tocal COVID cases on each day, and only retain the top ten countries on each day.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;group_by&lt;/span&gt;(date) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;mutate&lt;/span&gt;(rank &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rank&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;total_case)) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;group_by&lt;/span&gt;(Country) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;filter&lt;/span&gt;(rank &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;10&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ungroup&lt;/span&gt;()

currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;rank &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;round&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;rank)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We then use the following codes to create the plot. We use &lt;code&gt;geom_text&lt;/code&gt; to add the country name and number of cases at the front and end of the bars. We use &lt;code&gt;coord_flip&lt;/code&gt; to flip the coordinate system to create the horizontal bars.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;plot &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; 
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(rank, group &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Country, 
                fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Country, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Country)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_tile&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; total_case&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;,
                height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; total_case,
                width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.9&lt;/span&gt;), alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.8&lt;/span&gt;, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_text&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;, label &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(Country, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)), hjust &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_text&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;total_case,label &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;, total_case), ), hjust&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;coord_flip&lt;/span&gt;(clip &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;off&amp;#34;&lt;/span&gt;, expand &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;scale_y_continuous&lt;/span&gt;(labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;scale_x_reverse&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;guides&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.line &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.text.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.text.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.ticks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.title.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.title.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;none&amp;#34;&lt;/span&gt;,
        panel.background &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.border &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.grid.major &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.grid.minor &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.grid.major.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_line&lt;/span&gt;( size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;.1&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt; ),
        panel.grid.minor.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_line&lt;/span&gt;( size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;.1&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt; ),
        plot.title  &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;35&lt;/span&gt;, face&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bold&amp;#34;&lt;/span&gt;, colour&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt;),
        plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;25&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt;),
        plot.caption &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt;),
        plot.background&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        plot.margin &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;margin&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;cm&amp;#34;&lt;/span&gt;))
       
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We then use the &lt;code&gt;transition_states&lt;/code&gt; function from the &lt;code&gt;gganimate&lt;/code&gt; library to specify the transition to be based on the &lt;strong&gt;date&lt;/strong&gt; variable. Since this is not a typical use of the &lt;code&gt;geom_tile&lt;/code&gt; function and R would issue warnings about its use. We disable the warnings in the first line.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;options&lt;/span&gt;(warn &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-1&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt;plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_states&lt;/span&gt;(date, transition_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, state_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;view_follow&lt;/span&gt;(fixed_x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)  &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of COVID-19 cases&amp;#34;&lt;/span&gt;,  
       subtitle  &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Top 10 Countries&amp;#34;&lt;/span&gt;,
       caption &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Date: {closest_state}&amp;#34;&lt;/span&gt;)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Lastly, we use the &lt;code&gt;animate&lt;/code&gt; function to create the animated plot. We can use the &lt;em&gt;weight&lt;/em&gt; and &lt;em&gt;height&lt;/em&gt; parameter to set the size of the plot. we can use the &lt;em&gt;nframes&lt;/em&gt; parameter to set the total number of frame in the animation, and the &lt;em&gt;fps&lt;/em&gt; parameter to set the frame per second. We then use the &lt;code&gt;anim_save&lt;/code&gt; function to save the plot.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, nframes&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;1200&lt;/span&gt;, fps &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;656&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())

&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;tmp.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;complete-r-codes-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#complete-r-codes-3&#34;&gt;Complete R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;group_by&lt;/span&gt;(date) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;mutate&lt;/span&gt;(rank &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rank&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;total_case)) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;group_by&lt;/span&gt;(Country) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;filter&lt;/span&gt;(rank &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;10&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ungroup&lt;/span&gt;()
    
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;rank &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;round&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;rank)

plot &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; 
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(rank, group &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Country, 
                fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Country, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Country)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_tile&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; total_case&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;,
                height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; total_case,
                width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.9&lt;/span&gt;), alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.8&lt;/span&gt;, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_text&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;, label &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(Country, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)), hjust &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_text&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;total_case,label &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;paste&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;, total_case), ), hjust&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;coord_flip&lt;/span&gt;(clip &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;off&amp;#34;&lt;/span&gt;, expand &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;scale_y_continuous&lt;/span&gt;(labels &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; scales&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;comma) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;scale_x_reverse&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;guides&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(axis.line &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.text.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.text.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.ticks &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        axis.title.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
         axis.title.y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;none&amp;#34;&lt;/span&gt;,
        panel.background &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.border &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.grid.major &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.grid.minor &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
        panel.grid.major.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_line&lt;/span&gt;( size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;.1&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt; ),
        panel.grid.minor.x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_line&lt;/span&gt;( size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;.1&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt; ),
        plot.title  &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;35&lt;/span&gt;, face&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bold&amp;#34;&lt;/span&gt;, colour&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt;),
        plot.subtitle &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;25&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt;),
        plot.caption &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;element_text&lt;/span&gt;(size&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;, color&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gray&amp;#34;&lt;/span&gt;),
        plot.background&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;element_blank&lt;/span&gt;(),
       plot.margin &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;margin&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;cm&amp;#34;&lt;/span&gt;))
       
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gganimate)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(gifski)

&lt;span style=&#34;color:#06287e&#34;&gt;options&lt;/span&gt;(warn &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-1&lt;/span&gt;)
animated_plot &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt;plot &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;transition_states&lt;/span&gt;(date, transition_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, state_length &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;view_follow&lt;/span&gt;(fixed_x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)  &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(title &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;# of COVID-19 cases&amp;#34;&lt;/span&gt;,  
       subtitle  &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Top 10 Countries&amp;#34;&lt;/span&gt;,
       caption &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Date: {closest_state}&amp;#34;&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;animate&lt;/span&gt;(animated_plot, nframes&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;1200&lt;/span&gt;, fps &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;, width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;700&lt;/span&gt;, height &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;656&lt;/span&gt;, renderer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;gifski_renderer&lt;/span&gt;())

&lt;span style=&#34;color:#06287e&#34;&gt;anim_save&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;tmp.gif&amp;#34;&lt;/span&gt;, animation &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;last_animation&lt;/span&gt;())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-6&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-6&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/animated_bar_chart.gif&#34; alt=&#34;animated scatterplot&#34; title=&#34;animated scatterplot&#34;/&gt;&lt;/a&gt;
</description>
    </item>
    
    <item>
      <title>Robust regression</title>
      <link>https://statsnotebook.io/blog/analysis/robust_regression/</link>
      <pubDate>Tue, 08 Dec 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/robust_regression/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Outliers and violations of distributional assumptions are common in many area of research. These issues might introduce substantial bias in the analysis and potentially lead to grossly incorrect inferences. Traditionally, outliers are identified through manual inspection of the data; violations of normality are often addressed by data transformation. Other forms of assumption violations, such as heterogeneity in variance, can be more challenging to address (Assumptions for linear regression can be checked using &lt;a href=&#34;https://statsnotebook.io/blog/analysis/linearity_homoscedasticity/&#34; title=&#34;Residual plots and assumption checking for linear regression&#34;&gt;residual plots&lt;/a&gt;). Robust regression is a technique that can reduce the impact of outliers, violation of the distribution assumption and heterogeneity in variance. It should be noted that the &lt;em&gt;linearity assumption&lt;/em&gt; is still needed for proper inference using robust regression.&lt;/p&gt;
&lt;p&gt;In this example, we will use the &lt;strong&gt;Stars&lt;/strong&gt; dataset from the &lt;code&gt;Robustbase&lt;/code&gt; package. We have built this example data into &lt;strong&gt;StatsNotebook&lt;/strong&gt; and it can be loaded using the instructions provided &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;load example data&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/stars.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In this dataset, there are two variables.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;temperature&lt;/strong&gt; represents the surface temperature of a star&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;light&lt;/strong&gt; represents the light intensity of a star&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The figure below shows the scatterplot between &lt;em&gt;temperature&lt;/em&gt; and &lt;em&gt;light&lt;/em&gt; with a regression line. At first glance, there appears to be a downward trend. However, this trend may only be caused by the few outliers at the top left corner.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/scatter_plot_outliers.png&#34; alt=&#34;scatterplot with outliers&#34; title=&#34;scatterplot with outliers&#34;/&gt;&lt;/a&gt;
&lt;p&gt;We will now demonstrate the use of robust regression to adjust for these outliers.&lt;/p&gt;

&lt;h5 id=&#34;using-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Steps for running a &lt;strong&gt;Robust regression&lt;/strong&gt; in &lt;strong&gt;StatsNotebook&lt;/strong&gt; are nearly the same as running a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/regression/&#34; title=&#34;Linear regression&#34;&gt;&lt;strong&gt;linear regression&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear Regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;light&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, and select &lt;em&gt;temperature&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Analysis setting&lt;/strong&gt; panel, and click &lt;strong&gt;Robust regression&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes-explained&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained&#34;&gt;R codes explained&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The codes for a robust regression are nearly the same as those for linear regression, except that we use the &lt;code&gt;lmrob&lt;/code&gt; function from the &lt;code&gt;robustbase&lt;/code&gt; package instead of the &lt;code&gt;lm&lt;/code&gt; function for linear regression.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(robustbase) 
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lmrob&lt;/span&gt;(light &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; temperature,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res),&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The output from robust regression is also very similar to those from linear regression. The only exception now is that that the observations are now weighted based on how deviant they are, and also robust standard errors will be computed for model estimates. After adjusting for a few outliers, we find that temperature is positively associated with light intensity, b = 2.25, 95% CI (0.70, 3.80), &lt;em&gt;p&lt;/em&gt; =.005. We also show the regression line estimated from the robust regression in the figure below. The &lt;span style=&#34;color: blue&#34;&gt;&lt;b&gt;blue&lt;/b&gt;&lt;/span&gt; line is the regression line from ordinary linear regression and the &lt;span style=&#34;color: red&#34;&gt;&lt;b&gt;red&lt;/b&gt;&lt;/span&gt; one is the regression line from the robust regression.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Call&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;lmrob&lt;/span&gt;(formula &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; light &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; temperature, data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
 \&lt;span style=&#34;color:#666&#34;&gt;--&amp;gt;&lt;/span&gt; method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;MM&amp;#34;&lt;/span&gt;
Residuals&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
     Min       &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;Q   Median       &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;Q      Max 
&lt;span style=&#34;color:#40a070&#34;&gt;-0.80959&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.28838&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.00282&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.36668&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;3.39585&lt;/span&gt; 

Coefficients&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
            Estimate Std. Error t value &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;|&lt;/span&gt;t&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;)   
(Intercept)  &lt;span style=&#34;color:#40a070&#34;&gt;-4.9694&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;3.4100&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-1.457&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.15198&lt;/span&gt;   
temperature   &lt;span style=&#34;color:#40a070&#34;&gt;2.2532&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;0.7691&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;2.930&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.00531&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt;
&lt;span style=&#34;color:#666&#34;&gt;---&lt;/span&gt;
Signif. codes&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;***&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;**&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;

Robust residual standard error&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.4715&lt;/span&gt; 
Multiple R&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;squared&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.3737&lt;/span&gt;,	Adjusted R&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;squared&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.3598&lt;/span&gt; 
Convergence in &lt;span style=&#34;color:#40a070&#34;&gt;15&lt;/span&gt; IRWLS iterations

Robustness weights&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; 
 &lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt; observations &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;11&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;30&lt;/span&gt;,&lt;span style=&#34;color:#40a070&#34;&gt;34&lt;/span&gt;) are outliers with &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;weight&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; ( &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0021&lt;/span&gt;); 
 &lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt; weights are &lt;span style=&#34;color:#666&#34;&gt;~=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;. The remaining &lt;span style=&#34;color:#40a070&#34;&gt;39&lt;/span&gt; ones are summarized as
   Min. &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;st Qu.  Median    Mean &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;rd Qu.    Max. 
 &lt;span style=&#34;color:#40a070&#34;&gt;0.6533&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9171&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9593&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9318&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9848&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9986&lt;/span&gt; 
Algorithmic parameters&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; 
       tuning.chi                bb        tuning.psi        refine.tol 
        &lt;span style=&#34;color:#40a070&#34;&gt;1.548e+00&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;5.000e-01&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;4.685e+00&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;1.000e-07&lt;/span&gt; 
          rel.tol         scale.tol         solve.tol       eps.outlier 
        &lt;span style=&#34;color:#40a070&#34;&gt;1.000e-07&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;1.000e-10&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;1.000e-07&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;2.128e-03&lt;/span&gt; 
            eps.x warn.limit.reject warn.limit.meanrw 
        &lt;span style=&#34;color:#40a070&#34;&gt;8.404e-12&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;5.000e-01&lt;/span&gt;         &lt;span style=&#34;color:#40a070&#34;&gt;5.000e-01&lt;/span&gt; 
     nResample         max.it       best.r.s       k.fast.s          k.max 
           &lt;span style=&#34;color:#40a070&#34;&gt;500&lt;/span&gt;             &lt;span style=&#34;color:#40a070&#34;&gt;50&lt;/span&gt;              &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;              &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;            &lt;span style=&#34;color:#40a070&#34;&gt;200&lt;/span&gt; 
   maxit.scale      trace.lev            mts     compute.rd fast.s.large.n 
           &lt;span style=&#34;color:#40a070&#34;&gt;200&lt;/span&gt;              &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;           &lt;span style=&#34;color:#40a070&#34;&gt;1000&lt;/span&gt;              &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;           &lt;span style=&#34;color:#40a070&#34;&gt;2000&lt;/span&gt; 
                  psi           subsampling                   cov 
           &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bisquare&amp;#34;&lt;/span&gt;         &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;nonsingular&amp;#34;&lt;/span&gt;         &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;.vcov.avar1&amp;#34;&lt;/span&gt; 
compute.outlier.stats 
                 &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;SM&amp;#34;&lt;/span&gt; 
seed &lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;int&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;) 

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;######################################################&lt;/span&gt;
                            &lt;span style=&#34;color:#40a070&#34;&gt;2.5&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;%   97.5 %&lt;/span&gt;
(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;-4.969388&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-11.8375510&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.898775&lt;/span&gt;
temperature  &lt;span style=&#34;color:#40a070&#34;&gt;2.253161&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.7041936&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3.802129&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/robust_regression_line.png&#34; alt=&#34;Line of best fit from robust regression&#34; title=&#34;Line of best fit from robust regression&#34;/&gt;&lt;/a&gt;
</description>
    </item>
    
    <item>
      <title>Line chart</title>
      <link>https://statsnotebook.io/blog/dataviz/line_graph/</link>
      <pubDate>Tue, 27 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/line_graph/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Line chart can be used to show the evoluation of &lt;strong&gt;numeric&lt;/strong&gt; variables. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses &lt;code&gt;geom_line()&lt;/code&gt; from &lt;code&gt;ggplot2&lt;/code&gt; to build line chart.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;Human Development Index&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../../data_management/load_example_data&#34;&gt;here&lt;/a&gt;. This is a data from the United Nations Development Programmes (UNDP).&lt;/p&gt;
&lt;p&gt;We will use line chart to visualise the evolution of Human Development Index from 1990 to 2018 across six regions. This dataset contains the following variables&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Region - Region from which the Human Development Index is calculated&lt;/li&gt;
&lt;li&gt;HDI_1990, &amp;hellip; , HDI_2018 - Human Development Index from 1990 to 2018&lt;/li&gt;
&lt;li&gt;GDP_1990, &amp;hellip; , GDP_2018 - Gross Domestic Product per capita from 1990 to 2018&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/HDI.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This data is in wide format&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../img/wide_data.png&#34; alt=&#34;Wide data format&#34;&gt;&lt;/p&gt;
&lt;p&gt;And we will need to &lt;a href=&#34;../../data_management/reshape&#34;&gt;reshape it to a long format&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../img/long_data.png&#34; alt=&#34;long data format&#34;&gt;&lt;/p&gt;
&lt;p&gt;There will be only 4 variables after &lt;a href=&#34;../../data_management/reshape&#34;&gt;reshaping the data&lt;/a&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Region - Region from whcih the Human Development Index is calcuated&lt;/li&gt;
&lt;li&gt;Year - Year&lt;/li&gt;
&lt;li&gt;HDI - Human Development Index&lt;/li&gt;
&lt;li&gt;GDP - Gross Domestic Product per capita&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this example, we will visualise the evolution of Human Development Index across six world regions.&lt;/p&gt;

&lt;h5 id=&#34;line-chart-by-a-grouping-variable&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#line-chart-by-a-grouping-variable&#34;&gt;Line Chart by a grouping variable&lt;/a&gt;&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Line&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Line graph/ Time Series&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;In the line graph panel, select &lt;em&gt;HDI&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt; and &lt;em&gt;Region&lt;/em&gt; to &lt;em&gt;Fill color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Year&lt;/em&gt; can be treated as a numeric variable and &lt;em&gt;Region&lt;/em&gt; is a categorical variable. If these variables are not yet coded as &lt;strong&gt;numeric&lt;/strong&gt; and &lt;strong&gt;factor&lt;/strong&gt; respectively, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert them&lt;/a&gt; into the correct variable type.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/line_chart_instruction.png&#34; alt=&#34;line chart instruction&#34; title=&#34;Line chart by group&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Region) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Region)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_line&lt;/span&gt;(na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/line_chart_by_group.png&#34; alt=&#34;line graph by group&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Reshaping data</title>
      <link>https://statsnotebook.io/blog/data_management/reshape/</link>
      <pubDate>Tue, 27 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/data_management/reshape/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;This tutorial will provide step-by-step guide on reshaping the data from&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#wide-to-long&#34;&gt;Wide to Long&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#long-to-wide&#34;&gt;Long to Wide&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;wide-to-long&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#wide-to-long&#34;&gt;Wide to Long&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;We will use the built-in &lt;strong&gt;Human Development Index&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../load_example_data&#34;&gt;here&lt;/a&gt;. This is a data from the United Nations Development Programmes (UNDP).&lt;/p&gt;
&lt;p&gt;This dataset contains the following variables&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Region - Region from which the Human Development Index is calculated&lt;/li&gt;
&lt;li&gt;HDI_1990, &amp;hellip; , HDI_2018 - Human Development Index from 1990 to 2018&lt;/li&gt;
&lt;li&gt;GDP_1990, &amp;hellip; , GDP_2018 - Gross Domestic Product per capita from 1990 to 2018&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This dataset is in wide format because each row contains data from multiple years (e.g. from 1990 to 2018).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../../dataviz/img/wide_data.png&#34; alt=&#34;Wide data format&#34;&gt;&lt;/p&gt;
&lt;p&gt;Many analyses require the data to be in long format (see below) such that each row represents data from one year.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../../dataviz/img/long_data.png&#34; alt=&#34;Long data format&#34;&gt;&lt;/p&gt;
&lt;p&gt;In &lt;strong&gt;StatsNotebook&lt;/strong&gt;, the conversion from wide to long format can be done with a few clicks. However, the variable names need to be in the format &amp;ldquo;VariableName_Index&amp;rdquo;, such that the variable name is followed by an underscore and then an index (e.g. Measurement_1, Measurement_2, etc).&lt;/p&gt;
&lt;p&gt;To convert the data from wide to long format,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Data&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Reshape&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Wide to Long&lt;/strong&gt; in &lt;strong&gt;Operation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Fill in the &lt;strong&gt;New Variable&lt;/strong&gt; with the variable name for the index (e.g. &lt;em&gt;Year&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;Select the target variables into &lt;strong&gt;Target variables&lt;/strong&gt; (e.g. HDI_1990, &amp;hellip;, HDI_2018 and GDP_1990, &amp;hellip;, GDP_2018)&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/wide_to_long_instruction.png&#34; alt=&#34;Wide to long instruction&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;pivot_longer&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1990&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1991&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1992&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1993&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1994&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1995&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1996&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1997&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1998&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_1999&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2000&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2001&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2002&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2003&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2004&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2005&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2006&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2007&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2008&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2009&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2010&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2011&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2012&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2013&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2014&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2015&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2016&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2017&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI_2018&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_1990&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_1995&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2000&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2005&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2010&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2011&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2012&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2013&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2014&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2015&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2016&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2017&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP_2018&amp;#34;&lt;/span&gt;),
  names_to &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;.value&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Year&amp;#34;&lt;/span&gt;),
  names_pattern &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;(.*)_(.*)&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h4 id=&#34;long-to-wide&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#long-to-wide&#34;&gt;Long to Wide&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;We will use the long format &lt;strong&gt;Human Development Index&lt;/strong&gt; dataset for this example. This dataset can be downloaded from &lt;a href=&#34;../example_data/HDI_region_long.csv&#34;&gt;here&lt;/a&gt;. This is a dataset from the United Nations Development Programmes and contains the following variables.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Region - Region&lt;/li&gt;
&lt;li&gt;Year - Year&lt;/li&gt;
&lt;li&gt;HDI - Human Development Index&lt;/li&gt;
&lt;li&gt;GDP - Gross Domestic Product per capita&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/long_data2.png&#34; alt=&#34;long data&#34;&gt;&lt;/p&gt;
&lt;p&gt;To convert the data from long to wide format,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Data&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Reshape&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Long to Wide&lt;/strong&gt; in &lt;strong&gt;Operation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select the &lt;em&gt;index&lt;/em&gt; variable where the conversion will be based on (e.g. &lt;em&gt;Year&lt;/em&gt; in this example)&lt;/li&gt;
&lt;li&gt;Select &lt;em&gt;HDI&lt;/em&gt; and &lt;em&gt;GDP&lt;/em&gt; to &lt;em&gt;Target Variables&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/long_to_wide_instruction.png&#34; alt=&#34;long to wide instruction&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;pivot_wider&lt;/span&gt;(names_from &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year,
  names_glue &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;{.value}_{Year}&amp;#34;&lt;/span&gt;,
  values_from &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;HDI&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;GDP&amp;#34;&lt;/span&gt;))

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The data will look like the following figure if the data is reshaped successfully.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../../dataviz/img/wide_data.png&#34; alt=&#34;Wide data format&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Scatterplot</title>
      <link>https://statsnotebook.io/blog/dataviz/scatterplot/</link>
      <pubDate>Fri, 23 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/scatterplot/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Scatterplot can be used to visualise the association between two numeric variables. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses the &lt;code&gt;geom_jitter&lt;/code&gt; function from the &lt;code&gt;ggplot2&lt;/code&gt; library to build scatterplot.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;UNDP&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;Load example data&#34;&gt;here&lt;/a&gt; or can be downloaded from &lt;a href=&#34;https://statsnotebook.io/blog/data_management/example_data/HDI_countries.csv&#34;/&gt;
    here
&lt;/a&gt;. This is a dataset of 199 countries compiled from the United Nations Development Programme.&lt;/p&gt;
&lt;p&gt;We will use the following three variables from this dataset&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;HDI - Human Development Index in 2018&lt;/li&gt;
&lt;li&gt;GDP - Gross Domestic Product per capital in 2018&lt;/li&gt;
&lt;li&gt;Pop - Population (in millions) in 2018&lt;/li&gt;
&lt;li&gt;Continent - Continent&lt;/li&gt;
&lt;li&gt;Schooling - Expected years of schooling&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/HDI_countries.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In this example, we will build&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#simple-scatterplot&#34;&gt;Simple scatterplot&lt;/a&gt;
        &lt;a href=&#34;#simple-scatterplot&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/simple_scatterplot.png&#34; alt=&#34;Simple scatterplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#bubble-plot&#34;&gt;Bubble plot&lt;/a&gt;
        &lt;a href=&#34;#bubble-plot&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/bubble_plot2.png&#34; alt=&#34;Bubble plot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#scatterplot-with-line-of-best-fit&#34;&gt;Scatterplot with a fitted line&lt;/a&gt;
        &lt;a href=&#34;#scatterplot-with-line-of-best-fit&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/scatterplot_with_line.png&#34; alt=&#34;Sctterplot with line of best fit&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#scatterplot-with-line-of-best-fit-by-groups&#34;&gt;Scatterplot with fitted lines&lt;/a&gt;
        &lt;a href=&#34;#scatterplot-with-line-of-best-fit-by-groups&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/scatterplot_with_line_by_groups.png&#34; alt=&#34;Sctterplot with line of best fit&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#scatterplots-in-multiple-facets&#34;&gt;Scatterplots in facets&lt;/a&gt;
        &lt;a href=&#34;#scatterplots-in-multiple-facets&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/scatterplot_with_line_by_groups_with_facets.png&#34; alt=&#34;Sctterplot with line of best fit&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;../animate&#34;&gt;Animated scatterplot&lt;/a&gt;
        &lt;a href=&#34;../animate&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_scatterplot.gif&#34; alt=&#34;animated scatterplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;../animate&#34;&gt;Animated scatterplot 2&lt;/a&gt;
        &lt;a href=&#34;../animate&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_scatterplot2.gif&#34; alt=&#34;animated scatterplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;../animate&#34;&gt;Animated scatterplot 3&lt;/a&gt;
        &lt;a href=&#34;../animate&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/animated_scatterplot3.gif&#34; alt=&#34;animated scatterplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h5 id=&#34;simple-scatterplot&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#simple-scatterplot&#34;&gt;Simple scatterplot&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a simple scatterplot visualising association between two numeric variables (e.g. HDI and GDP),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Correlation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Scatterplot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Scatterplot&lt;/strong&gt; panel, select &lt;em&gt;HDI&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt; and &lt;em&gt;GDP&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Scatterplot Setting&lt;/strong&gt; panel and uncheck &lt;strong&gt;Add a fitted line&lt;/strong&gt; (A line of best fit will be added to the plot by default).&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Label, Settings and Theme&lt;/strong&gt; panel
&lt;ul&gt;
&lt;li&gt;Click &lt;strong&gt;Switch to Advanced Mode&lt;/strong&gt; for customisable setting (e.g. font size, color schemes, etc).&lt;/li&gt;
&lt;li&gt;For Title, we used &amp;ldquo;Scatterplot of Gross domestic product and Human development index&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Horizontal axis, we used &amp;ldquo;Gross domestic product (GDP, 2018 US$)&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Vertical axis, we used &amp;ldquo;Human development index&amp;rdquo;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; GDP)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Gross domestic product and Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Gross domestic product (GDP, 2018 US$)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The variables for the vertial (y) and horizontal (x) are specified in the function &lt;code&gt;ggplot&lt;/code&gt;. For scatterplot, we use &lt;code&gt;geom_jitter&lt;/code&gt; instead of &lt;code&gt;geom_point&lt;/code&gt; to add a small amount of noise to each point so that the points will not be overlapping with each other.&lt;/p&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/simple_scatterplot.png&#34; alt=&#34;simple scatterplot&#34; title=&#34;simple scatterplot&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;bubble-plot&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#bubble-plot&#34;&gt;Bubble plot&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a bubble plot visualising the association between two numeric variables (e.g. HDI and GDP), with point size determined by a third continuous variable (e.g. Population size) and points color-coded by a categorical variable (e.g. continent)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Correlation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Scatterplot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Scatterplot&lt;/strong&gt; panel, select &lt;em&gt;HDI&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt;, &lt;em&gt;GDP&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;, &lt;em&gt;Continent&lt;/em&gt; to &lt;em&gt;Fill color&lt;/em&gt;, and &lt;em&gt;Pop&lt;/em&gt; to &lt;em&gt;Size&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Scatterplot Setting&lt;/strong&gt; panel and uncheck &lt;strong&gt;Add a fitted line&lt;/strong&gt; (A line of best fit will be added to the plot by default).&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Label, Settings and Theme&lt;/strong&gt; panel
&lt;ul&gt;
&lt;li&gt;Click &lt;strong&gt;Switch to Advanced Mode&lt;/strong&gt; for customisable setting (e.g. font size, color schemes, etc).&lt;/li&gt;
&lt;li&gt;For Title, we used &amp;ldquo;Scatterplot of Gross domestic product and Human development index&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Horizontal axis, we used &amp;ldquo;Gross domestic product (GDP, 2010 US$)&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Vertical axis, we used &amp;ldquo;Human development index&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Color fill label, we used &amp;ldquo;Continent&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Size label, we used &amp;ldquo;Population (millions)&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Since we have two legends, one for &lt;em&gt;Color&lt;/em&gt; and one for &lt;em&gt;Size&lt;/em&gt;, we set legend position to &amp;ldquo;Right&amp;rdquo;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-1&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Continent, Pop) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; GDP, size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Pop)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.5&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Continent), na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Gross domestic product and Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Gross domestic product (GDP, 2018 US$)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population (millions)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/bubble_plot1.png&#34; alt=&#34;bubble plot&#34; title=&#34;bubble plot&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;changing-legend-position&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#changing-legend-position&#34;&gt;Changing legend position&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Part of the legends is cut-off (bottom left) because we are running out of space. We can place the legend to the right hand size of the plot by changing the last line of codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;right&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/bubble_plot1b.png&#34; alt=&#34;bubble plot&#34; title=&#34;bubble plot&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;adjusting-bubble-size&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#adjusting-bubble-size&#34;&gt;Adjusting bubble size&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The size of the bubble can be changed by changing the following line&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The minimum point size is 0.1 and the maximum is 8. The following code changes the minimum to 0.3 and the maximum to 15.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;scale_size&lt;/span&gt;(range &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;0.3&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;15&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-updated-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-updated-r-codes&#34;&gt;Output from the updated R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/bubble_plot2.png&#34; alt=&#34;bubble plot&#34; title=&#34;bubble plot&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;scatterplot-with-line-of-best-fit&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#scatterplot-with-line-of-best-fit&#34;&gt;Scatterplot with line of best fit&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a scatterplot visualising the association between two numeric variables (e.g. HDI and Schooling) with points color-coded by a categorical variable (e.g. continent) and an overall line of best fit,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Correlation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Scatterplot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Scatterplot&lt;/strong&gt; panel, select &lt;em&gt;HDI&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt;, &lt;em&gt;Schooling&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;, and &lt;em&gt;Continent&lt;/em&gt; to &lt;em&gt;Fill color&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Scatterplot Setting&lt;/strong&gt; panel
&lt;ul&gt;
&lt;li&gt;check &lt;strong&gt;Add a fitted line&lt;/strong&gt; (A line of best fit will be added to the plot by default).&lt;/li&gt;
&lt;li&gt;check &lt;strong&gt;By fill color&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Label, Settings and Theme&lt;/strong&gt; panel
&lt;ul&gt;
&lt;li&gt;Click &lt;strong&gt;Switch to Advanced Mode&lt;/strong&gt; for customisable setting (e.g. font size, color schemes, etc).&lt;/li&gt;
&lt;li&gt;For Title, we used &amp;ldquo;Scatterplot of Years of schooling and Human development index&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Horizontal axis, we used &amp;ldquo;Years of schooling&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Vertical axis, we used &amp;ldquo;Human development index&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Color fill label, we used &amp;ldquo;Continent&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Size label, we used &amp;ldquo;Population (millions)&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Since we have two legends, one for &lt;em&gt;Color&lt;/em&gt; and one for &lt;em&gt;Size&lt;/em&gt;, we set legend position to &amp;ldquo;Right&amp;rdquo;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-2&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Continent) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Schooling)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Continent), na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_smooth&lt;/span&gt;(method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;lm&amp;#34;&lt;/span&gt;, se &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, show.legend &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Years of schooling and Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Years of schooling&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;In the above R codes, we have specified the vertial axis (y-axis) to be &lt;em&gt;HDI&lt;/em&gt; and horizontal to be &lt;em&gt;Schooling&lt;/em&gt; globally in the line&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Schooling))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;and then requested the points to be colored by &lt;em&gt;Continent&lt;/em&gt; in the &lt;code&gt;geom_jitter&lt;/code&gt; function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Continent), na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;To specify one line of best fit for each &lt;em&gt;Continent&lt;/em&gt;, we can specified the color globally as shown in the following example.&lt;/p&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-2&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/scatterplot_with_line.png&#34; alt=&#34;scatterplot with line of best fit&#34; title=&#34;scatterplot with line of best fit&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;scatterplot-with-line-of-best-fit-by-groups&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#scatterplot-with-line-of-best-fit-by-groups&#34;&gt;Scatterplot with line of best fit by groups&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a scatterplot visualising the association between two numeric variables (e.g. HDI and Schooling) with a line of best fit and points color-coded by a categorical variable (e.g. continent),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Correlation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Scatterplot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Scatterplot&lt;/strong&gt; panel, select &lt;em&gt;HDI&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt;, &lt;em&gt;Schooling&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;, and &lt;em&gt;Continent&lt;/em&gt; to &lt;em&gt;Fill color&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Scatterplot Setting&lt;/strong&gt; panel, check &lt;strong&gt;Add a fitted line&lt;/strong&gt; (A line of best fit will be added to the plot by default).&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Label, Settings and Theme&lt;/strong&gt; panel
&lt;ul&gt;
&lt;li&gt;Click &lt;strong&gt;Switch to Advanced Mode&lt;/strong&gt; for customisable setting (e.g. font size, color schemes, etc).&lt;/li&gt;
&lt;li&gt;For Title, we used &amp;ldquo;Scatterplot of Years of schooling and Human development index&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Horizontal axis, we used &amp;ldquo;Years of schooling&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Vertical axis, we used &amp;ldquo;Human development index&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Color fill label, we used &amp;ldquo;Continent&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;For Size label, we used &amp;ldquo;Population (millions)&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;Since we have two legends, one for &lt;em&gt;Color&lt;/em&gt; and one for &lt;em&gt;Size&lt;/em&gt;, we set legend position to &amp;ldquo;Right&amp;rdquo;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-3&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Continent) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Schooling, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Continent)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_smooth&lt;/span&gt;(method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;lm&amp;#34;&lt;/span&gt;, se &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, show.legend &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Years of schooling and Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Years of schooling&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population (millions)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;In this example, the color of the point is specified globally in the &lt;code&gt;ggplot&lt;/code&gt; function&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Schooling, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Continent))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;As a result, separate lines of best fit will be added for each &lt;em&gt;continent&lt;/em&gt;.&lt;/p&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-3&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/scatterplot_with_line_by_groups.png&#34; alt=&#34;scatterplot with lines of best fit by groups&#34; title=&#34;scatterplot with lines of best fit by groups&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;scatterplots-in-multiple-facets&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#scatterplots-in-multiple-facets&#34;&gt;Scatterplots in multiple facets&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The above plot of years of schooling and human development index is a bit busy. We can use the &lt;code&gt;facet&lt;/code&gt; to plot separate scatterplots by &lt;em&gt;continent&lt;/em&gt; by adding an extra line of codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Continent)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Below is the complete code for generating scatterplots by &lt;em&gt;continent&lt;/em&gt; in different facets.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Continent) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; HDI, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Schooling, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Continent)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_jitter&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_smooth&lt;/span&gt;(method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;lm&amp;#34;&lt;/span&gt;, se &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, show.legend &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ggtitle&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Scatterplot of Years of schooling and Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;xlab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Years of schooling&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;ylab&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Human development index&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Continent&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;labs&lt;/span&gt;(size &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Population (millions)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Continent)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;https://statsnotebook.io//blog/dataviz/img/scatterplot_with_line_by_groups_with_facets.png&#34; alt=&#34;scatterplot with lines of best fit by groups&#34; title=&#34;scatterplot with lines of best fit by groups&#34;/&gt;&lt;/a&gt;
</description>
    </item>
    
    <item>
      <title>Barchart</title>
      <link>https://statsnotebook.io/blog/dataviz/barchart/</link>
      <pubDate>Thu, 22 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/barchart/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Bar chart can be used to visualise the frequency or proportion of categorical variables. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses the &lt;code&gt;geom_bar()&lt;/code&gt; from &lt;code&gt;ggplot2&lt;/code&gt; to build bar chart.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;alcohol&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../../data_management/load_example_data&#34;&gt;here&lt;/a&gt;. This is a simulated data of alcohol consumption from 3666 individuals.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We will use the following three variables from this dataset&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;alcohol - Number of standard drinks consumed in a month&lt;/li&gt;
&lt;li&gt;Remoteness - Capital city or regional area&lt;/li&gt;
&lt;li&gt;State - Seven states/territories in Australia: Queensland, New South Wales, Northern Territory, South Australia, Tasmania, Victoria and Western Australia.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this example, we will build&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#simple-bar-chart&#34;&gt;Simple bar chart&lt;/a&gt;
        &lt;a href=&#34;#simple-bar-chart&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/simple_barchart.png&#34; alt=&#34;Simple barchart&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#stacked-bar-chart&#34;&gt;Stacked bar chart&lt;/a&gt;
        &lt;a href=&#34;#stacked-bar-chart&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/stacked_barchart.png&#34; alt=&#34;stacked barchart&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#grouped-bar-chart&#34;&gt;Grouped bar chart&lt;/a&gt;
        &lt;a href=&#34;#grouped-bar-chart&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/grouped_barchart.png&#34; alt=&#34;Grouped barchart&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#multiple-bar-charts&#34;&gt;Multiple bar charts&lt;/a&gt;
        &lt;a href=&#34;#multiple-bar-charts&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/multiple_barcharts.png&#34; alt=&#34;Multiple barcharts&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h5 id=&#34;simple-bar-chart&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#simple-bar-chart&#34;&gt;Simple bar chart&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a simple bar chart for a single categorical variable (e.g. &lt;em&gt;state&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Bar Chart&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the bar chart panel, select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_bar&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/simple_barchart.png&#34; alt=&#34;Simple bar chart&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;stacked-bar-chart&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#stacked-bar-chart&#34;&gt;Stacked bar chart&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a stacked bar chart for a single categorical variable (e.g. &lt;em&gt;State&lt;/em&gt;) by another categorical variable (e.g. &lt;em&gt;Year&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Bar Chart&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the bar chart panel, select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt; and select &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Split by: Fill color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State, Year) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_bar&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/stacked_barchart.png&#34; alt=&#34;Stacked bar chart&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;grouped-bar-chart&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#grouped-bar-chart&#34;&gt;Grouped bar chart&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a grouped bar chart for a single categorical variable (e.g. &lt;em&gt;State&lt;/em&gt;) by another categorical variable (e.g. &lt;em&gt;Year&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Bar Chart&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the bar chart panel, select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt; and select &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Split by: Fill color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expaned the &lt;strong&gt;Bar Chart Setting&lt;/strong&gt; panel, check &lt;strong&gt;Separate bars by &lt;em&gt;Year&lt;/em&gt;&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State, Year) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_bar&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;fill&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-2&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/grouped_barchart.png&#34; alt=&#34;grouped bar chart&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;multiple-bar-charts&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#multiple-bar-charts&#34;&gt;Multiple bar charts&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build multiple grouped bar charts for a single categorical variable (e.g. &lt;em&gt;State&lt;/em&gt;) by a categorical variable (e.g. &lt;em&gt;Year&lt;/em&gt;) in different facet by another categorical variable (e.g. &lt;em&gt;Remoteness&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Bar Chart&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the bar chart panel, select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Split by: Fill color&lt;/em&gt;, and &lt;em&gt;Remoteness&lt;/em&gt; to &lt;em&gt;Facet&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; and &lt;em&gt;Remoteness&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expaned the &lt;strong&gt;Bar Chart Setting&lt;/strong&gt; panel, check &lt;strong&gt;Fill Chart&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State, Year, Remoteness) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_bar&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;dodge&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Remoteness)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-3&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/multiple_barcharts.png&#34; alt=&#34;multiple bar charts&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Histogram</title>
      <link>https://statsnotebook.io/blog/dataviz/histogram/</link>
      <pubDate>Thu, 22 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/histogram/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Histogram can be used to show the distribution of &lt;strong&gt;numeric&lt;/strong&gt; variable. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses &lt;code&gt;geom_histogram()&lt;/code&gt; from &lt;code&gt;ggplot2&lt;/code&gt; to build density plot.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;alcohol&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../../data_management/load_example_data&#34;&gt;here&lt;/a&gt;. This is a simulated data of alcohol consumption from 3666 individuals.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We will use the following three variables from this dataset&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;alcohol - Number of standard drinks consumed in a month&lt;/li&gt;
&lt;li&gt;Remoteness - Capital city or regional area&lt;/li&gt;
&lt;li&gt;State - Seven states/territories in Australia: Queensland, New South Wales, Northern Territory, South Australia, Tasmania, Victoria and Western Australia.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this example, we will build&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#simple-histogram&#34;&gt;Simple histogram&lt;/a&gt;
        &lt;a href=&#34;#simple-histogram&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/simple_histogram.png&#34; alt=&#34;Simple histogram&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#histogram-by-groups&#34;&gt;Histogram by groups&lt;/a&gt;
        &lt;a href=&#34;#histogram-by-groups&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/histogram_by_group.png&#34; alt=&#34;Histogram by groups&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#multiple-histograms&#34;&gt;Multiple histograms&lt;/a&gt;
        &lt;a href=&#34;#multiple-histograms&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/multiple_histograms_by_facet.png&#34; alt=&#34;Multiple histograms by facets&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h5 id=&#34;simple-histogram&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#simple-histogram&#34;&gt;Simple histogram&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a simple histogram for a single numeric variable (e.g. alcohol),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Histogram&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the Histogram panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;, alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.60&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;identity&amp;#34;&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/simple_histogram.png&#34; alt=&#34;Simple histogram&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;histogram-by-groups&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#histogram-by-groups&#34;&gt;Histogram by groups&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a histogram for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;Remoteness&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Histogram&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the Histogram panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Horizontal axis&lt;/em&gt; and select &lt;em&gt;Remoteness&lt;/em&gt; to &lt;em&gt;Split by: Fill Color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Remoteness&lt;/em&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Remoteness) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;, alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.60&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;identity&amp;#34;&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/histogram_by_group.png&#34; alt=&#34;Histogram by group&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;multiple-histograms&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#multiple-histograms&#34;&gt;Multiple histograms&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build histograms for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;Remoteness&lt;/em&gt;) in multiple facets (by another variable, e.g. &lt;em&gt;State&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Histogram&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the histogram panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Horizontal axis&lt;/em&gt;, select &lt;em&gt;Remoteness&lt;/em&gt; to &lt;em&gt;Split by: Fill Color&lt;/em&gt; and &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Facet&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Remoteness&lt;/em&gt; and &lt;em&gt;State&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Remoteness, State) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;, alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.60&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;identity&amp;#34;&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-2&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/multiple_histograms_by_facet.png&#34; alt=&#34;Multiple histogram by facet&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;citation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citation&#34;&gt;Citation&lt;/a&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. [Computer Software]. Retrieved from https://www.statsnotebook.io
R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org
Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Density plot</title>
      <link>https://statsnotebook.io/blog/dataviz/density/</link>
      <pubDate>Wed, 21 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/density/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Density plot can be used to show the distribution of &lt;strong&gt;numeric&lt;/strong&gt; variables. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses &lt;code&gt;geom_density()&lt;/code&gt; from &lt;code&gt;ggplot2&lt;/code&gt; to build density plot.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;alcohol&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../../data_management/load_example_data&#34;&gt;here&lt;/a&gt;. This is a simulated data of alcohol consumption from 3666 individuals.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We will use the following three variables from this dataset&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;alcohol - Number of standard drinks consumed in a month&lt;/li&gt;
&lt;li&gt;Remoteness - Capital city or regional area&lt;/li&gt;
&lt;li&gt;State - Seven states/territories in Australia: Queensland, New South Wales, Northern Territory, South Australia, Tasmania, Victoria and Western Australia.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this example, we will build&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#simple-density-plot&#34;&gt;Simple density plot&lt;/a&gt;
        &lt;a href=&#34;#simple-density-plot&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/simple_density.png&#34; alt=&#34;Simple density plot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#density-plot-by-groups&#34;&gt;Density plot by groups&lt;/a&gt;
        &lt;a href=&#34;#density-plot-by-groups&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/density_by_group.png&#34; alt=&#34;Density plot by groups&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#multiple-density-plots&#34;&gt;Multiple density plots&lt;/a&gt;
        &lt;a href=&#34;#multiple-density-plots&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/multiple_density_by_facet.png&#34; alt=&#34;Multiple density plots by facets&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h5 id=&#34;simple-density-plot&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#simple-density-plot&#34;&gt;Simple density plot&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a simple density plot for a single numeric variable (e.g. alcohol),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Density&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the density panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Horizontal Axis&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_density&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.2&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/simple_density.png&#34; alt=&#34;Simple density plot&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;density-plot-by-groups&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#density-plot-by-groups&#34;&gt;Density plot by groups&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a density plot for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;Remoteness&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Density&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the density panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Horizontal axis&lt;/em&gt; and select &lt;em&gt;Remoteness&lt;/em&gt; to &lt;em&gt;Split by: Fill Color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Remoteness&lt;/em&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Remoteness) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_density&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.2&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/density_by_group.png&#34; alt=&#34;Density plot by group&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;multiple-density-plots&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#multiple-density-plots&#34;&gt;Multiple density plots&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build density plots for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;Remoteness&lt;/em&gt;) in multiple facets (by another variable, e.g. &lt;em&gt;State&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Density&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the density panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Horizontal axis&lt;/em&gt;, select &lt;em&gt;Remoteness&lt;/em&gt; to &lt;em&gt;Split by: Fill Color&lt;/em&gt; and &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Facet&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Remoteness&lt;/em&gt; and &lt;em&gt;State&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Remoteness, State) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_density&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.2&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-2&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/multiple_density_by_facet.png&#34; alt=&#34;Multiple density plots by facet&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;citation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citation&#34;&gt;Citation&lt;/a&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. [Computer Software]. Retrieved from https://www.statsnotebook.io
R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org
Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Linear mixed model (Multilevel model)</title>
      <link>https://statsnotebook.io/blog/analysis/linear_mixed_model/</link>
      <pubDate>Tue, 20 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/linear_mixed_model/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Data with multilevel (hierarchical) structure are common in many area of research. In our tutorial on &lt;a href=&#34;https://statsnotebook.io/blog/analysis/moderation_interaction_regression/&#34; title=&#34;moderation analysis&#34;&gt;moderation analysis&lt;/a&gt;, we examine the impact of increasing alcohol tax in Queensland on alcohol consumption. We compared changes in alcohol consumption for individuals from Queensland before and after the implementation of tax increase, compared to changes in alcohol consumption in other states. The data were collected from individuals from different postcodes in different states. Therefore, individual observations are &lt;em&gt;nested&lt;/em&gt; within postcodes. Since it is likely that individuals from the same postcodes are more similar compared to individuals from different postcodes (because of similar local drinking culture, similar level of exposure to local advertisement, etc), the assumption of independent observation is likely to be violated. &lt;strong&gt;Linear mixed model&lt;/strong&gt; (also known as multilevel model and random effect model) can be used to account for the dependencies in the data.&lt;/p&gt;

&lt;h4 id=&#34;examples-of-nested-data-structure&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#examples-of-nested-data-structure&#34;&gt;Examples of nested data structure&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Other examples of data with nested structure include&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Longitudinal data - Multiple measurements taken from the same individual are not independent&lt;/li&gt;
&lt;li&gt;School data - Students from the same school shared the same learning environment and school culture.&lt;/li&gt;
&lt;li&gt;Treatment data - Patients of the same doctor might have more similar outcome compared to patients of different doctors.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this tutorial, we will look at two examples&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://statsnotebook.io/blog/analysis/linear_mixed_model/#sleep-deprivation-and-reaction-time-repeated-measures-design&#34; title=&#34;Sleep deprivation and reactino time&#34;&gt;Sleep deprivation and reaction time&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;A study based on repeated measures of reaction time over 10 days of sleep deprivation (Belenky et al. 2003). Observations are nested within individuals, thus are not independent.&lt;/li&gt;
&lt;li&gt;We will first run a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/linear_mixed_model/#random-intercept-model&#34; title=&#34;random intercept model&#34;&gt;random intercept model&lt;/a&gt; that accounts for the repeated measures design (dependencies in the data), and then run a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/linear_mixed_model/#random-slope-model&#34; title=&#34;random slope model&#34;&gt;random slope model&lt;/a&gt; that allows the effect of sleep deprivation to vary across participants.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://statsnotebook.io/blog/analysis/linear_mixed_model/#alcohol-tax-and-alcohol-consumption&#34; title=&#34;Alcohol tax and alcohol consumption&#34;&gt;Alcohol tax and alcohol consumption&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;revisit our alcohol tax example in the &lt;a href=&#34;https://statsnotebook.io/blog/analysis/moderation_interaction_regression/#categorical-independent-variable-and-categorical-moderator&#34; title=&#34;moderation analysis&#34;&gt;moderation analysis&lt;/a&gt; tutorial. Individuals are nested within postcodes, thus the observations are not independent.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;sleep-deprivation-and-reaction-time-repeated-measures-design&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#sleep-deprivation-and-reaction-time-repeated-measures-design&#34;&gt;Sleep deprivation and reaction time (repeated measures design)&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Belenky et al (2003) studied the relationship between sleep deprivation and reaction time. We have included their data in &lt;strong&gt;StatsNotebook&lt;/strong&gt; as the &lt;strong&gt;Sleep&lt;/strong&gt; dataset. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;load example data&#34;&gt;load example data&lt;/a&gt; for instruction on loading the data into &lt;strong&gt;StatsNotebook&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;There are three variables in this dataset.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Reaction - Reaction time (ms)&lt;/li&gt;
&lt;li&gt;Days - Number of days of sleep deprivation. On day 0, the subjects had their normal amount of sleep. Starting that night they were restricted to 3 hours of sleep per night.&lt;/li&gt;
&lt;li&gt;Subject - Participant ID.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This dataset can also be loaded using the following codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;research-question&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#research-question&#34;&gt;Research question&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Does the number of days of sleep deprivation affect reaction time?&lt;/p&gt;
&lt;p&gt;It is tempting to address this research question by a simple linear regression (or a correlation analysis). However, linear regression is not appropriate because the data is not independent - Reaction time measured from the same participant are likely to be more similar to reaction time measures across participants.&lt;/p&gt;
&lt;p&gt;In this analysis, we will run two separate models - a random intercept model and a random slope model. Prior to running these models, it is always good practice to &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;DataViz&#34;&gt;visualise the data&lt;/a&gt; and conduct &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/&#34; title=&#34;descriptive statistics&#34;&gt;descriptive analysis&lt;/a&gt;.&lt;/p&gt;

&lt;h5 id=&#34;random-intercept-model&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#random-intercept-model&#34;&gt;Random intercept model&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;We can account for the dependencies in the data by including a &lt;strong&gt;random intercept&lt;/strong&gt; for each individual. To run this model,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear Regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;Reaction&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, &lt;em&gt;Days&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt; and &lt;em&gt;Subject&lt;/em&gt; into &lt;em&gt;Random effect&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;, the following R code will be generated in a block on the right panel, with output from R below the codes.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/random_intercept_reaction.png&#34; alt=&#34;random intercept model&#34; title=&#34;random intercept model&#34;/&gt;&lt;/a&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lmerTest)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lmer&lt;/span&gt;(Reaction &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Subject),
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)



res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;resid&lt;/span&gt;(res)&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;resid&lt;/span&gt;(res))
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .05 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
car&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
car&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;r-codes-explained---random-intercept-model&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---random-intercept-model&#34;&gt;R codes explained - Random intercept model&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following are from the top section of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lmerTest)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lmer&lt;/span&gt;(Reaction &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Subject),
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;These codes tell R to run a linear mixed model using the &lt;code&gt;lmer&lt;/code&gt; from the &lt;code&gt;lme4&lt;/code&gt; library. The left side of the &lt;strong&gt;&amp;ldquo;~&amp;rdquo;&lt;/strong&gt; symbol specifies the &lt;em&gt;dependent variable&lt;/em&gt;; the right side specifies &lt;em&gt;days&lt;/em&gt; as the independent variable. The code &lt;code&gt;(1 | Subject)&lt;/code&gt; specifies a random intercept for each participant. The &lt;code&gt;summary&lt;/code&gt; function is used to print out the results from the random intercept model and the &lt;code&gt;confint&lt;/code&gt; function is used to print the model coefficients with the corresponding 95% confidence intervals.&lt;/p&gt;
&lt;p&gt;The following is the model summary from the above codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Linear mixed model fit by REML. t&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;tests use Satterthwaite&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;s method [
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;lmerModLmerTest]
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Formula: Reaction ~ Days + (1 | Subject)
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;   Data: currentDataset
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;REML criterion at convergence: 1786.5
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Scaled residuals: 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;    Min      1Q  Median      3Q     Max 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;-3.2257 -0.5529  0.0109  0.5188  4.2506 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Random effects:
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Groups   Name        Variance Std.Dev.
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Subject  (Intercept) 1378.2   37.12   
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Residual              960.5   30.99   
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Number of obs: 180, groups:  Subject, 18
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Fixed effects:
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;            Estimate Std. Error       df t value Pr(&amp;gt;|t|)    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;(Intercept) 251.4051     9.7467  22.8102   25.79   &amp;lt;2e-16 ***
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Days         10.4673     0.8042 161.0000   13.02   &amp;lt;2e-16 ***
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;---
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Signif. codes:  0 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.001 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.01 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.05 &amp;#39;&lt;/span&gt;.&amp;#39; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;

Correlation of Fixed Effects&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
     (Intr)
Days &lt;span style=&#34;color:#40a070&#34;&gt;-0.371&lt;/span&gt;

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;######################################################&lt;/span&gt;
                 &lt;span style=&#34;color:#40a070&#34;&gt;2.5&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;%    97.5 %&lt;/span&gt;
.sig01              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sigma              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#06287e&#34;&gt;NA
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;&lt;/span&gt;(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;232.301892&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;270.50832&lt;/span&gt;
Days          &lt;span style=&#34;color:#40a070&#34;&gt;8.891041&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;12.04353&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;From the &lt;strong&gt;fixed effects&lt;/strong&gt; section of the model summary, we can conclude that there is strong evidence that number of days of sleep deprivation significantly increased reaction time under a significance level of 0.05. On average, for each additional day of sleep deprivation, the reaction time increased by 10.47ms (b = 10.47, SE = 0.80, p &amp;lt; .001).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Fixed effects:
            Estimate Std. Error       df t value Pr(&amp;gt;|t|)    
(Intercept) 251.4051     9.7467  22.8102   25.79   &amp;lt;2e-16 ***
Days         10.4673     0.8042 161.0000   13.02   &amp;lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;We are 95% confident that the average increase was between 8.89 and 12.04.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;                 &lt;span style=&#34;color:#40a070&#34;&gt;2.5&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;%    97.5 %&lt;/span&gt;
.sig01              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sigma              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#06287e&#34;&gt;NA
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;&lt;/span&gt;(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;232.301892&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;270.50832&lt;/span&gt;
Days          &lt;span style=&#34;color:#40a070&#34;&gt;8.891041&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;12.04353&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;In the above, we estimate that the average intercept across all participants is 251.4. Results from the &lt;strong&gt;random effects&lt;/strong&gt; section below show that the variance of the intercept for &lt;em&gt;Subject&lt;/em&gt; is 1378.2. Taking the square root, the standard deviation of the intercept is thus 37.1.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Random effects&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
 Groups   Name        Variance Std.Dev.
 &lt;span style=&#34;color:#06287e&#34;&gt;Subject  &lt;/span&gt;(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;1378.2&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;37.12&lt;/span&gt;   
 Residual              &lt;span style=&#34;color:#40a070&#34;&gt;960.5&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;30.99&lt;/span&gt;   
Number of obs&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;180&lt;/span&gt;, groups&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  Subject, &lt;span style=&#34;color:#40a070&#34;&gt;18&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;We can calculate the &lt;strong&gt;95% coverage interval&lt;/strong&gt; as &lt;strong&gt;251.4 ± 1.96*37.1&lt;/strong&gt;. The lower bound of the 95% coverage interval is thus 178.7 and the upper bound is 324.1. We therefore estimated that 95% of the participants have an intercept between 178.7 and 324.1. This means that 95% of the participants have a reaction time between 178.7 and 324.1 at Day 0. This is not to be confused with the &lt;strong&gt;95% confidence interval&lt;/strong&gt; of the intercept. The &lt;strong&gt;95% confidence interval&lt;/strong&gt; is (232.3, 270.5), and this indicates that we are 95% confident that the &lt;em&gt;average intercept&lt;/em&gt; is somewhere between 232.3 and 270.5.&lt;/p&gt;
&lt;p&gt;In this model, we have accounted for the repeated measures design (observations nested within individuals) by including a random intercept for each participants. Each individual has his/her own intercept. The effect of sleep deprivation on reaction time is assumed to be the same across individuals. This assumption can be relaxed by fitting a &lt;strong&gt;random slope model&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Before running the &lt;strong&gt;random slope model&lt;/strong&gt;, we can store the estimates from the &lt;strong&gt;random intercept model&lt;/strong&gt; into a variable for future model comparison. By default, &lt;strong&gt;StatsNotebook&lt;/strong&gt; stores the model estimates into the variable &lt;code&gt;res&lt;/code&gt;. We now store these estimates into the variable &lt;code&gt;m1&lt;/code&gt;. Enter the following code into a new block on the right panel and run it. This line of code must be run right after running the random intercept model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;m1 &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; res
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;random-slope-model&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#random-slope-model&#34;&gt;Random slope model&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;In the random intercept model, we assume that the effect of sleep deprivation on reaction time is the same across individuals. The following shows the scatterplot between reaction time and days of sleep deprivation for each participants.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/random_slope_reaction_individuals.png&#34; alt=&#34;random slope individuals&#34; title=&#34;random slope individuals&#34;/&gt;&lt;/a&gt;
&lt;p&gt;While for most of the participants, the association is positive (the line of best fit going up towards the top right corner of each plot), there is substantial variations - For some participants, the effect of sleep deprivation seems to be stronger (e.g. participant 308) others relatively weaker (e.g. participant 309). To account for these variations, we can run a random slope model allowing the effect of sleep deprivation to vary across participants.&lt;/p&gt;
&lt;p&gt;To run a random slope model,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear Regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;Reaction&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, &lt;em&gt;Days&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt; and &lt;em&gt;Subject&lt;/em&gt; into &lt;em&gt;Random effect&lt;/em&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The above three steps are the same as running a random intercept model. To specify a random slope for &lt;em&gt;Days&lt;/em&gt; for each &lt;em&gt;Subject&lt;/em&gt;,&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Random Effect&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Check &lt;em&gt;Days&lt;/em&gt; and select it into &lt;em&gt;Random slope&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;, the following R code will be generated in a block on the right panel, with output from R below the codes.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/random_slope.png&#34; alt=&#34;random slope&#34; title=&#34;random slope&#34;/&gt;&lt;/a&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lmerTest)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lmer&lt;/span&gt;(Reaction &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Subject),
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)



res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;resid&lt;/span&gt;(res)&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;resid&lt;/span&gt;(res))
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .05 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
car&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
car&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;r-codes-explained---random-slope-model&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---random-slope-model&#34;&gt;R codes explained - Random slope model&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The followings are from the top section of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lmerTest)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lmer&lt;/span&gt;(Reaction &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Subject),
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;These codes are very similar to those for the random intercept model, except that now we use the code &lt;code&gt;(1 + Days | Subject)&lt;/code&gt; to specify a random intercept for each &lt;em&gt;Subject&lt;/em&gt;, and a random slope of &lt;em&gt;Days&lt;/em&gt; for each &lt;em&gt;Subject&lt;/em&gt;. This allows both the intercept and the slope of days to vary across participants.&lt;/p&gt;
&lt;p&gt;The following is the model summary from the above codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Linear mixed model fit by REML. t&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;tests use Satterthwaite&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;s method [
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;lmerModLmerTest]
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Formula: Reaction ~ Days + (1 + Days | Subject)
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;   Data: currentDataset
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;REML criterion at convergence: 1743.6
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Scaled residuals: 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;    Min      1Q  Median      3Q     Max 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;-3.9536 -0.4634  0.0231  0.4634  5.1793 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Random effects:
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Groups   Name        Variance Std.Dev. Corr
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Subject  (Intercept) 612.10   24.741       
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;          Days         35.07    5.922   0.07
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Residual             654.94   25.592       
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Number of obs: 180, groups:  Subject, 18
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Fixed effects:
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;            Estimate Std. Error      df t value Pr(&amp;gt;|t|)    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;(Intercept)  251.405      6.825  17.000  36.838  &amp;lt; 2e-16 ***
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Days          10.467      1.546  17.000   6.771 3.26e-06 ***
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;---
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Signif. codes:  0 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.001 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.01 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.05 &amp;#39;&lt;/span&gt;.&amp;#39; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;

Correlation of Fixed Effects&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
     (Intr)
Days &lt;span style=&#34;color:#40a070&#34;&gt;-0.138&lt;/span&gt;

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;######################################################&lt;/span&gt;
                 &lt;span style=&#34;color:#40a070&#34;&gt;2.5&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;%    97.5 %&lt;/span&gt;
.sig01              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sig02              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sig03              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sigma              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#06287e&#34;&gt;NA
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;&lt;/span&gt;(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;238.029141&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;264.78107&lt;/span&gt;
Days          &lt;span style=&#34;color:#40a070&#34;&gt;7.437594&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;13.49698&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-1&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;From the &lt;strong&gt;fixed effects&lt;/strong&gt; section of the model summary, we can conclude that there is strong evidence that number of days of sleep deprivation significantly increased reaction time under a significance level of 0.05. On average, for each additional day of sleep deprivation, reaction time increased by 10.47ms (b = 10.47, SE = 1.55, p &amp;lt; .001).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Fixed effects:
            Estimate Std. Error      df t value Pr(&amp;gt;|t|)    
(Intercept)  251.405      6.825  17.000  36.838  &amp;lt; 2e-16 ***
Days          10.467      1.546  17.000   6.771 3.26e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;We are 95% confident that the average increase was between 7.44 and 13.50.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;                 &lt;span style=&#34;color:#40a070&#34;&gt;2.5&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;%    97.5 %&lt;/span&gt;
.sig01              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sig02              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sig03              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
.sigma              &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;        &lt;span style=&#34;color:#06287e&#34;&gt;NA
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;&lt;/span&gt;(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;238.029141&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;264.78107&lt;/span&gt;
Days          &lt;span style=&#34;color:#40a070&#34;&gt;7.437594&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;13.49698&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;From the &lt;strong&gt;fixed effects&lt;/strong&gt; section, we estimated the average intercept and average effect of days of sleep deprivation (slopes of &lt;em&gt;Days&lt;/em&gt;). We also estimated the corresponding 95% confidence intervals. Using the results from the &lt;strong&gt;random effects&lt;/strong&gt; section, we can calculate the coverage intervals for both the intercept and the slope.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Random effects&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
 Groups   Name        Variance Std.Dev. Corr
 &lt;span style=&#34;color:#06287e&#34;&gt;Subject  &lt;/span&gt;(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;612.10&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;24.741&lt;/span&gt;       
          Days         &lt;span style=&#34;color:#40a070&#34;&gt;35.07&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;5.922&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.07&lt;/span&gt;
 Residual             &lt;span style=&#34;color:#40a070&#34;&gt;654.94&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;25.592&lt;/span&gt;       
Number of obs&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;180&lt;/span&gt;, groups&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  Subject, &lt;span style=&#34;color:#40a070&#34;&gt;18&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The variance of the intercept and for the slope of &lt;em&gt;Days&lt;/em&gt; is 612.1 and 35.1 respectively. Taking their square root, the corresponding standard deviations are 24.7 and 5.9. The 95% coverage interval of the intercept is 251.4 ± 1.96*24.7. The lower bound is 203.0 and the upper bound is 299.8. It is therefore estimated that 95% of the participants had a reaction time between 203.0 and 299.8 at Day 0.&lt;/p&gt;
&lt;p&gt;The 95% coverage interval of the slope of &lt;em&gt;Days&lt;/em&gt; is 10.5 ± 1.96*5.9. The lower bound is -1.1 and the upper bound is 22.1. It is therefore estimated that for 95% of the participants, the effect of each additional day of sleep deprivation was between -1.1 and 22.1. This is not to be confused with the 95% confidence interval (7.4 and 13.5), which means that we are 95% confident that &lt;em&gt;average effect&lt;/em&gt; (across all participants) of each additional day of sleep deprivation on reaction time was between 7.4 and 13.5.&lt;/p&gt;

&lt;h5 id=&#34;random-intercept-or-random-slope-model&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#random-intercept-or-random-slope-model&#34;&gt;Random intercept or random slope model?&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;A random intercept model is more parsimonious. Random slope model is more flexible as it allows the effect of days of sleep deprivation to vary across participants. So which one should we use? We can test the model fit of these two models and select the one that fits the data better. After running the random intercept model, we stored the model estimates into &lt;code&gt;m1&lt;/code&gt;. We now store the model estimates from the random slope model into &lt;code&gt;m2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The following line of code must be run right after the random slope model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;m2 &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; res
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt; 
&lt;p&gt;We can now compare the model fit of the random intercept model (stored in &lt;code&gt;m1&lt;/code&gt;) and random slope model (stored in &lt;code&gt;m2&lt;/code&gt;) with a &lt;strong&gt;likelihood ratio test&lt;/strong&gt; using the following line of code.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;anova&lt;/span&gt;(m1, m2)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The above code produces the following results.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Data&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; currentDataset
Models&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
m1&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; Reaction &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Subject)
m2&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; Reaction &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Days &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Subject)
   npar    AIC    BIC  logLik deviance  Chisq Df &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;Chisq)    
m1    &lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1802.1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1814.8&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-897.04&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1794.1&lt;/span&gt;                         
m2    &lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1763.9&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1783.1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-875.97&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1751.9&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;42.139&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;7.072e-10&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
&lt;span style=&#34;color:#666&#34;&gt;---&lt;/span&gt;
Signif. codes&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;***&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;**&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Results from the likelihood ratio test shows that the random slope model fits the data significantly better than the random intercept model, χ&lt;sup&gt;2&lt;/sup&gt;(2) = 42.1, p &amp;lt; .001. This indicates that there is significant variation (between participants) in the effect of days of sleep deprivation on reaction time.&lt;/p&gt;

&lt;h5 id=&#34;example-write-up-apa-style&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#example-write-up-apa-style&#34;&gt;Example write-up (APA style)&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Table 1. Results from random slope model.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Fixed component&lt;/th&gt;
&lt;th&gt;b&lt;/th&gt;
&lt;th&gt;95% CI&lt;/th&gt;
&lt;th&gt;p&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Intercept&lt;/td&gt;
&lt;td&gt;251.41&lt;/td&gt;
&lt;td&gt;(238.03, 264.78)&lt;/td&gt;
&lt;td&gt;&amp;lt; .001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Days&lt;/td&gt;
&lt;td&gt;10.47&lt;/td&gt;
&lt;td&gt;(7.44, 13.50)&lt;/td&gt;
&lt;td&gt;&amp;lt; .001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Random component&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Variance&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Intercept&lt;/td&gt;
&lt;td&gt;612.10&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Days&lt;/td&gt;
&lt;td&gt;35.07&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Residual&lt;/td&gt;
&lt;td&gt;354.94&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;A random slope model is used to test if sleep deprivation affects reaction time. To account for the repeated measures design, a random intercept was specified for participants. The random slope for days of sleep deprivation was included in the model to allow the effect of sleep deprivation to vary across participants. Results are shown in Table 1. Using a significant level of 0.05, results indicate that sleep deprivation significantly increased reaction time. On average, each additional day of sleep deprivation increased reaction time by 10.47ms (&lt;em&gt;b&lt;/em&gt; = 10.47, 95% CI = [7.44, 13.50], &lt;em&gt;p&lt;/em&gt; &amp;lt; .001). Model fit comparison between model with and without random slope for sleep deprivation shows that the effect of sleep deprivation varied across participants, χ&lt;sup&gt;2&lt;/sup&gt;(2)= 42.14, &lt;em&gt;p&lt;/em&gt; &amp;lt; .001. The 95% coverage interval for the random slope of sleep deprivation is (-1.14, 22.07), indicating that the effect of sleep deprivation was between -1.14 and 22.07 for 95% of the participants.&lt;/p&gt;

&lt;h4 id=&#34;alcohol-tax-and-alcohol-consumption&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#alcohol-tax-and-alcohol-consumption&#34;&gt;Alcohol tax and alcohol consumption&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In our alcohol tax example in the &lt;a href=&#34;https://statsnotebook.io/blog/analysis/moderation_interaction_regression/#categorical-independent-variable-and-categorical-moderator&#34; title=&#34;moderation analysis&#34;&gt;moderation analysis&lt;/a&gt; tutorial, we investigated two research questions in the following scenario.&lt;/p&gt;
&lt;p&gt;Suppose that in Australia, Queensland implemented an increase in alcohol tax in 2018 and no change in tax in any other states (e.g. Victoria and New South Wales). We have collected data on alcohol consumption in 2017 and 2019, and we want to test if the change in alcohol consumption (measured in number of standard drinks consumed per month) in Queensland was different from other states.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A simple before/ after comparison using only Queensland data is not sufficient to test if the tax increase changed alcohol consumption because there is no comparision group. A before/ after difference can simply be due to a decreasing trend. We need to test if the change of alcohol consumption in Queensland is larger than other states.&lt;/li&gt;
&lt;li&gt;In this analysis, we will test the interaction between &lt;em&gt;year&lt;/em&gt; and &lt;em&gt;state&lt;/em&gt;. (Does &lt;em&gt;state&lt;/em&gt; change the effect of &lt;em&gt;year&lt;/em&gt; on alcohol consumption?)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We have used the built-in &lt;strong&gt;Alcohol&lt;/strong&gt; dataset in that example and the dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using the instructions provided &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;Load example data&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There are 5 variables in this dataset.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Alcohol - Number of standard drinks consumed per month.&lt;/li&gt;
&lt;li&gt;Year - 2017 (before tax increase in Queeland) and 2019 (after tax increase)&lt;/li&gt;
&lt;li&gt;Postcode - Postcode of participants&amp;rsquo; residence&lt;/li&gt;
&lt;li&gt;State - Seven states/territories in Australia, namely, Queensland, New South Wales, Northern Territory, South Australia, Tasmania, Victoria and Western Australia&lt;/li&gt;
&lt;li&gt;Remoteness - Capital city or regional area.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This data can also be loaded using the following codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In our original example, we have performed the moderation analysis using linear regression. However, it is likely that drinking culture differs between different local communities. Therefore, individuals from the same postcode might be more similar than individuals from different postcodes, and this would violate the assumption of independent observation.&lt;/p&gt;
&lt;p&gt;In this tutorial, we revisit this example and fit a random intercept model to account for the dependencies due to participants residing in the same postcode.&lt;/p&gt;
&lt;p&gt;To fit a random intercept model,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;alcohol&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, and select &lt;em&gt;Year&lt;/em&gt;, &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Remoteness&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;We have added &lt;em&gt;Remoteness&lt;/em&gt; into this analysis to adjust for its effect.&lt;/li&gt;
&lt;li&gt;We will need to code &lt;em&gt;Year&lt;/em&gt;, &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Remoteness&lt;/em&gt; into &lt;strong&gt;factor&lt;/strong&gt; because they are &lt;strong&gt;categorical&lt;/strong&gt; variables. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for a step-by-step guide.&lt;/li&gt;
&lt;li&gt;For this analysis, because we compared &lt;em&gt;Queensland&lt;/em&gt; against all other states, we set &lt;em&gt;QLD&lt;/em&gt; as the &lt;strong&gt;reference&lt;/strong&gt; level of &lt;em&gt;State&lt;/em&gt;. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/set_reference/&#34; title=&#34;set reference&#34;&gt;Setting reference level for categorical variable&lt;/a&gt; for step-by-step guide.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Select &lt;em&gt;Postcode&lt;/em&gt; into &lt;em&gt;Random Effect&lt;/em&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/random_slope_instruction1.png&#34; alt=&#34;random slope instruction&#34; title=&#34;random slope instruction&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Add interaction terms&lt;/strong&gt;, select &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; into &lt;em&gt;Interaction terms&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;The order of selected variables will determine the horizontal axis of the interaction plot (see interpretaion below). The first selected variable will always go to the horizontal axis. In this example, we click &lt;em&gt;State&lt;/em&gt; first followed by &lt;em&gt;Year&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/add_interaction_term.png&#34; alt=&#34;add interaction term&#34; title=&#34;add interaction term&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Estimated Marginal Means&lt;/strong&gt;, select &lt;em&gt;State*Year&lt;/em&gt; on the variable list, and select &lt;strong&gt;Pairwise comparison&lt;/strong&gt; and &lt;strong&gt;Interaction plot&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/moderation_emm.png&#34; alt=&#34;estimated marginal mean&#34; title=&#34;estimated marginal mean&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;, the following R code will be generated in a block on the right panel, with output from R below the codes.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lmerTest)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lmer&lt;/span&gt;(alcohol &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Year &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Postcode),
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)



res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;resid&lt;/span&gt;(res)&lt;span style=&#34;color:#666&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;resid&lt;/span&gt;(res))
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .05 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
car&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
car&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Variance inflation factor (VIF &amp;gt;=5 indicates high level of multicollinearity)&amp;#34;&lt;/span&gt;
car&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;vif&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

&lt;span style=&#34;color:#06287e&#34;&gt;eff_size&lt;/span&gt;(emm, sigma &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sigma&lt;/span&gt;(res), edf &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, Year &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;r-codes-explained---random-intercept-model-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---random-intercept-model-1&#34;&gt;R codes explained - Random intercept model&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following are from the top section of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lme4)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(lmerTest)

res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lmer&lt;/span&gt;(alcohol &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Year &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt; Postcode),
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wald&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;These codes tell R to run a linear mixed model using the &lt;code&gt;lmer&lt;/code&gt; from the &lt;code&gt;lme4&lt;/code&gt; library. The left side of the &lt;strong&gt;&amp;ldquo;~&amp;rdquo;&lt;/strong&gt; symbol specifies the &lt;em&gt;alcohol&lt;/em&gt; as the &lt;em&gt;dependent variable&lt;/em&gt;; the right side specifices &lt;em&gt;State&lt;/em&gt;, &lt;em&gt;Remoteness&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; and the interaction of &lt;em&gt;State and Year&lt;/em&gt; as the independent variable. The code &lt;code&gt;(1 | Postcode)&lt;/code&gt; specifies a random intercept for each &lt;em&gt;Postcode&lt;/em&gt;. The &lt;code&gt;summary&lt;/code&gt; function is used to print out the results from the random intercept model.&lt;/p&gt;
&lt;p&gt;The following is the model summary from the above codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Linear mixed model fit by REML. t&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;tests use Satterthwaite&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;s method [
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;lmerModLmerTest]
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Formula: alcohol ~ State + Remoteness + Year + State * Year + (1 | Postcode)
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;   Data: currentDataset
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;REML criterion at convergence: 38231.5
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Scaled residuals: 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;    Min      1Q  Median      3Q     Max 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;-1.9021 -0.7711 -0.1916  0.5797  4.2157 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Random effects:
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Groups   Name        Variance Std.Dev.
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Postcode (Intercept)   59.24   7.697  
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt; Residual             2001.97  44.743  
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Number of obs: 3666, groups:  Postcode, 35
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Fixed effects:
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;                   Estimate Std. Error       df t value Pr(&amp;gt;|t|)    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;(Intercept)          72.639      6.988   28.022  10.395 4.03e-11 ***
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateNSW              2.605      7.652   30.117   0.340  0.73593    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateNT               1.689      8.302   31.530   0.203  0.84011    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateSA              -6.905      7.950   30.890  -0.869  0.39179    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateTAS              2.193      8.889   33.801   0.247  0.80663    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateVIC             -9.671      7.967   26.721  -1.214  0.23540    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateWA             -10.466      8.785   41.141  -1.191  0.24036    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;RemotenessRegional  -10.373      4.502   23.524  -2.304  0.03036 *  
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Year2019            -21.028      5.060 3635.689  -4.156 3.32e-05 ***
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateNSW:Year2019    16.702      6.051 3650.901   2.760  0.00581 ** 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateNT:Year2019     14.589      6.894 3201.952   2.116  0.03440 *  
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateSA:Year2019     18.909      6.526 3649.459   2.898  0.00378 ** 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateTAS:Year2019     6.764      7.438 2549.967   0.909  0.36324    
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateVIC:Year2019    15.187      5.953 3634.067   2.551  0.01078 *  
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;StateWA:Year2019     22.251      7.019 3644.024   3.170  0.00154 ** 
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;---
&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;Signif. codes:  0 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.001 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.01 &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; 0.05 &amp;#39;&lt;/span&gt;.&amp;#39; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-2&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Using a significance level of 0.05, most of the interaction term between Year and States are significant. This indicates that changes in alcohol consumption in Queensland is different from the changes in other states. However, interpreting these coefficients is not straightforward.&lt;/p&gt;
&lt;p&gt;An easier way to interpret interactions is to calculate the &lt;strong&gt;Estimated Margainal Means (EMMs)&lt;/strong&gt;. We can estimate the mean alcohol consumption by &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; from our regression model.&lt;/p&gt;

&lt;h5 id=&#34;r-codes-explained--estimated-marginal-means&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained--estimated-marginal-means&#34;&gt;R codes explained = Estimated Marginal Means&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

&lt;span style=&#34;color:#06287e&#34;&gt;eff_size&lt;/span&gt;(emm, sigma &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sigma&lt;/span&gt;(res), edf &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;interpretation-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-3&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;These few lines of codes will produce a long list of output that can be broken down into three major section.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Estimated Marginal Means&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;emmeans
 State Year emmean   SE  df asymp.LCL asymp.UCL
 QLD   &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;67.5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;6.64&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;54.4&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;80.5&lt;/span&gt;
 NSW   &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;70.1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3.80&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;62.6&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;77.5&lt;/span&gt;
 NT    &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;69.1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.94&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;59.5&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;78.8&lt;/span&gt;
 SA    &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;60.5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.33&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;52.1&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;69.0&lt;/span&gt;
 TAS   &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;69.6&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;5.87&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;58.1&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;81.2&lt;/span&gt;
 VIC   &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;57.8&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.40&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;49.2&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;66.4&lt;/span&gt;
 WA    &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;57.0&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;5.71&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;45.8&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;68.2&lt;/span&gt;
 QLD   &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;46.4&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;6.45&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;33.8&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;59.1&lt;/span&gt;
 NSW   &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;65.7&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.07&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;57.8&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;73.7&lt;/span&gt;
 NT    &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;62.7&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;5.42&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;52.1&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;73.3&lt;/span&gt;
 SA    &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;58.4&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.88&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;48.9&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;68.0&lt;/span&gt;
 TAS   &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;55.4&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;5.92&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;43.8&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;67.0&lt;/span&gt;
 VIC   &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;51.9&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.60&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;42.9&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;61.0&lt;/span&gt;
 WA    &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;58.2&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.57&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;49.3&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;67.2&lt;/span&gt;

Results are averaged over the levels of&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; Remoteness 
Degrees&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;of&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;freedom method&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; asymptotic 
Confidence level used&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above table contains estimates for alcohol consumption by &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt;, with 95% confidence intervals. For example, it is estimated that on average, participants in Queensland in 2017 consumed 67.5 standard drinks per month, with a 95% confidence interval of (54.4, 80.5).&lt;/p&gt;
&lt;p&gt;It should be noted that the estimates from this random intercept model is very similar to those from a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/moderation_interaction_regression/#interpretation-1&#34; title=&#34;moderation analysis using linear regression&#34;&gt;moderation analysis using linear regression&lt;/a&gt;. However, the confidence intervals of the random intercept model is wider.&lt;/p&gt;
&lt;p&gt;This table is then followed by a long table of pairwise comparisons. However, we will not be interested in most of these comparisons.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pairwise comparison&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;contrasts
 contrast            estimate   SE  df z.ratio p.value
 QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NSW &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;-2.604&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;7.65&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.340&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.0000&lt;/span&gt; 
 QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NT &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;-1.689&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;8.30&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.203&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.0000&lt;/span&gt; 
 QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; SA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;6.905&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;7.95&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.869&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9999&lt;/span&gt; 
 .
 .
 .
  TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;3.441&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;7.55&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.456&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.0000&lt;/span&gt; 
 TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;-2.829&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;6.77&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.418&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.0000&lt;/span&gt; 
 VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;-6.270&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;6.54&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.958&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9996&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;We will only be interested in the 2017 and 2019 comparison in each state.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;contrast            estimate   SE  df z.ratio p.value
QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; QLD &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;21.028&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;5.06&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;4.156&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.0026&lt;/span&gt; 
NSW &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NSW &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;4.326&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3.32&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.302&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9907&lt;/span&gt; 
NT &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NT &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;6.439&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.68&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.375&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.9847&lt;/span&gt; 
SA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; SA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;2.119&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.12&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.514&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.0000&lt;/span&gt; 
TAS &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;14.264&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;5.45&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;2.616&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.3296&lt;/span&gt; 
VIC &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;5.841&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3.14&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.863&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.8467&lt;/span&gt; 
WA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;-1.223&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.86&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.251&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;1.0000&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
These results indicate that there is significant change in Queensland between 2017 and 2019 only. On average, consumption decreased by 21.03 standard drinks. The p-value is adjusted for a family of 14 estimates using Tukey&#39;s method. This adjustment is necessary to protect against increased rate of false positives due to multiple testing.  
&lt;p&gt;Lastly, the pairwise comparisons are accompanied by a table of effect sizes.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Effect size&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;contrast              effect.size     SE  df asymp.LCL &lt;span style=&#34;color:#06287e&#34;&gt;asymp.UCL
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;&lt;/span&gt;(QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NSW &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;)    &lt;span style=&#34;color:#40a070&#34;&gt;-0.05821&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1710&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.39339&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.27697&lt;/span&gt;
(QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NT &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;-0.03774&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1855&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.40140&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.32591&lt;/span&gt;
(QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; SA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;)      &lt;span style=&#34;color:#40a070&#34;&gt;0.15433&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1777&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.19393&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.50258&lt;/span&gt;
.
.
&lt;span style=&#34;color:#06287e&#34;&gt;.
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;&lt;/span&gt;(TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.07691&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1688&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.25391&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.40773&lt;/span&gt;
(TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;-0.06322&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1514&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.35988&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.23344&lt;/span&gt;
(VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;-0.14012&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1463&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.42681&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.14657&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Similarly, we will be only interested in the 2017 and 2019 comparison in each state.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;(QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; QLD &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.46998&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1131&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.24832&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.69164&lt;/span&gt;
(NSW &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NSW &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.09669&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0743&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.04891&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.24228&lt;/span&gt;
(NT &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NT &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)       &lt;span style=&#34;color:#40a070&#34;&gt;0.14391&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1046&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.06119&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.34900&lt;/span&gt;
(SA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; SA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)       &lt;span style=&#34;color:#40a070&#34;&gt;0.04736&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0921&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.13307&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.22779&lt;/span&gt;
(TAS &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.31880&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1218&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.07998&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.55762&lt;/span&gt;
(VIC &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.13055&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0701&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.00682&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.26793&lt;/span&gt;
(WA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)      &lt;span style=&#34;color:#40a070&#34;&gt;-0.02733&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1087&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;Inf&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.24039&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.18572&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;These effect sizes can be interpreted according to Cohen&amp;rsquo;s rule: 0.2 represents a small effect size, 0.5 represents a medium effect size and 0.8 represents a large effect size.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;emmeans&lt;/code&gt; package provides a handy function &lt;code&gt;emmip&lt;/code&gt; to visualise the interaction.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, Year &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/random_slope_model_interaction.png&#34; alt=&#34;random slope model interaction&#34; title=&#34;random slope model interaction&#34;/&gt;&lt;/a&gt;
</description>
    </item>
    
    <item>
      <title>Compute variables</title>
      <link>https://statsnotebook.io/blog/data_management/compute_variable/</link>
      <pubDate>Fri, 16 Oct 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/data_management/compute_variable/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;StatsNotebook&lt;/strong&gt; provides a simple menu for creating new variables. We will give two examples below to demonstrate using &lt;strong&gt;StatsNotebook&lt;/strong&gt; to compute new variables.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#log-transformation&#34; title=&#34;Log transformation&#34;&gt;Log transformation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quadratic-term&#34; title=&#34;Quadratic term&#34;&gt;Creating a quadratic term&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In these two examples, we will use the built-in &lt;strong&gt;Personality&lt;/strong&gt; dataset. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../load_example_data&#34;&gt;here&lt;/a&gt; or can be downloaded from &lt;a href=&#34;../example_data/personality.csv&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&#34;log-transformation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#log-transformation&#34;&gt;Log transformation&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Violation of distributional assumption is common. For example, linear regression requires that the residuals to be normally distribution. In our &lt;a href=&#34;../../analysis/regression&#34; title=&#34;Linear regression&#34;&gt;linear regression&lt;/a&gt; example, we regress &lt;em&gt;depression&lt;/em&gt; on the &lt;em&gt;Big Five&lt;/em&gt; personality factors and &lt;em&gt;sex&lt;/em&gt;. The normality plot (QQ plot) from the regression model indicates that the residuals are not normally distributed. Below is the normality plot from that example.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../../analysis/img/normality.png&#34; alt=&#34;Normality plot&#34; title=&#34;Normality plot&#34;&gt;&lt;/p&gt;
&lt;p&gt;This is largely because depression is positively skewed (a long tail on the right hand side).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../img/depression.png&#34; alt=&#34;Depression&#34; title=&#34;Depression&#34;&gt;&lt;/p&gt;
&lt;p&gt;One way to improve the model is to perform a log-transformation of the dependent variable, depression.&lt;/p&gt;
&lt;p&gt;To create a log-transformed version of depression,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Data&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Compute&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;In &lt;em&gt;Target Variable&lt;/em&gt;, type in the name of the new variable (e.g. &lt;em&gt;log_depression&lt;/em&gt;).&lt;/li&gt;
&lt;li&gt;Select &lt;em&gt;Log (natural log)&lt;/em&gt; in the &lt;em&gt;Function&lt;/em&gt; panel.&lt;/li&gt;
&lt;li&gt;Click on the variable we need to log-transform (e.g. &lt;em&gt;Depression&lt;/em&gt;). This would automatically complete the formula in the &lt;em&gt;formula&lt;/em&gt; panel.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/create_log_transformation.png&#34; alt=&#34;Log transformation&#34; title=&#34;Log transformation&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;. A new variable &lt;em&gt;log_depression&lt;/em&gt; is now created.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The following code will be generated.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;log_depression &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;log&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Depression)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Histogram of this new variable indicates that it is much less skewed.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../img/log_depression.png&#34; alt=&#34;Log transformed&#34; title=&#34;log transformed&#34;&gt;&lt;/p&gt;
&lt;p&gt;The residual plot from the linear regression using the log-transformed depression variable shows little evidence of violating the normality assumption.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../img/normality_log_depression.png&#34; alt=&#34;Normality&#34; title=&#34;normality&#34;&gt;&lt;/p&gt;

&lt;h4 id=&#34;quadratic-term&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#quadratic-term&#34;&gt;Quadratic term&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;A quadratic term of an independent variable is often added to a regression model to test for curvilinear relationship. Suppose that we want to test if there is a curvilinear relationship between &lt;em&gt;Depression&lt;/em&gt; and &lt;em&gt;Neuroticism&lt;/em&gt;, we can create a quadratic term of &lt;em&gt;Neruoticism&lt;/em&gt; and enter it into a linear regression model.&lt;/p&gt;
&lt;p&gt;To create a quadratic term,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Data&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Compute&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;In &lt;em&gt;Target Variable&lt;/em&gt;, type the name of the new variable (e.g. Neuroticism_sq)&lt;/li&gt;
&lt;li&gt;Select &lt;em&gt;Neuroticism&lt;/em&gt; from the &lt;em&gt;Variable&lt;/em&gt; panel. The term &lt;em&gt;currentDataset$Neuroticism&lt;/em&gt; will appear in the &lt;em&gt;Formula&lt;/em&gt; panel&lt;/li&gt;
&lt;li&gt;Type &lt;strong&gt;^2&lt;/strong&gt; at the end of the term&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/create_quadratic.png&#34; alt=&#34;Quadratic term&#34; title=&#34;Quadratic term&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;. A new variable &lt;em&gt;Neuroticism_sq&lt;/em&gt; will be created.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The following code will be generated.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Neuroticism_sq &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Neuroticism^2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Causal Mediation Analysis</title>
      <link>https://statsnotebook.io/blog/analysis/mediation/</link>
      <pubDate>Wed, 23 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/mediation/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Mediation analysis is a technique that examines the intermediate process by which the independent variable affects the dependent variable. For example, family intervention during adolescence (independent variable) can reduce engagement with deviant peer group (mediator) and their experimentation with drugs, which in turn reduces risk of substance use disorder in young adulthood (dependent variable).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;StatsNotebook&lt;/strong&gt; uses the cutting-edge counterfactual framework and Monte Carlo technique to conduct causal mediation analysis. It can handle&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;up to 3 mediators;&lt;/li&gt;
&lt;li&gt;numeric, dichotomized and count mediators and dependent variables;&lt;/li&gt;
&lt;li&gt;missing data using multiple imputation.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Since Monte Carlo method is very computationally intensive, it might take a long time to compute the mediation effect. Especially if there are missing data and multiple imputation is used.&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id=&#34;example-research-questions&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#example-research-questions&#34;&gt;Example research questions&lt;/a&gt;&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Does reduced engagement with deviant peer groups and reduced experimentation with drugs mediate the effect of the family intervention during adolescence on future substance use disorder?
&lt;ul&gt;
&lt;li&gt;In the example, we examine the causal chain &amp;ldquo;Participation in family intervention -&amp;gt; reduced engagement with deviant peer groups and experimentation with drugs -&amp;gt; substance use disorder in young adulthood&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;In other words, we expect that participation in family intervention during adolescence reduces engagement with deviant peer groups and experimentation with drugs, which in turns reduces the likelihood for substance use disorder in young adulthood.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this example, the &lt;em&gt;dependent variable&lt;/em&gt; is &lt;em&gt;substance use disorder&lt;/em&gt; and the &lt;em&gt;independent variable&lt;/em&gt; is &lt;em&gt;family intervention&lt;/em&gt;. There are two mediators: &lt;em&gt;engaged with deviant peer group&lt;/em&gt; and &lt;em&gt;experimentation with drugs&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;We will first show the R codes for this analysis below, and then we will provide a step-by-step guide on how to complete this analysis. We use the built-in &lt;strong&gt;substance&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using the instructions provided &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;load example&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this dataset,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;dev_peer&lt;/strong&gt; represents engagement with deviant peer groups and it was coded as &amp;ldquo;0: No&amp;rdquo; and &amp;ldquo;1: Yes&amp;rdquo;;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;sub_exp&lt;/strong&gt; represents experimentation with drugs and it was coded as &amp;ldquo;0: No&amp;rdquo; and &amp;ldquo;1: Yes&amp;rdquo;;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;fam_int&lt;/strong&gt; represents participation in family intervention during adolescence and it was coded as &amp;ldquo;0: No&amp;rdquo; and &amp;ldquo;1: Yes&amp;rdquo;;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;sub_disorder&lt;/strong&gt; represents diagnosis of substance use disorder in young adulthood and it was coded as &amp;ldquo;0: No: and &amp;ldquo;1: Yes&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;conflict&lt;/strong&gt; represents level of family conflict. It will be used as a covariate in this analysis.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/substance.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The first section of the code is for &lt;a href=&#34;https://statsnotebook.io/blog/analysis/multiple_imputation/&#34; title=&#34;Multiple imputation for missing data&#34;&gt;imputating missing data&lt;/a&gt;. In the second section, we use the &lt;code&gt;mediate&lt;/code&gt; function from the &lt;code&gt;intmed&lt;/code&gt; package to conduct a mediation analysis.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int_1[currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;
currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int_1[currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Multiple imputation&amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(mice)

formulas &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.formulas&lt;/span&gt;(currentDataset)

formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;gender &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;gender &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;conflict &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;conflict &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;sub_disorder &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;sub_disorder &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;dev_peer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;dev_peer &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;sub_exp &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;sub_exp &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int_1 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer

meth &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.method&lt;/span&gt;(currentDataset)


imputedDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;parlmice&lt;/span&gt;(currentDataset,
  method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; meth,
  formulas &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; formulas,
  m &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;,
  n.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, 
  n.imp.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(imputedDataset)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;complete&lt;/span&gt;(imputedDataset, action &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;long&amp;#34;&lt;/span&gt;, include &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Causal Mediation Analysis&amp;#34;&lt;/span&gt;

med_res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; intmed&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;mediate&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sub_disorder&amp;#34;&lt;/span&gt;,
  med &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;dev_peer&amp;#34;&lt;/span&gt; ,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sub_exp&amp;#34;&lt;/span&gt;),
  treat &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;fam_int_1&amp;#34;&lt;/span&gt;,
  c &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;gender&amp;#34;&lt;/span&gt; ,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;conflict&amp;#34;&lt;/span&gt;),
  ymodel &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;logistic regression&amp;#34;&lt;/span&gt;,
  mmodel &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;logistic regression&amp;#34;&lt;/span&gt; ,&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;logistic regression&amp;#34;&lt;/span&gt;),
  treat_lv &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;, control_lv &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt;, incint &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;, inc_mmint &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;,
  conf.level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;,
  data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset, sim &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1000&lt;/span&gt;, digits &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;,
  HTML_report &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;, complete_analysis &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;,
  imputed_data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;using-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Prior to running the causal mediation analysis, we will need to conduct a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/&#34; title=&#34;Descriptive statistics&#34;&gt;descriptive analysis&lt;/a&gt; and it is always a good practice to &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;dataviz&#34;&gt;visualise the data&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To run a causal mediation analysis,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Causal&lt;/strong&gt; and select &lt;strong&gt;Causal Mediation Analysis&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;sub_disorder&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, &lt;em&gt;fam_int&lt;/em&gt; into &lt;em&gt;Exposure&lt;/em&gt;, &lt;em&gt;dev_peer&lt;/em&gt; and &lt;em&gt;sub_exp&lt;/em&gt; into &lt;em&gt;Mediator(s)&lt;/em&gt;, and &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt; into covariates.
&lt;ul&gt;
&lt;li&gt;We add &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt; as covariates to adjust for their effects.&lt;/li&gt;
&lt;li&gt;All categorical variables will need to be coded as a &lt;strong&gt;factor&lt;/strong&gt; (such as &lt;em&gt;sub_disorder&lt;/em&gt;, &lt;em&gt;fam_int&lt;/em&gt;, &lt;em&gt;dev_peer&lt;/em&gt;, &lt;em&gt;sub_exp&lt;/em&gt; and &lt;em&gt;gender&lt;/em&gt;. In this example dataset, this has already been done). &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for step-by-step guide.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/causal_mediation.png&#34; alt=&#34;causal mediation analysis&#34; title=&#34;causal mediation analysis&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Analysis Setting&lt;/strong&gt;.
&lt;ul&gt;
&lt;li&gt;Select the models for the mediators and the dependent variable.
&lt;ul&gt;
&lt;li&gt;Linear regression for numeric variable&lt;/li&gt;
&lt;li&gt;Logistic regression for dichotomized variable&lt;/li&gt;
&lt;li&gt;Poisson regression for count variable&lt;/li&gt;
&lt;li&gt;In this example, since the mediators and the dependent variable are dichotomized, select &lt;strong&gt;Logistic regression (Dichotomized variable)&lt;/strong&gt; for &lt;em&gt;sub_disorder&lt;/em&gt;, &lt;em&gt;dev_peer&lt;/em&gt; and &lt;em&gt;sub_exp&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;1&lt;/strong&gt; as the treatment level and &lt;strong&gt;0&lt;/strong&gt; as the control level.
&lt;ul&gt;
&lt;li&gt;If the independent variable is a numeric variable, type 1 for treatment level and 0 for control level.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Select the &lt;strong&gt;100&lt;/strong&gt; as the number of simulations.
&lt;ul&gt;
&lt;li&gt;100 is good for an initial assessment of the mediation effect. For final analysis, use at least 1000 simulations.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Since there are missing data in this dataset, click &lt;strong&gt;Impute missing data&lt;/strong&gt;, and input &lt;strong&gt;20&lt;/strong&gt; as the number of imputations.
&lt;ul&gt;
&lt;li&gt;As a rule of thumb, the number of imputations should be around the percentage of missing data.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/mediation_setting.png&#34; alt=&#34;mediation analysis setting&#34; title=&#34;mediation analysis setting&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;interpretation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Below is the output from &lt;strong&gt;StatsNotebook&lt;/strong&gt;. The analysis is conducted using the &lt;code&gt;intmed&lt;/code&gt; package and most of the output is self-explanatory.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;There were &lt;span style=&#34;color:#40a070&#34;&gt;25.86&lt;/span&gt;% cases with missing data. Multiple imputation was used to impute missing &lt;span style=&#34;color:#06287e&#34;&gt;data &lt;/span&gt;(Rubin, &lt;span style=&#34;color:#40a070&#34;&gt;2009&lt;/span&gt;) and &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt; datasets were imputed using the R package &lt;span style=&#34;color:#06287e&#34;&gt;MICE &lt;/span&gt;(van Buuren, &lt;span style=&#34;color:#40a070&#34;&gt;2010&lt;/span&gt;).

The table below shows the estimates from the key regression models for the mediation analysis.

    variables     m1.b          m1.ci  m1.p    m2.b          m2.ci  m2.p
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; (Intercept)    &lt;span style=&#34;color:#40a070&#34;&gt;0.708&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.388&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.292&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.260&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.980&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.536&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.791&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.947&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;    conflict    &lt;span style=&#34;color:#40a070&#34;&gt;1.220&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.963&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.545&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.099&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.213&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.953&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.544&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.117&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;  genderMale    &lt;span style=&#34;color:#40a070&#34;&gt;1.234&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.861&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.771&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.252&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.156&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.804&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.661&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.434&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt;   fam_int_1 &lt;span style=&#34;color:#40a070&#34;&gt;0.517&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.358&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;0.747&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.539&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.369&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;0.788&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;   dev_peer1     &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;    &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt;    sub_exp1     &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;    &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;
       y.b           y.ci   y.p
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.061&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.019&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;0.200&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.820&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.531&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.267&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.371&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;1.396&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.779&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2.501&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.262&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.603&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.331&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.102&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.100&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.132&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1.891&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;9.031&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;1.745&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.739&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;4.123&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.203&lt;/span&gt;

Mediation analysis was performed based on the counter&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;factual framework and the interventional &lt;span style=&#34;color:#06287e&#34;&gt;effect &lt;/span&gt;(Vansteelandt and Daniel, &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;; Chan and Leung, &lt;span style=&#34;color:#40a070&#34;&gt;2020&lt;/span&gt;). The analysis was conducted in R using the intmed &lt;span style=&#34;color:#06287e&#34;&gt;package &lt;/span&gt;(Chan and Leung, &lt;span style=&#34;color:#40a070&#34;&gt;2020&lt;/span&gt;) with &lt;span style=&#34;color:#40a070&#34;&gt;1000&lt;/span&gt; simulations.

                                                 effect    est               ci
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;                    indirect effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.018&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.037&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;-0.004&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;                    indirect effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.007&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.021&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.004&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt; indirect effect through interaction between mediators  &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.002&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.005&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt;  indirect effect through dependence between mediators  &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.009&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.009&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;                                         direct effect &lt;span style=&#34;color:#40a070&#34;&gt;-0.055&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.120&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.010&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt;                                          total effect &lt;span style=&#34;color:#40a070&#34;&gt;-0.077&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.143&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;-0.016&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;7&lt;/span&gt;               proportion of effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.218&lt;/span&gt;                 
&lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;               proportion of effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.078&lt;/span&gt;                 
      p
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.005&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.202&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.448&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.975&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.099&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.011&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;7&lt;/span&gt;      
&lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;      

Reference
Rubin DB. Multiple imputation for nonresponse in surveys. New York&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; John Wiley &lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&lt;/span&gt; Sons; &lt;span style=&#34;color:#40a070&#34;&gt;2009&lt;/span&gt;.
Buuren Sv, Groothuis&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;Oudshoorn K. mice&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; Multivariate imputation by chained equations in R. Journal of statistical software. &lt;span style=&#34;color:#40a070&#34;&gt;2010&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;1-68&lt;/span&gt;.
Vansteelandt S, Daniel RM. Interventional effects for mediation analysis with multiple mediators. &lt;span style=&#34;color:#06287e&#34;&gt;Epidemiology &lt;/span&gt;(Cambridge, Mass). 2017; &lt;span style=&#34;color:#40a070&#34;&gt;28&lt;/span&gt;(&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#40a070&#34;&gt;258&lt;/span&gt;.
Chan G, Leung J. Causal mediation analysis using the interventional effect approach. A refined definition. Paper uner review. &lt;span style=&#34;color:#40a070&#34;&gt;2020&lt;/span&gt;.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;There are two key sections of the output: Results from regression models and Results from mediation analysis.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Results from regression models&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Behind the scene, three key regression models are run.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;dev_peer&lt;/em&gt; (mediator) is regressed on &lt;em&gt;fam_int&lt;/em&gt; (independent variable), &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt; in a logistic regression
&lt;ul&gt;
&lt;li&gt;This is to assess the effect of &lt;em&gt;fam_int&lt;/em&gt; on &lt;em&gt;dev_peer&lt;/em&gt;, adjusting for &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;em&gt;sub_exp&lt;/em&gt; (mediator) is regressed on &lt;em&gt;fam_int&lt;/em&gt; (independent variable), &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt; in a logsitic regression
&lt;ul&gt;
&lt;li&gt;This is to assess the effect of &lt;em&gt;fam_int&lt;/em&gt; on &lt;em&gt;dev_peer&lt;/em&gt;, adjusting for &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;em&gt;sub_disorder&lt;/em&gt; (dependent variable) is regressed on &lt;em&gt;dev_peer&lt;/em&gt; (mediator), &lt;em&gt;sub_exp&lt;/em&gt; (mediator), &lt;em&gt;fam_int&lt;/em&gt; (indenpendent variable), &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt; in a logistic regression.
&lt;ul&gt;
&lt;li&gt;This is to assess the effect of &lt;em&gt;dev_peer&lt;/em&gt;, &lt;em&gt;sub_exp&lt;/em&gt; and &lt;em&gt;fam_int&lt;/em&gt; on &lt;em&gt;sub_disorder&lt;/em&gt;, adjusting for &lt;em&gt;gender&lt;/em&gt; and &lt;em&gt;conflict&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The table below from the &lt;strong&gt;StatsNotebook&lt;/strong&gt; summarises the odds ratio, 95% confidence intervals and p-value from these three models. With a significance level of 0.05, the results indicate that participation in family intervention reduces the odds of engagement with deviant peers, OR = 0.517, 95% CI (0.358, 0.747) and experimentation with drugs, OR = 0.539, 95% CI (0.369, 0.788). Family intervention may reduce odds of substance use disorder directly, OR = 0.603, 95% CI (0.331, 1.102), but this effect is not statistically significant. Engagement with deviant peers increased the odds of substance use disorder, OR = 4.132, 95% CI (1.891, 9.031). Experimentation with drugs may increase the odds of substance use disorder, OR = 1.745, 95% CI (0.739, 4.123), but this effect is not statistically significant.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;The table below shows the estimates from the key regression models for the mediation analysis.

    variables     m1.b          m1.ci  m1.p    m2.b          m2.ci  m2.p
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; (Intercept)    &lt;span style=&#34;color:#40a070&#34;&gt;0.708&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.388&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.292&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.260&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.980&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.536&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.791&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.947&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;    conflict    &lt;span style=&#34;color:#40a070&#34;&gt;1.220&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.963&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.545&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.099&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.213&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.953&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.544&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.117&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;  genderMale    &lt;span style=&#34;color:#40a070&#34;&gt;1.234&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.861&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.771&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.252&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.156&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.804&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.661&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.434&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt;   fam_int_1 &lt;span style=&#34;color:#40a070&#34;&gt;0.517&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.358&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;0.747&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.539&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.369&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;0.788&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;   dev_peer1     &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;    &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt;    sub_exp1     &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;    &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;
       y.b           y.ci   y.p
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.061&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.019&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;0.200&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.820&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.531&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.267&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.371&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;1.396&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.779&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;2.501&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.262&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.603&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.331&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;1.102&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.100&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;4.132&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;1.891&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;9.031&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;1.745&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;0.739&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;4.123&lt;/span&gt;) &lt;span style=&#34;color:#40a070&#34;&gt;0.203&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;&lt;strong&gt;Results from mediation analysis&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The second table shows the results from mediation analysis.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Mediation analysis was performed based on the counter&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;factual framework and the interventional &lt;span style=&#34;color:#06287e&#34;&gt;effect &lt;/span&gt;(Vansteelandt and Daniel, &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;; Chan and Leung, &lt;span style=&#34;color:#40a070&#34;&gt;2020&lt;/span&gt;). The analysis was conducted in R using the intmed &lt;span style=&#34;color:#06287e&#34;&gt;package &lt;/span&gt;(Chan and Leung, &lt;span style=&#34;color:#40a070&#34;&gt;2020&lt;/span&gt;) with &lt;span style=&#34;color:#40a070&#34;&gt;1000&lt;/span&gt; simulations.

                                                 effect    est               ci
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;                    indirect effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.018&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.037&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;-0.004&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;                    indirect effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.007&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.021&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.004&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt; indirect effect through interaction between mediators  &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.002&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.005&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt;  indirect effect through dependence between mediators  &lt;span style=&#34;color:#40a070&#34;&gt;0.000&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.009&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.009&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt;                                         direct effect &lt;span style=&#34;color:#40a070&#34;&gt;-0.055&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.120&lt;/span&gt;,  &lt;span style=&#34;color:#40a070&#34;&gt;0.010&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt;                                          total effect &lt;span style=&#34;color:#40a070&#34;&gt;-0.077&lt;/span&gt; (&lt;span style=&#34;color:#40a070&#34;&gt;-0.143&lt;/span&gt;, &lt;span style=&#34;color:#40a070&#34;&gt;-0.016&lt;/span&gt;)
&lt;span style=&#34;color:#40a070&#34;&gt;7&lt;/span&gt;               proportion of effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.218&lt;/span&gt;                 
&lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;               proportion of effect through mediator &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.078&lt;/span&gt;                 
      p
&lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.005&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.202&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.448&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.975&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.099&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.011&lt;/span&gt;
&lt;span style=&#34;color:#40a070&#34;&gt;7&lt;/span&gt;      
&lt;span style=&#34;color:#40a070&#34;&gt;8&lt;/span&gt;      

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Since &lt;em&gt;sub_disorder&lt;/em&gt; is a dichotomised variable, the estimates are in a &lt;strong&gt;probability scale&lt;/strong&gt;. Overall, the total effect of &lt;em&gt;fam_int&lt;/em&gt; is -0.077, indicating that participation in family intervention reduces the probability of &lt;em&gt;sub_disorder&lt;/em&gt; by 0.077 (i.e. 7.7%). Of this total effect, 0.018 (est = -0.018, 95% CI [-0.037, -0.004]) is significantly mediated through &lt;em&gt;dev_peer&lt;/em&gt; and 0.007 (est = -0.007, 95% CI [-0.021, 0.004]) is mediated through &lt;em&gt;sub_exp&lt;/em&gt;. Overall, it is estimated that 21.8% of the total effect is mediated through &lt;em&gt;dev_peer&lt;/em&gt; and 7.8% through &lt;em&gt;sub_exp&lt;/em&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Multiple Imputation</title>
      <link>https://statsnotebook.io/blog/analysis/multiple_imputation/</link>
      <pubDate>Wed, 23 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/multiple_imputation/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Missing data is a norm rather than an exception in most areas of research. Excluding observations with missing data reduces statistical power and potentially introduces bias in model estimates. Multiple imputation is a technique that fills in missing values based on the available data. It can increase statistical power and reduce the bias due to missing data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;StatsNotebook&lt;/strong&gt; provides a simple interface for multiple imputation using the &lt;code&gt;mice&lt;/code&gt; package. By default, numeric variables are imputed using predictive mean matching and categorical variables are imputed using multinomial logistic regression (for categorical variables with 3 or more level) or binary logistic regression (for categorical variables with 2 levels).&lt;/p&gt;
&lt;p&gt;In this tutorial, we will use the built-in &lt;strong&gt;substance&lt;/strong&gt; dataset. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using the instructions &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;Load example data&#34;&gt;here&lt;/a&gt;. It is a simulated dataset on the effects of a family intervention during adolescence on engagement with deviant peer group, experimentation with drugs and risk of substance use disorder in young adulthood. See &lt;a href=&#34;https://statsnotebook.io/blog/analysis/mediation/&#34; title=&#34;Causal mediation analysis&#34;&gt;Causal Mediation Analysis&lt;/a&gt; for an example based on this dataset.&lt;/p&gt;
&lt;p&gt;In this dataset,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;dev_peer&lt;/strong&gt; represents engagement with deviant peer groups and it was coded as &amp;ldquo;0: No&amp;rdquo; and &amp;ldquo;1: Yes&amp;rdquo;;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;sub_exp&lt;/strong&gt; represents experimentation with drugs and it was coded as &amp;ldquo;0: No&amp;rdquo; and &amp;ldquo;1: Yes&amp;rdquo;;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;fam_int&lt;/strong&gt; represents participation in family intervention during adolescence and it was coded as &amp;ldquo;0: No&amp;rdquo; and &amp;ldquo;1: Yes&amp;rdquo;;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;sub_disorder&lt;/strong&gt; represents diagnosis of substance use disorder in young adulthood and it was coded as &amp;ldquo;0: No: and &amp;ldquo;1: Yes&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;conflict&lt;/strong&gt; represents level of family conflict. It will be used as a covariate in this analysis.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/personality.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Two variables, &lt;strong&gt;.imp&lt;/strong&gt; and &lt;strong&gt;.id&lt;/strong&gt; will be added to the dataset on successful imputation. The &lt;strong&gt;.imp&lt;/strong&gt; is the imputation number, and zero indicates the original dataset. The &lt;strong&gt;.id&lt;/strong&gt; is a unique identifier for each observation in the dataset.&lt;/p&gt;

&lt;h5 id=&#34;using-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Prior to imputing missing data, all categorical variables will need to be specified as &lt;strong&gt;categorical&lt;/strong&gt; (i.e. &lt;strong&gt;factor&lt;/strong&gt; variable in R). See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for a step-by-step guide.&lt;/p&gt;
&lt;p&gt;To impute missing data,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Imputation&lt;/strong&gt; and select &lt;strong&gt;Multiple imputation&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select all variables that we want to include in our imputation. Variables with no missing data can also be included as information from these variables will be used to impute missing data in other variables.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/imputation.png&#34; alt=&#34;Multiple imputation in StatsNotebook&#34; title=&#34;Multiple imputation in StatsNotebook&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Passive imputation&lt;/strong&gt; if we need to include interaction terms in the imputation. In this example, we do not include any interaction.&lt;/li&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Analysis Setting&lt;/strong&gt; to specify the number of imputations.
&lt;ul&gt;
&lt;li&gt;As a rule of thumb, the number of imputations should be roughly similar to the percentage of missing data in the dataset.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/imputation_setting.png&#34; alt=&#34;Imputation setting&#34; title=&#34;Imputation setting&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;interpretaion&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretaion&#34;&gt;Interpretaion&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The only output from &lt;strong&gt;StatsNotebook&lt;/strong&gt; is a set of diagnostic plots from the imputation model. The lines in all plots should be freely intermingled. Non-convergence will be indicated by clearly separated lines.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/imputation_output.png&#34; alt=&#34;imputation output&#34; title=&#34;imputation output&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;r-codes-explained&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained&#34;&gt;R codes explained&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following is the code generated by &lt;strong&gt;StatsNotebook&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(mice)

formulas &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.formulas&lt;/span&gt;(currentDataset)

formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;gender &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;gender &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;conflict &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;conflict &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;dev_peer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;dev_peer &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;sub_exp &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;sub_exp &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;fam_int &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;sub_disorder &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;sub_disorder &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int

meth &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.method&lt;/span&gt;(currentDataset)


imputedDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;parlmice&lt;/span&gt;(currentDataset,
  method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; meth,
  formulas &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; formulas,
  m &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;,
  n.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;15&lt;/span&gt;, 
  n.imp.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(imputedDataset)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;complete&lt;/span&gt;(imputedDataset, action &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;long&amp;#34;&lt;/span&gt;, include &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;) 
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Buuren, S. v. and K. Groothuis-Oudshoorn (2010). mice: Multivariate imputation by chained equations in R. Journal of Statistical Software: 1-68.&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The top section specifies how each variable is imputed. &lt;strong&gt;StatsNotebook&lt;/strong&gt; will use all selected variables for imputation.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;formulas &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.formulas&lt;/span&gt;(currentDataset)

formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;gender &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;gender &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;conflict &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;conflict &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;dev_peer &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;dev_peer &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;sub_exp &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;sub_exp &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;fam_int &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;fam_int &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_disorder
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;sub_disorder &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;sub_disorder &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; gender &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; conflict &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; dev_peer &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; sub_exp &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; fam_int
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt; 
&lt;p&gt;After specifying what variables would be used to impute each of the variables, we use the following line of code to specify the imputation methods. By default, predictive mean matching will be used for numeric variables, binary logistic regression will be used for dichotomized variable and multinomial logistic regression will be used for categorical variables with two or more levels.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;meth &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.method&lt;/span&gt;(currentDataset)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;After the setup, the function &lt;code&gt;parlmice&lt;/code&gt; will be used to impute missing data.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;imputedDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;parlmice&lt;/span&gt;(currentDataset,
  method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; meth,
  formulas &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; formulas,
  m &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;20&lt;/span&gt;,
  n.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;15&lt;/span&gt;, 
  n.imp.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;citations&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citations&#34;&gt;Citations&lt;/a&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io
R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org
Buuren, S. v. and K. Groothuis-Oudshoorn (2010). mice: Multivariate imputation by chained equations in R. Journal of Statistical Software: 1-68.
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Moderation (Interaction) analysis using linear regression</title>
      <link>https://statsnotebook.io/blog/analysis/moderation_interaction_regression/</link>
      <pubDate>Tue, 22 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/moderation_interaction_regression/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Assumed knowledge in this tutorial:&lt;/strong&gt; &lt;a href=&#34;https://statsnotebook.io/blog/analysis/regression/&#34; title=&#34;Linear regression&#34;&gt;Linear regression&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Moderation analysis is used to examine if the effect of an independent variable on the dependent variable is the same across different levels of another independent variable (moderator). In other words, it is used to examine whether the moderator will change the strength of the relationship between the independent and dependent variables.&lt;/p&gt;

&lt;h4 id=&#34;example-research-questions&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#example-research-questions&#34;&gt;Example research questions&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Is the effect of psychotherapy (independent variable) on depression (dependent variable) stronger for females than for males (moderator: sex)?
&lt;ul&gt;
&lt;li&gt;In this example, we want to see if the effect of psychotherapy on depression is the same across sex (i.e. same for both female and male)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Does the implementation of an alcohol tax in one state change alcohol consumption, compared to other states without changes in tax?
&lt;ul&gt;
&lt;li&gt;This is a less obvious example. Here, we want to test if the change over time (effect of time before and after a new tax rule) was the same across states. Do states (moderator) change the effect of time (independent variable) on alcohol consumption (dependent variable)?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this tutorial, we will examine three scenarios.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://statsnotebook.io/blog/analysis/moderation_interaction_regression/#categorical-independent-variable-and-categorical-moderator&#34; title=&#34;categorical independent variable and categorical moderator&#34;&gt;Categorical independent variable and categorical moderator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://statsnotebook.io/blog/analysis/moderation_interaction_regression/#numeric-independent-variable-and-categorical-moderator&#34; title=&#34;numeric independent variable and categorical moderator&#34;&gt;Numeric independent variable and categorical moderator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://statsnotebook.io/blog/analysis/moderation_interaction_regression/#numeric-independent-variable-and-numeric-moderator&#34; title=&#34;numeric independent variable and numeric moderator&#34;&gt;Numeric independent variable and numeric moderator&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For instances with a categorical independent variable and numeric moderator, the analytic strategy would be the same as conducting a moderation analysis with a numeric independent variable with categorical moderator.&lt;/p&gt;

&lt;h4 id=&#34;categorical-independent-variable-and-categorical-moderator&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#categorical-independent-variable-and-categorical-moderator&#34;&gt;Categorical independent variable and categorical moderator&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Suppose that in Australia, Queensland implemented an increase in alcohol tax in 2018 and there was no change in tax in any other states (e.g. Victoria, New South Wales). We have collected data on alcohol consumption in 2017 and 2019, and want to test if the change in alcohol consumption (measured in number of standard drinks consumed per month) in Queensland was different from other states.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A simple before/ after comparison using only Queensland data is not sufficient to test if the tax increase changed alcohol consumption because there is no comparision group. A before/ after difference can simply be due to a decreasing trend. We need to test if the change in Queensland is larger than other states.&lt;/li&gt;
&lt;li&gt;In this analysis, we will test the interaction between &lt;em&gt;year&lt;/em&gt; and &lt;em&gt;state&lt;/em&gt;. (Does &lt;em&gt;state&lt;/em&gt; change the effect of &lt;em&gt;year&lt;/em&gt; on alcohol consumption?)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We will first show the R codes for this analysis below, and we will provide a step-by-step guide on how to complete this analysis. We use the built-in &lt;strong&gt;Alcohol&lt;/strong&gt; dataset for this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using the instructions provided &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;load example data&#34;&gt;here&lt;/a&gt;. We will also use the &lt;code&gt;emmeans&lt;/code&gt; package in R for pairwise comparisons and for building the interaction plot.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(alcohol &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Year &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(car)

res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rstandard&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .01 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Residual plots, curvature tests and normality plot&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;residualPlots&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Variance inflation factor (VIF &amp;gt;=5 indicates high level of multicollinearity)&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;vif&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

&lt;span style=&#34;color:#06287e&#34;&gt;eff_size&lt;/span&gt;(emm, sigma &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sigma&lt;/span&gt;(res), edf &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;df.residual)

&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, Year &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;using-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Prior to running the moderation analysis, we will need to conduct a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/&#34; title=&#34;descriptive statistics&#34;&gt;descriptive analysis&lt;/a&gt; and it is always good practice to &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;DataViz&#34;&gt;visualise the data&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To run a moderation analysis using linear regression (categorical independent variable and categorical moderator),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In the left panel, select &lt;em&gt;alcohol&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, and select &lt;em&gt;Year&lt;/em&gt;, &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Remoteness&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We have added &lt;em&gt;Remoteness&lt;/em&gt; into this analysis to adjust for its effect.&lt;/li&gt;
&lt;li&gt;We will need to code &lt;em&gt;Year&lt;/em&gt;, &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Remoteness&lt;/em&gt; into &lt;strong&gt;factor&lt;/strong&gt; because they are &lt;strong&gt;categorical&lt;/strong&gt; variables. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for step-by-step guide.&lt;/li&gt;
&lt;li&gt;For this analysis, because we compared &lt;em&gt;Queensland&lt;/em&gt; against all other states, we set &lt;em&gt;QLD&lt;/em&gt; as the &lt;strong&gt;reference&lt;/strong&gt; level of &lt;em&gt;state&lt;/em&gt;. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/set_reference/&#34; title=&#34;set reference&#34;&gt;Setting reference level for categorical variable&lt;/a&gt; for step-by-step guide.&lt;/li&gt;
&lt;/ul&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/moderation_instruction1.png&#34; alt=&#34;Moderation (interaction) analysis&#34; title=&#34;Moderation (interaction) analysis&#34;/&gt;&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Expand the panel &lt;strong&gt;Add interaction terms&lt;/strong&gt;, select &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; into &lt;em&gt;Interaction terms&lt;/em&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The order of selecting variables will determine the horizontal axis of the interaction plot (see interpretaion below). The first selected variable will always go to the horizontal axis. In this example, we click &lt;em&gt;State&lt;/em&gt; first and then &lt;em&gt;Year&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/add_interaction_term.png&#34; alt=&#34;add interaction term&#34; title=&#34;add interaction term&#34;/&gt;&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Expand the panel &lt;strong&gt;Estimated Marginal Means&lt;/strong&gt;, select &lt;em&gt;State*Year&lt;/em&gt; on the variable list, and select &lt;strong&gt;Pairwise comparison&lt;/strong&gt; and &lt;strong&gt;Interaction plot&lt;/strong&gt;.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/moderation_emm.png&#34; alt=&#34;estimated marginal means for interaction&#34; title=&#34;estimated marginal means for interaction&#34;/&gt;&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;** For this analysis, we should also adjust for &lt;em&gt;Postcode&lt;/em&gt; because participants from the same postcode may be more similar compared to participants from other postcodes, thus violating the &lt;strong&gt;assumption of independent observation&lt;/strong&gt;. For the purpose of understanding a moderation analysis, we can leave this out for now. See &lt;a href=&#34;https://statsnotebook.io/blog/analysis/linear_mixed_model/&#34; title=&#34;Linear mixed model (Multilevel model)&#34;&gt;Linear mixed model (Multilevel model)&lt;/a&gt; for how to adjust for data dependency.&lt;/p&gt;

&lt;h5 id=&#34;r-codes-explained---moderation-analysis&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---moderation-analysis&#34;&gt;R codes explained - Moderation analysis&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following are from the top section of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(alcohol &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Year &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;This code tells R to run a linear regression using the &lt;strong&gt;lm&lt;/strong&gt; function. The left side of the &lt;strong&gt;&amp;ldquo;~&amp;rdquo;&lt;/strong&gt; symbol specifies the &lt;em&gt;dependent variable&lt;/em&gt;; the right side specifies the &lt;em&gt;independent variables&lt;/em&gt;. &lt;strong&gt;StatsNotebook&lt;/strong&gt; has added the interaction term &lt;strong&gt;State*Year&lt;/strong&gt; as an extra term. The results from this regression analysis are then printed out using the &lt;strong&gt;summary&lt;/strong&gt; function. Finally, the &lt;strong&gt;cbind&lt;/strong&gt;, &lt;strong&gt;coef&lt;/strong&gt; and &lt;strong&gt;confint&lt;/strong&gt; functions are used to print the model coefficients with the corresponding 95% confidence intervals.&lt;/p&gt;
&lt;p&gt;The above code produces the model summary below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Call&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(formula &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Year &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Remoteness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; State &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; Year, 
    data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)

Residuals&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
    Min      &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;Q  Median      &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;Q     Max 
&lt;span style=&#34;color:#40a070&#34;&gt;-75.968&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-35.474&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-8.968&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;27.053&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;192.976&lt;/span&gt; 

Coefficients&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
                   Estimate Std. Error t value &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;|&lt;/span&gt;t&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;)    
(Intercept)          &lt;span style=&#34;color:#40a070&#34;&gt;72.032&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;3.914&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;18.401&lt;/span&gt;  &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2e-16&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
Year2019            &lt;span style=&#34;color:#40a070&#34;&gt;-21.224&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;5.097&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-4.164&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3.20e-05&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
StateNSW              &lt;span style=&#34;color:#40a070&#34;&gt;3.936&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;4.433&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.888&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.374659&lt;/span&gt;    
StateNT              &lt;span style=&#34;color:#40a070&#34;&gt;-1.829&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;4.820&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.379&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.704419&lt;/span&gt;    
StateSA              &lt;span style=&#34;color:#40a070&#34;&gt;-5.948&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;4.692&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-1.268&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.205040&lt;/span&gt;    
StateTAS              &lt;span style=&#34;color:#40a070&#34;&gt;1.506&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;5.329&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.283&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.777544&lt;/span&gt;    
StateVIC             &lt;span style=&#34;color:#40a070&#34;&gt;-9.680&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;4.333&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-2.234&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.025549&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;  
StateWA             &lt;span style=&#34;color:#40a070&#34;&gt;-12.796&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;5.743&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-2.228&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.025940&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;  
RemotenessRegional   &lt;span style=&#34;color:#40a070&#34;&gt;-9.597&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;2.136&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-4.492&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;7.28e-06&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
Year2019&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;StateNSW    &lt;span style=&#34;color:#40a070&#34;&gt;17.690&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;6.071&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;2.914&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.003592&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt; 
Year2019&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;StateNT     &lt;span style=&#34;color:#40a070&#34;&gt;17.983&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;6.740&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;2.668&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.007664&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt; 
Year2019&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;StateSA     &lt;span style=&#34;color:#40a070&#34;&gt;20.301&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;6.549&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;3.100&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001952&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt; 
Year2019&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;StateTAS     &lt;span style=&#34;color:#40a070&#34;&gt;8.212&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;7.170&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;1.145&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.252149&lt;/span&gt;    
Year2019&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;StateVIC    &lt;span style=&#34;color:#40a070&#34;&gt;15.456&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;6.000&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;2.576&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.010029&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;  
Year2019&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;StateWA     &lt;span style=&#34;color:#40a070&#34;&gt;24.608&lt;/span&gt;      &lt;span style=&#34;color:#40a070&#34;&gt;6.986&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;3.522&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.000433&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
&lt;span style=&#34;color:#666&#34;&gt;---&lt;/span&gt;
Signif. codes&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;***&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;**&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;

Residual standard error&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;45.2&lt;/span&gt; on &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; degrees of freedom
Multiple R&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;squared&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.03092&lt;/span&gt;,	Adjusted R&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;squared&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.02721&lt;/span&gt; 
F&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;statistic&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;8.321&lt;/span&gt; on &lt;span style=&#34;color:#40a070&#34;&gt;14&lt;/span&gt; and &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; DF,  p&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;value&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2.2e-16&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Using a significance level of 0.05, most of the interaction terms between Year and States are significant. This indicates that the changes in alcohol consumption in Queensland are different from the changes in other states. However, interpreting these coefficients is not straightforward.&lt;/p&gt;
&lt;p&gt;An easier way to understand the interactions is to calculate the &lt;strong&gt;Estimated Marginal Means (EMMs)&lt;/strong&gt;. We can estimate the mean alcohol consumption by &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; from our regression model. The following is the R codes for computing EMMs.&lt;/p&gt;

&lt;h5 id=&#34;r-codes-explained---estimated-marginal-means&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---estimated-marginal-means&#34;&gt;R codes explained - Estimated Marginal Means&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following R code is used for calculating the estimated marginal means and performing pairwise comparisons (with effect sizes).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Year, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

&lt;span style=&#34;color:#06287e&#34;&gt;eff_size&lt;/span&gt;(emm, sigma &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sigma&lt;/span&gt;(res), edf &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;df.residual)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-1&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The few lines of code produces a long list of output that can be broken down into three major sections.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Estimated Marginal Means&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$emmeans
 State Year emmean   SE   df lower.CL upper.CL
 QLD   2017   67.2 3.83 3651     59.7     74.7
 NSW   2017   71.2 2.26 3651     66.7     75.6
 NT    2017   65.4 2.85 3651     59.8     71.0
 SA    2017   61.3 2.65 3651     56.1     66.5
 TAS   2017   68.7 3.65 3651     61.6     75.9
 VIC   2017   57.6 2.08 3651     53.5     61.6
 WA    2017   54.4 4.23 3651     46.1     62.7
 QLD   2019   46.0 3.39 3651     39.4     52.7
 NSW   2019   67.6 2.48 3651     62.8     72.5
 NT    2019   62.2 3.69 3651     54.9     69.4
 SA    2019   60.4 3.36 3651     53.8     66.9
 TAS   2019   55.7 3.80 3651     48.3     63.2
 VIC   2019   51.8 2.48 3651     46.9     56.6
 WA    2019   57.8 2.69 3651     52.6     63.1

Results are averaged over the levels of: Remoteness 
Confidence level used: 0.95 
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt; 
&lt;p&gt;The above table contains estimates for alcohol consumption by &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt;, with 95% confidence intervals. For example, it is estimated on average, participants in Queensland in 2017 consumed 67.2 standard drinks per month, with a 95% confidence interval of (59.7, 74.7).&lt;/p&gt;
&lt;p&gt;This table is then followed by a long table of pairwise comparisons. However, we will not be interested in most of these comparisons.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pairwise comparison&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$contrasts
 contrast            estimate   SE   df t.ratio p.value
 QLD 2017 - NSW 2017   -3.936 4.43 3651 -0.888  0.9998 
 QLD 2017 - NT 2017     1.829 4.82 3651  0.379  1.0000 
 QLD 2017 - SA 2017     5.948 4.69 3651  1.268  0.9927 
 .
 .
 .
 TAS 2019 - VIC 2019    3.941 4.65 3651  0.848  0.9999 
 TAS 2019 - WA 2019    -2.095 4.40 3651 -0.476  1.0000 
 VIC 2019 - WA 2019    -6.036 3.80 3651 -1.590  0.9489 
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;We are only interested in the 2017 and 2019 comparison in each state.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;contrast            estimate   SE   df t.ratio p.value
QLD 2017 - QLD 2019   21.224 5.10 3651  4.164  0.0026 
NSW 2017 - NSW 2019    3.534 3.32 3651  1.066  0.9987 
NT 2017 - NT 2019      3.240 4.41 3651  0.735  1.0000 
SA 2017 - SA 2019      0.923 4.11 3651  0.225  1.0000 
TAS 2017 - TAS 2019   13.012 5.04 3651  2.580  0.3533 
VIC 2017 - VIC 2019    5.768 3.17 3651  1.822  0.8666 
WA 2017 - WA 2019     -3.384 4.78 3651 -0.708  1.0000 
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
These results indicate that there is significant change in Queensland between 2017 and 2019 only. On average, consumption decreased by 21.22 standard drinks. The p-value is adjusted for a family of 14 estimates using Tukey&#39;s method. This adjustment is necessary to protect against an increased rate of false positives due to multiple testing.  
&lt;p&gt;Lastly, the pairwise comparisons is accompanied by a table of effect sizes.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Effect size&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt; contrast              effect.size     SE   df lower.CL &lt;span style=&#34;color:#06287e&#34;&gt;upper.CL
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt; &lt;/span&gt;(QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NSW &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;)    &lt;span style=&#34;color:#40a070&#34;&gt;-0.08708&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0981&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.27938&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.10522&lt;/span&gt;
 (QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NT &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;)      &lt;span style=&#34;color:#40a070&#34;&gt;0.04046&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1066&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.16862&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.24954&lt;/span&gt;
 (QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; SA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt;)      &lt;span style=&#34;color:#40a070&#34;&gt;0.13159&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1038&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.07197&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.33514&lt;/span&gt;
 .
 .
 &lt;span style=&#34;color:#06287e&#34;&gt;.
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt; &lt;/span&gt;(TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.08719&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1028&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.11438&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.28877&lt;/span&gt;
 (TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;-0.04636&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0973&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.23715&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.14444&lt;/span&gt;
 (VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;-0.13355&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0840&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.29822&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.03112&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Similarly, we will be only interested in the 2017 and 2019 comparisons in each state.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt; contrast              effect.size     SE   df lower.CL &lt;span style=&#34;color:#06287e&#34;&gt;upper.CL
&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt; &lt;/span&gt;(QLD &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; QLD &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.46955&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1129&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.24820&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.69091&lt;/span&gt;
 (NSW &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NSW &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.07819&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0734&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.06569&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.22207&lt;/span&gt;
 (NT &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; NT &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)       &lt;span style=&#34;color:#40a070&#34;&gt;0.07169&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0976&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.11964&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.26302&lt;/span&gt;
 (SA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; SA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)       &lt;span style=&#34;color:#40a070&#34;&gt;0.02041&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0909&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.15772&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.19855&lt;/span&gt;
 (TAS &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; TAS &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.28788&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1116&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.06905&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.50670&lt;/span&gt;
 (VIC &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; VIC &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)     &lt;span style=&#34;color:#40a070&#34;&gt;0.12761&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.0701&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.00976&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.26497&lt;/span&gt;
 (WA &lt;span style=&#34;color:#40a070&#34;&gt;2017&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; WA &lt;span style=&#34;color:#40a070&#34;&gt;2019&lt;/span&gt;)      &lt;span style=&#34;color:#40a070&#34;&gt;-0.07488&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1057&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3651&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;-0.28213&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.13237&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;These effect sizes can be interpreted according to Cohen&amp;rsquo;s rule: 0.2 represents a small effect size, 0.5 represents a medium effect size and 0.8 represents a large effect size.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;emmeans&lt;/code&gt; package provides a handy function &lt;code&gt;emmip&lt;/code&gt; to visualise the interaction.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, Year &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/interaction_plot.png&#34; alt=&#34;interaction plot&#34; title=&#34;interaction plot&#34;/&gt;&lt;/a&gt;

&lt;h4 id=&#34;numeric-independent-variable-and-categorical-moderator&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#numeric-independent-variable-and-categorical-moderator&#34;&gt;Numeric independent variable and categorical moderator&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In this example, we will look at the relationship between BMI, sex, age and depression. We want to test if the relationship between BMI and depression is different for males and females.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Is BMI associated with depression?&lt;/li&gt;
&lt;li&gt;Is the association between BMI and depression different for males and females?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this setup, &lt;em&gt;BMI&lt;/em&gt; is an independent variable, &lt;em&gt;Sex&lt;/em&gt; is a moderator and &lt;em&gt;depression&lt;/em&gt; is the dependent variable.&lt;/p&gt;
&lt;p&gt;We will first show the R code for this analysis below, and we will provide a step-by-step guide on how to complete this analysis. We use the built-in &lt;strong&gt;Personality&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using the instructions provided &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;load example data&#34;&gt;here&lt;/a&gt;. We will also use the &lt;code&gt;emmeans&lt;/code&gt; package in R for pairwise comparisons and for building the interaction plot.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/personality.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-1&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; BMI &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Age &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; BMI&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Sex,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(car)

res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rstandard&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .01 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Residual plots, curvature tests and normality plot&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;residualPlots&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Variance inflation factor (VIF &amp;gt;=5 indicates high level of multicollinearity)&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;vif&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

m_BMI&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;BMI, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
sd_BMI&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;BMI, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)


emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res,  &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; BMI&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Sex,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  BMI &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_BMI&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_BMI, m_BMI, m_BMI&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_BMI)), level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

simpleSlope &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emtrends&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Sex, var &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;BMI&amp;#34;&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(simpleSlope)

&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, Sex &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; BMI,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  BMI &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_BMI&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_BMI, m_BMI, m_BMI&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_BMI)),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;using-statsnotebook-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook-1&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Prior to running the moderation analysis, we will need to conduct a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/&#34; title=&#34;descriptive statistics&#34;&gt;descriptive analysis&lt;/a&gt; and it is always good practice to &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;DataViz&#34;&gt;visualise the data&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To run a moderation analysis using linear regression (numeric independent variable and categorical moderator),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;Depression&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, and select &lt;em&gt;BMI&lt;/em&gt;, &lt;em&gt;Sex&lt;/em&gt; and &lt;em&gt;Age&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;We will adjust for the effect of &lt;em&gt;Age&lt;/em&gt; by adding it as one of the covariates.&lt;/li&gt;
&lt;li&gt;We will need to code &lt;em&gt;Sex&lt;/em&gt; into a &lt;strong&gt;factor&lt;/strong&gt; because it is a &lt;strong&gt;categorical&lt;/strong&gt; variable. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for step-by-step guide.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/moderation_instruction2.png&#34; alt=&#34;Moderation (interaction) analysis&#34; title=&#34;Moderation (interaction) analysis&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Add interaction terms&lt;/strong&gt;, select &lt;em&gt;BMI&lt;/em&gt; and &lt;em&gt;Sex&lt;/em&gt; into &lt;em&gt;Interaction terms&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;The order of variable selection will determine the horizontal axis of the interaction plot (see interpretaion below). The first selected variable will always go to the horizontal axis. In this example, we click &lt;em&gt;BMI&lt;/em&gt; first and then &lt;em&gt;Sex&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/add_interaction_term2.png&#34; alt=&#34;add interaction terms&#34; title=&#34;add interaction terms&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Estimated Marginal Means&lt;/strong&gt;, select &lt;em&gt;BMI*Sex&lt;/em&gt; on the variable list, and select &lt;strong&gt;Test for simple slope&lt;/strong&gt; and &lt;strong&gt;Interaction plot&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/moderation_emm2.png&#34; alt=&#34;estimated marginal mean&#34; title=&#34;estimated marginal mean&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;r-codes-explained---moderation-analysis-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---moderation-analysis-1&#34;&gt;R codes explained - Moderation analysis&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following is from the top selection of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; BMI &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Age &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; BMI&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Sex,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;This code tells R to run a linear regression using the &lt;strong&gt;lm&lt;/strong&gt; function. The left side of the &lt;strong&gt;&amp;ldquo;~&amp;rdquo;&lt;/strong&gt; symbol specifies the &lt;em&gt;dependent variable&lt;/em&gt;; the right side specifies the &lt;em&gt;independent variables&lt;/em&gt;. &lt;strong&gt;StatsNotebook&lt;/strong&gt; has added the interaction term &lt;strong&gt;BMI*Sex&lt;/strong&gt; as an extra term. The results from this regression analysis is then printed out using the &lt;strong&gt;summary&lt;/strong&gt; function. Lastly, the &lt;strong&gt;cbind&lt;/strong&gt;, &lt;strong&gt;coef&lt;/strong&gt; and &lt;strong&gt;confint&lt;/strong&gt; functions are used to print the model coefficients with the corresponding 95% confidence intervals.&lt;/p&gt;
&lt;p&gt;These codes will produce the model summary below.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;Call&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(formula &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; BMI &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Age &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; BMI &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; Sex, data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; currentDataset)

Residuals&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
    Min      &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;Q  Median      &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;Q     Max 
&lt;span style=&#34;color:#40a070&#34;&gt;-28.383&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-7.878&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.261&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;7.397&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;40.032&lt;/span&gt; 

Coefficients&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;
            Estimate Std. Error t value &lt;span style=&#34;color:#06287e&#34;&gt;Pr&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;|&lt;/span&gt;t&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;)    
(Intercept) &lt;span style=&#34;color:#40a070&#34;&gt;-1.46366&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;6.49795&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-0.225&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.821875&lt;/span&gt;    
BMI          &lt;span style=&#34;color:#40a070&#34;&gt;1.73313&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.26220&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;6.610&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;9.66e-11&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
SexMale     &lt;span style=&#34;color:#40a070&#34;&gt;24.43426&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;9.47073&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;2.580&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.010158&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;  
Age         &lt;span style=&#34;color:#40a070&#34;&gt;-0.15025&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.04341&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-3.461&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.000583&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
BMI&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;SexMale &lt;span style=&#34;color:#40a070&#34;&gt;-1.31631&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.37599&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;-3.501&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.000504&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;***&lt;/span&gt;
&lt;span style=&#34;color:#666&#34;&gt;---&lt;/span&gt;
Signif. codes&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;***&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.001&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;**&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.01&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.05&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.1&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1&lt;/span&gt;

Residual standard error&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;10.98&lt;/span&gt; on &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt; degrees of freedom
Multiple R&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;squared&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.1727&lt;/span&gt;,	Adjusted R&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;squared&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt;  &lt;span style=&#34;color:#40a070&#34;&gt;0.1662&lt;/span&gt; 
F&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;statistic&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;26.77&lt;/span&gt; on &lt;span style=&#34;color:#40a070&#34;&gt;4&lt;/span&gt; and &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt; DF,  p&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;value&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;2.2e-16&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-2&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Using a significance level of 0.05, the interaction terms between BMI and Sex is highly significant. This indicates that the effect of BMI on depression is different for males and for females.&lt;/p&gt;
&lt;p&gt;To follow-up this interaction, we calculate the &lt;strong&gt;Estimated Marginal Means (EMMs)&lt;/strong&gt; of &lt;em&gt;depression&lt;/em&gt; at different levels of BMI by sex, and test for the effect of BMI separately for males and females with a &lt;strong&gt;simple slopes analysis&lt;/strong&gt;.&lt;/p&gt;

&lt;h5 id=&#34;r-codes-explained---estimated-marginal-means-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---estimated-marginal-means-1&#34;&gt;R codes explained - Estimated marginal means&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following R codes are for (1) calculating the estimated marginal means of Depression at the mean of BMI, and one standard deviation (+/- SD) below and above the mean of BMI for females and males; and (2) performing simple slope analysis using the &lt;code&gt;emtrends&lt;/code&gt; function. The second step tests the association between &lt;em&gt;BMI&lt;/em&gt; and &lt;em&gt;depression&lt;/em&gt; separately for females and males.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

m_BMI&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;BMI, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
sd_BMI&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;BMI, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)


emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res,  &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; BMI&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;Sex,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  BMI &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_BMI&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_BMI, m_BMI, m_BMI&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_BMI)), level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

simpleSlope &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emtrends&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Sex, var &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;BMI&amp;#34;&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(simpleSlope)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-3&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The output from this code can be broken down into two sections: Estimated marginal means and Simple slope analysis.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Estimated marginal means&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;[1] &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#60a0b0;font-style:italic&#34;&gt;######################################################&lt;/span&gt;
  BMI Sex    emmean    SE  df lower.CL upper.CL
 &lt;span style=&#34;color:#40a070&#34;&gt;22.2&lt;/span&gt; Female   &lt;span style=&#34;color:#40a070&#34;&gt;31.9&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.832&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;30.3&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;33.5&lt;/span&gt;
 &lt;span style=&#34;color:#40a070&#34;&gt;24.9&lt;/span&gt; Female   &lt;span style=&#34;color:#40a070&#34;&gt;36.6&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.676&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;35.2&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;37.9&lt;/span&gt;
 &lt;span style=&#34;color:#40a070&#34;&gt;27.6&lt;/span&gt; Female   &lt;span style=&#34;color:#40a070&#34;&gt;41.2&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.104&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;39.1&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;43.4&lt;/span&gt;
 &lt;span style=&#34;color:#40a070&#34;&gt;22.2&lt;/span&gt; Male     &lt;span style=&#34;color:#40a070&#34;&gt;27.1&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1.203&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;24.7&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;29.4&lt;/span&gt;
 &lt;span style=&#34;color:#40a070&#34;&gt;24.9&lt;/span&gt; Male     &lt;span style=&#34;color:#40a070&#34;&gt;28.2&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.759&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;26.7&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;29.7&lt;/span&gt;
 &lt;span style=&#34;color:#40a070&#34;&gt;27.6&lt;/span&gt; Male     &lt;span style=&#34;color:#40a070&#34;&gt;29.3&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.872&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;27.6&lt;/span&gt;     &lt;span style=&#34;color:#40a070&#34;&gt;31.0&lt;/span&gt;

Confidence level used&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The above table contains the estimated marginal means of Depression at different levels of &lt;em&gt;BMI&lt;/em&gt; for males and females, with 95% confidence intervals. For example, the estimated Depression score for females with BMI one standard deviation above the mean is 41.2 (95% CI [39.1, 43.4]). For females with BMI one standard deviation below the mean, their estimated Depression score is 31.9 (95% CI [30.3, 33.5]). Therefore, there is quite a substantial difference in Depression between females at higher and lower levels of BMI.&lt;/p&gt;
&lt;p&gt;For males, the difference is much smaller. For males with high BMI, the estimated Depression score is 29.3 (95% CI [27.6, 31.0]); for male with low BMI, the estimated Depression score is 27.1 (95% CI [24.7, 29.4]).&lt;/p&gt;
&lt;p&gt;The marginal mean table is followed by a table of simple slopes - The slope of BMI for males and females are presented separately.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Simple slope analysis&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;emtrends
 Sex    BMI.trend    SE  df lower.CL upper.CL
 Female     &lt;span style=&#34;color:#40a070&#34;&gt;1.733&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.262&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;1.218&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;2.248&lt;/span&gt;
 Male       &lt;span style=&#34;color:#40a070&#34;&gt;0.417&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.270&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;-0.114&lt;/span&gt;    &lt;span style=&#34;color:#40a070&#34;&gt;0.947&lt;/span&gt;

Confidence level used&lt;span style=&#34;color:#666&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt; 

&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;contrasts
 contrast      estimate    SE  df t.ratio p.value
 Female &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; Male     &lt;span style=&#34;color:#40a070&#34;&gt;1.32&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.376&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;513&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3.501&lt;/span&gt;   &lt;span style=&#34;color:#40a070&#34;&gt;0.0005&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Simple slopes analysis shows that for males, each unit increase in BMI is associated with 0.417 unit increase in Depression score (b = 0.417, 95% CI [-0.114, 0.947]), and it is not statistically significant. For female, each unit increase in BMI is significantly associated with 1.733 unit increase in Depression score (b = 1.733, 95% CI [1.218, 2.248]). The slope of BMI on Depression for female is significantly larger than for male (difference = 1.32, p &amp;lt; .001).&lt;/p&gt;
&lt;p&gt;Lastly, we can use the &lt;code&gt;emmip&lt;/code&gt; function to visualise the interaction.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, Sex &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; BMI,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  BMI &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_BMI&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_BMI, m_BMI, m_BMI&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_BMI)),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;../img/interaction_plot2.png&#34; alt=&#34;interaction plot 2&#34; title=&#34;Interactin plot - Depression by BMI and Sex&#34;&gt;&lt;/p&gt;

&lt;h4 id=&#34;numeric-independent-variable-and-numeric-moderator&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#numeric-independent-variable-and-numeric-moderator&#34;&gt;Numeric independent variable and numeric moderator&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In this example, we will look at the relationship between stress and psychological wellbeing among adolescents, and test if this relationship is moderated by social support.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It is expected that &lt;em&gt;stress&lt;/em&gt; reduces &lt;em&gt;psychological wellbeing&lt;/em&gt;, and high levels of social support weakens this negative association.
&lt;ul&gt;
&lt;li&gt;In this analysis, we will test the interaction between &lt;em&gt;stress&lt;/em&gt; and &lt;em&gt;social support&lt;/em&gt; on &lt;em&gt;psychological wellbeing&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We will firstly show the R codes for this analysis below, and we will provide a step-by-step guide on how to complete this analysis. We use the built-in &lt;strong&gt;Wellbeing&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instructions provided &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;load example data&#34;&gt;here&lt;/a&gt;. We will also use the &lt;code&gt;emmeans&lt;/code&gt; package in R for pairwise comparisons and for building the interaction plot.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/wellbeing.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-2&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Wellbeing &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Stress &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; SocialSupport &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Stress&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;SocialSupport,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(car)

res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rstandard&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .01 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Residual plots, curvature tests and normality plot&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;residualPlots&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Variance inflation factor (VIF &amp;gt;=5 indicates high level of multicollinearity)&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;vif&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

m_Stress&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Stress, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
sd_Stress&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Stress, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)

m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;SocialSupport, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
sd_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;SocialSupport, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)


emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res,  &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Stress&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;SocialSupport,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  Stress &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_Stress&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_Stress, m_Stress, m_Stress&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_Stress),
  SocialSupport &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_SocialSupport, m_SocialSupport, m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_SocialSupport)), level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

simpleSlope &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emtrends&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; SocialSupport, var &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Stress&amp;#34;&lt;/span&gt;,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  
  SocialSupport &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_SocialSupport, m_SocialSupport, m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_SocialSupport)), level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(simpleSlope)

&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, SocialSupport &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Stress,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  Stress &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_Stress&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_Stress, m_Stress, m_Stress&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_Stress),
  SocialSupport &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_SocialSupport, m_SocialSupport, m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_SocialSupport)),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;using-statsnotebook-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook-2&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Prior to running the moderation analysis, we will need to conduct a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/&#34; title=&#34;descriptive statistics&#34;&gt;descriptive analysis&lt;/a&gt; and it is always good practice to &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;DataViz&#34;&gt;visualise the data&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To run a moderation analysis using linear regression (numeric independent variable and numeric moderator),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;Wellbeing&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, and select &lt;em&gt;Stress&lt;/em&gt;, &lt;em&gt;SocialSupport&lt;/em&gt; and &lt;em&gt;Sex&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;We have added &lt;em&gt;Sex&lt;/em&gt; into this analysis to adjust for its effect.&lt;/li&gt;
&lt;li&gt;We will need to code &lt;em&gt;Sex&lt;/em&gt; into a &lt;strong&gt;factor&lt;/strong&gt; because it is a &lt;strong&gt;categorical&lt;/strong&gt; variable. See &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;Converting variable type&lt;/a&gt; for step-by-step guide&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/moderation_instruction3.png&#34; alt=&#34;moderation (interaction) analysis&#34; title=&#34;moderation (interaction) analysis&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Expand the panel **Add interaction terms&amp;rdquo;, select &lt;em&gt;Stress&lt;/em&gt; and &lt;em&gt;SocialSupport&lt;/em&gt; into &lt;em&gt;Interaction terms&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;The order of selecting variables will determine the horizontal axis of the interaction plot (see interpretation below). The first selected variable will always go to the horizontal axis. In this example, we click &lt;em&gt;Stress&lt;/em&gt; first and then &lt;em&gt;SocialSupport&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/add_interaction_term3.png&#34; alt=&#34;add interaction terms&#34; title=&#34;add interaction terms&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Expand the panel &lt;strong&gt;Estimated Marginal Means&lt;/strong&gt;, select &lt;em&gt;Stress*SocialSupport&lt;/em&gt; on the variable list, and select &lt;strong&gt;Test for simple slope&lt;/strong&gt; and &lt;strong&gt;Interaction plot&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/moderation_emm3.png&#34; alt=&#34;estimated marginal mean&#34; title=&#34;estimated marginal mean&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;r-codes-explained---moderation-analysis-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---moderation-analysis-2&#34;&gt;R codes explained - Moderation analysis&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Wellbeing &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Stress &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; SocialSupport &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Stress&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;SocialSupport,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The code tells R to run a linear regression using the &lt;strong&gt;lm&lt;/strong&gt; function. The left side of the &lt;strong&gt;&amp;ldquo;~&amp;rdquo;&lt;/strong&gt; symbol specifies the &lt;em&gt;dependent variable&lt;/em&gt;; the right side specifies the &lt;em&gt;independent variables&lt;/em&gt;. &lt;strong&gt;StatsNotebook&lt;/strong&gt; has added the interaction term &lt;strong&gt;Stress*SocialSupport&lt;/strong&gt; as an extra term. The results from this regression analysis are then printed out using the &lt;strong&gt;summary&lt;/strong&gt; function. Lastly, the &lt;strong&gt;cbind&lt;/strong&gt;, &lt;strong&gt;coef&lt;/strong&gt; and &lt;strong&gt;confint&lt;/strong&gt; functions are used to print the model coefficients with the corresponding 95% confidence intervals.&lt;/p&gt;
&lt;p&gt;This code produces the model summary below.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Call:
lm(formula = Wellbeing ~ Stress + SocialSupport + Sex + Stress * 
    SocialSupport, data = currentDataset)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5771 -0.6796 -0.0266  0.6410  2.8454 

Coefficients:
                     Estimate Std. Error t value Pr(&amp;gt;|t|)    
(Intercept)           0.04169    0.04319   0.965  0.33460    
Stress               -0.23466    0.03144  -7.464 1.83e-13 ***
SocialSupport         0.33277    0.03124  10.651  &amp;lt; 2e-16 ***
SexMale              -0.05241    0.06404  -0.818  0.41338    
Stress:SocialSupport  0.08930    0.03017   2.960  0.00315 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9974 on 995 degrees of freedom
Multiple R-squared:  0.1431,	Adjusted R-squared:  0.1397 
F-statistic: 41.55 on 4 and 995 DF,  p-value: &amp;lt; 2.2e-16
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation-4&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-4&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Using a significance level of 0.05, the interaction term between &lt;em&gt;Stress&lt;/em&gt; and &lt;em&gt;Social Support&lt;/em&gt; is statistically significant. This indicates that the association between &lt;em&gt;stress&lt;/em&gt; and &lt;em&gt;psychological wellbeing&lt;/em&gt; varies across different level of &lt;em&gt;Social Support&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;To follow-up this interaction, we calculate the &lt;strong&gt;Estimated Marginal Means (EMMs)&lt;/strong&gt; of &lt;em&gt;psychological wellbeing&lt;/em&gt; at different levels (-1 SD/ mean/ +1 SD) of &lt;em&gt;Stress&lt;/em&gt; across different levels (-1 SD/ mean/ +1 SD) of &lt;em&gt;Social Support&lt;/em&gt;, and test for the effect of &lt;em&gt;Stress&lt;/em&gt; at different levels of &lt;em&gt;Social Support&lt;/em&gt; with &lt;strong&gt;simple slopes analysis&lt;/strong&gt;.&lt;/p&gt;

&lt;h5 id=&#34;r-codes-explained---estimated-marginal-means-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---estimated-marginal-means-2&#34;&gt;R codes explained - Estimated marginal means&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following R codes are for (1) calculating the estimated marginal means of &lt;em&gt;psychological wellbeing&lt;/em&gt; at the mean of &lt;em&gt;stress&lt;/em&gt;, and one standard deviation (+/- SD) below and above the mean of &lt;em&gt;stress&lt;/em&gt; and at the mean of &lt;em&gt;social support&lt;/em&gt;, and one standard deviation (+/- SD) below and above the mean of &lt;em&gt;social support&lt;/em&gt; ; and (2) performing simple slopes analysis using the &lt;code&gt;emtrends&lt;/code&gt; function. The second step tests the association of &lt;em&gt;stress&lt;/em&gt; and &lt;em&gt;psychological wellbeing&lt;/em&gt; at different levels of &lt;em&gt;social support&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Estimated Marginal Means&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(emmeans)

m_Stress&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Stress, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
sd_Stress&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Stress, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)

m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;SocialSupport, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
sd_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;SocialSupport, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)


emm &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emmeans&lt;/span&gt;(res,  &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Stress&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;SocialSupport,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  Stress &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_Stress&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_Stress, m_Stress, m_Stress&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_Stress),
  SocialSupport &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_SocialSupport, m_SocialSupport, m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_SocialSupport)), level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(emm)

simpleSlope &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;emtrends&lt;/span&gt;(res, pairwise &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; SocialSupport, var &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Stress&amp;#34;&lt;/span&gt;,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  
  SocialSupport &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_SocialSupport, m_SocialSupport, m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_SocialSupport)), level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(simpleSlope)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation-5&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation-5&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The output from this code can be broken down in to two sections: Estimated marginal means and Simple slopes analysis.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Estimated marginal means&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[1] &amp;quot;Estimated Marginal Means&amp;quot;

######################################################
 Stress SocialSupport   emmean     SE  df lower.CL upper.CL
 -0.914      -1.00990 -0.02356 0.0588 995  -0.1389   0.0918
  0.104      -1.00990 -0.35438 0.0452 995  -0.4432  -0.2656
  1.122      -1.00990 -0.68520 0.0677 995  -0.8181  -0.5523
 -0.914       0.00997  0.23255 0.0450 995   0.1443   0.3208
  0.104       0.00997 -0.00552 0.0319 995  -0.0682   0.0571
  1.122       0.00997 -0.24359 0.0454 995  -0.3328  -0.1544
 -0.914       1.02983  0.48865 0.0667 995   0.3578   0.6195
  0.104       1.02983  0.34333 0.0449 995   0.2553   0.4314
  1.122       1.02983  0.19802 0.0605 995   0.0793   0.3168

Results are averaged over the levels of: Sex 
Confidence level used: 0.95 
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;The above table contains the estimated marginal means of &lt;em&gt;psychological wellbeing&lt;/em&gt; at different levels of &lt;em&gt;stress&lt;/em&gt; across different levels of &lt;em&gt;social support&lt;/em&gt;, with 95% confidence intervals. For example, for participants with low levels of &lt;em&gt;stress&lt;/em&gt; (-0.914; 1 SD below the mean of stress) and at low levels of &lt;em&gt;social support&lt;/em&gt;, the estimated marginal mean of &lt;em&gt;psychological wellbeing&lt;/em&gt; is -0.024 (95% CI [-0.139, 0.092]).&lt;/p&gt;
&lt;p&gt;The marginal means table is followed by a table of simple slopes - The slope of &lt;em&gt;stress&lt;/em&gt; at low (1 SD below the mean), mean and high (1 SD above the mean) level of social support.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Simple slope analysis&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$emtrends
 SocialSupport Stress.trend     SE  df lower.CL upper.CL
      -1.00990       -0.325 0.0436 995   -0.410  -0.2392
       0.00997       -0.234 0.0314 995   -0.295  -0.1721
       1.02983       -0.143 0.0443 995   -0.230  -0.0557

Results are averaged over the levels of: Sex 
Confidence level used: 0.95 

$contrasts
 contrast                                  estimate     SE  df t.ratio p.value
 (-1.00989834193271) - 0.00996585519298274  -0.0911 0.0308 995 -2.960  0.0088 
 (-1.00989834193271) - 1.02983005231867     -0.1822 0.0615 995 -2.960  0.0088 
 0.00996585519298274 - 1.02983005231867     -0.0911 0.0308 995 -2.960  0.0088 

Results are averaged over the levels of: Sex 
P value adjustment: tukey method for comparing a family of 3 estimates 
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;The simple slope analysis shows that for those with low levels of social support (1 SD below the mean of social support), a one unit increase in &lt;em&gt;stress&lt;/em&gt; is associated with 0.325 unit decrease in &lt;em&gt;psychological wellbeing&lt;/em&gt; (95% CI [-0.410, -0.239]); for those with an average level of social support, a one unit increase in &lt;em&gt;stress&lt;/em&gt; is associated with 0.234 unit decrease in &lt;em&gt;psychological wellbeing&lt;/em&gt; (95% CI [-0.295, -0.172]); for those with high levels of social support (1 SD above the mean of social support), one unit increase in &lt;em&gt;stress&lt;/em&gt; is associated with 0.143 unit decrease in &lt;em&gt;psychological wellbeing&lt;/em&gt;. These results indicate that &lt;em&gt;social support&lt;/em&gt; can buffer the negative impact of &lt;em&gt;stress&lt;/em&gt; on &lt;em&gt;psychological wellbeing&lt;/em&gt;, as the association between &lt;em&gt;stress&lt;/em&gt; and &lt;em&gt;psychological wellbeing&lt;/em&gt; is weaker at higher levels of social support.&lt;/p&gt;
&lt;p&gt;Lastly, we can use the &lt;code&gt;emmip&lt;/code&gt; function to visualise the interaction.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;emmip&lt;/span&gt;(res, SocialSupport &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Stress,
  cov.keep &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;, at &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;list&lt;/span&gt;(
  Stress &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_Stress&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_Stress, m_Stress, m_Stress&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_Stress),
  SocialSupport &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;sd_SocialSupport, m_SocialSupport, m_SocialSupport&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;sd_SocialSupport)),
  CIs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;, position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;jitter&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/interaction_plot3.png&#34; alt=&#34;Interaction plot - Psychological wellbeing by Stress and Social support&#34; title=&#34;Interaction plot - Psychological wellbeing by Stress and Social support&#34;/&gt;&lt;/a&gt;
</description>
    </item>
    
    <item>
      <title>Boxplot</title>
      <link>https://statsnotebook.io/blog/dataviz/boxplot/</link>
      <pubDate>Sun, 20 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/boxplot/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Boxplot is commonly used to compare distribution of a numeric variables across several groups. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses &lt;code&gt;geom_boxplot()&lt;/code&gt; from &lt;code&gt;ggplot2&lt;/code&gt; to build boxplot.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;alcohol&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../../data_management/load_example_data&#34;&gt;here&lt;/a&gt;. This is a simulated data of alcohol consumption from 3666 individuals.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We will use the following three variables from this dataset&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;alcohol - Number of standard drinks consumed in a month&lt;/li&gt;
&lt;li&gt;Remoteness - Capital city or regional area&lt;/li&gt;
&lt;li&gt;State - Seven states/territories in Australia: Queensland, New South Wales, Northern Territory, South Australia, Tasmania, Victoria and Western Australia.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this example, we will build&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#simple-boxplot&#34;&gt;Simple boxplot&lt;/a&gt;
        &lt;a href=&#34;#simple-boxplot&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/simple_boxplot.png&#34; alt=&#34;Simple boxplot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#boxplot-by-one-grouping-variable&#34;&gt;Boxplot (one grouping variable)&lt;/a&gt;
        &lt;a href=&#34;#boxplot-by-one-grouping-variable&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/boxplot_by_1group.png&#34; alt=&#34;Boxplot by one group&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#boxplot-by-two-grouping-variables&#34;&gt;Boxplot (two grouping variables)&lt;/a&gt;
        &lt;a href=&#34;#boxplot-by-two-grouping-variables&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/boxplot_by_2groups.png&#34; alt=&#34;Boxplot by two groups&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#multiple-boxplots&#34;&gt;Multiple boxplots&lt;/a&gt;
        &lt;a href=&#34;#multiple-boxplots&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/multiple_boxplot_by_facet.png&#34; alt=&#34;Multiple boxplots by facets&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h5 id=&#34;simple-boxplot&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#simple-boxplot&#34;&gt;Simple boxplot&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a simple boxplot for a single numeric variable (e.g. alcohol),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Boxplot/ Violin plot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the Boxplot/ Violin plot panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Vertical Axis&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_boxplot&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/simple_boxplot.png&#34; alt=&#34;Simple boxplot plot&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;boxplot-by-one-grouping-variable&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#boxplot-by-one-grouping-variable&#34;&gt;Boxplot by one grouping variable&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a boxplot for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;State&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Boxplot/ Violin plot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the boxplot panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Vertical axis&lt;/em&gt; and select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal aixs&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_boxplot&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/boxplot_by_1group.png&#34; alt=&#34;Boxplot by a grouping variable&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;boxplot-by-two-grouping-variables&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#boxplot-by-two-grouping-variables&#34;&gt;Boxplot by two grouping variables&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a boxplot for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by two grouping variables (e.g. &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Boxplot/ Violin plot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the boxplot panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Vertical axis&lt;/em&gt;, select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal aixs&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Split by Fill color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State, Year) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_boxplot&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-2&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/boxplot_by_2groups.png&#34; alt=&#34;Boxplot by two grouping variables&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;multiple-boxplots&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#multiple-boxplots&#34;&gt;Multiple boxplots&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build multiple boxplot for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;States&lt;/em&gt; abd &lt;em&gt;Year&lt;/em&gt;) in multiple facets (by another variable, e.g. &lt;em&gt;Remoteness&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Boxplot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the boxplot panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Vertical axis&lt;/em&gt;, &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal axis&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Split by: Fill Color&lt;/em&gt; and &lt;em&gt;Remoteness&lt;/em&gt; to &lt;em&gt;Facet&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Remoteness&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; and &lt;em&gt;State&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Remoteness, State) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Remoteness)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_density&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.2&lt;/span&gt;, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; State)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-3&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-3&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/multiple_boxplot_by_facet.png&#34; alt=&#34;Multiple boxplot plots by facet&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;citation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citation&#34;&gt;Citation&lt;/a&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. [Computer Software]. Retrieved from https://www.statsnotebook.io
R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org
Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Correlogram</title>
      <link>https://statsnotebook.io/blog/dataviz/correlogram/</link>
      <pubDate>Sun, 20 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/correlogram/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Correlogram is a type of chart that visualise the pairwise association between variables. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses the &lt;code&gt;ggpairs()&lt;/code&gt; function from the &lt;code&gt;GGally&lt;/code&gt; library to build correlogram. A publication ready correlogram can be built within a few minutes with &lt;strong&gt;StatsNotebook&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;Personality&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../../data_management/load_example_data&#34;&gt;here&lt;/a&gt; or can be downloaded from &lt;a href=&#34;../../data_management/example_data/personality.csv&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/personality.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In this example, we will build a &lt;a href=&#34;#correlogram-scatterplot-matrix&#34; title=&#34;Correlogram (Scatterplot matrix)&#34;&gt;simple correlogram&lt;/a&gt; to visualise the relationship between four variables (three personality variables: &lt;em&gt;Conscientiousness&lt;/em&gt;, &lt;em&gt;Neuroticism&lt;/em&gt;, &lt;em&gt;Openness&lt;/em&gt; and one mental health variable: &lt;em&gt;Depression&lt;/em&gt;). We then build a &lt;a href=&#34;#correlogram-scatterplot-matrix-by-group&#34; title=&#34;Correlogram (Scatterplot matrix by group)&#34;&gt;correlogram by Sex&lt;/a&gt; (Male and Female.)&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#correlogram-scatterplot-matrix&#34;&gt;Correlogram&lt;/a&gt;
        &lt;a href=&#34;#correlogram-scatterplot-matrix&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/correlogram2.png&#34; alt=&#34;Simple density plot&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#correlogram-scatterplot-matrix-by-group&#34;&gt;Correlogram by groups&lt;/a&gt;
        &lt;a href=&#34;#correlogram-scatterplot-matrix-by-group&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/correlogram3.png&#34; alt=&#34;Density plot by groups&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h4 id=&#34;correlogram-scatterplot-matrix&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#correlogram-scatterplot-matrix&#34;&gt;Correlogram (Scatterplot matrix)&lt;/a&gt;&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Correlation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Correlogram&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Correlogram&lt;/strong&gt; panel, select &lt;em&gt;Conscientiousness&lt;/em&gt;, &lt;em&gt;Neuroticism&lt;/em&gt;, &lt;em&gt;Openness&lt;/em&gt;, and &lt;em&gt;Depression&lt;/em&gt; from the &lt;em&gt;Variables&lt;/em&gt; (left) to &lt;em&gt;Horizontal Axis&lt;/em&gt; (right).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/correlogram_instruction.png&#34; alt=&#34;Correlogram instruction&#34; title=&#34;Instruction for plotting simple correlogram&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R Codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(GGally)

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Conscientiousness, Neuroticism, Openness, Depression) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;select&lt;/span&gt;(Conscientiousness, Neuroticism, Openness, Depression) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggpairs&lt;/span&gt;(progress &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/correlogram2.png&#34; alt=&#34;Correlogram&#34; title=&#34;Correlogram (Scatterplot matrix)&#34;&gt;&lt;/p&gt;

&lt;h4 id=&#34;correlogram-scatterplot-matrix-by-group&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#correlogram-scatterplot-matrix-by-group&#34;&gt;Correlogram (Scatterplot matrix) by group&lt;/a&gt;&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Correlation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Correlogram&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Correlogram&lt;/strong&gt; panel, select the &lt;em&gt;Conscientiousness&lt;/em&gt;, &lt;em&gt;Neuroticism&lt;/em&gt;, &lt;em&gt;Openness&lt;/em&gt;, and &lt;em&gt;Depression&lt;/em&gt; from the &lt;em&gt;Variables&lt;/em&gt; (left) to &lt;em&gt;Horizontal Axis&lt;/em&gt; (right).&lt;/li&gt;
&lt;li&gt;Select &lt;em&gt;Sex&lt;/em&gt; to &lt;em&gt;Split by: Fill color&lt;/em&gt; (right).
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Sex&lt;/em&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/correlogram_instruction2.png&#34; alt=&#34;Correlogram by group instruction&#34; title=&#34;Instruction for plotting correlogram by group&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-1&#34;&gt;R Codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(GGally)

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Conscientiousness, Neuroticism, Openness, Depression, Sex) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;select&lt;/span&gt;(Conscientiousness, Neuroticism, Openness, Depression, Sex) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggpairs&lt;/span&gt;(progress &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;FALSE&lt;/span&gt;,
  ggplot2&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.65&lt;/span&gt;, color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Sex))&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme_bw&lt;/span&gt;(base_family &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;sans&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/correlogram3.png&#34; alt=&#34;Correlogram by group&#34; title=&#34;Correlogram by group (Scatterplot matrix)&#34;&gt;&lt;/p&gt;

&lt;h4 id=&#34;citation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citation&#34;&gt;Citation&lt;/a&gt;&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. [Computer Software]. Retrieved from https://www.statsnotebook.io
R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org
Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Descriptive statistics</title>
      <link>https://statsnotebook.io/blog/analysis/descriptive/</link>
      <pubDate>Sun, 20 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/descriptive/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;This tutorial will give a short introduction on descriptive analysis using &lt;strong&gt;StatsNotebook&lt;/strong&gt;. Descriptive statistics such as mean, standard deviation, median and interquartile range can be easily obtained using the &lt;strong&gt;Explore&lt;/strong&gt; panel.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;Personality&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using the instructions provided &lt;a href=&#34;https://statsnotebook.io/blog/data_management/load_example_data/&#34; title=&#34;Load example data&#34;&gt;here&lt;/a&gt; or can be downloaded from &lt;a href=&#34;https://statsnotebook.io/blog/data_management/example_data/personality.csv&#34;/&gt;
    here
&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/personality.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The &lt;strong&gt;Personality&lt;/strong&gt; dataset contains data from 231 participants, with measures on the Big 5 personality factors (&lt;em&gt;Agreeableness&lt;/em&gt;, &lt;em&gt;Conscientiousness&lt;/em&gt;, &lt;em&gt;Extraversion&lt;/em&gt;, &lt;em&gt;Neuroticism&lt;/em&gt; and &lt;em&gt;Openness&lt;/em&gt;), and three measures of mental health (&lt;em&gt;Depression&lt;/em&gt;, &lt;em&gt;Trait anxiety&lt;/em&gt; and &lt;em&gt;State anxiety&lt;/em&gt;). It also contains data on participants&amp;rsquo; sex.&lt;/p&gt;
&lt;p&gt;We will demonstrate how to generate simple &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/#descriptive-statistics&#34; title=&#34;Descriptive statistics&#34;&gt;descriptive statistics&lt;/a&gt;, and how to generate &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/#descriptive-statistics-by-group&#34; title=&#34;Descriptive statistics by group&#34;&gt;descriptive statistics by group&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&#34;descriptive-statistics&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#descriptive-statistics&#34;&gt;Descriptive statistics&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;To calculate descriptive statistics,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Explore&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Descriptive statistics&lt;/strong&gt; on the menu&lt;/li&gt;
&lt;li&gt;Select variables into &lt;strong&gt;Target Variables&lt;/strong&gt; on the right. In this example, we will select &lt;em&gt;Neuroticism&lt;/em&gt;, &lt;em&gt;Depression&lt;/em&gt; and &lt;em&gt;Sex&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Sex&lt;/strong&gt; is a categorical variable. If it is not yet coded as a &lt;strong&gt;factor&lt;/strong&gt;, we will need to manually &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable conversion&#34;&gt;convert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/analysis/img/descriptive_statistics.png&#34; alt=&#34;Descriptive statistics&#34; title=&#34;Descriptive statistics&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Expand the &lt;strong&gt;Statistics and plots&lt;/strong&gt; panel, by default, &lt;strong&gt;mean&lt;/strong&gt; and &lt;strong&gt;standard deviation&lt;/strong&gt; are calculated for a numeric variable (&lt;em&gt;Neuroticism&lt;/em&gt; and &lt;em&gt;Depression&lt;/em&gt;); &lt;strong&gt;count&lt;/strong&gt; is calculated for a categorical (factor) variable (&lt;em&gt;Sex&lt;/em&gt;). Additional statistics, such as &lt;strong&gt;median&lt;/strong&gt; and &lt;strong&gt;interquartile range&lt;/strong&gt; can be requested here.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/analysis/img/statistics_plots.png&#34; alt=&#34;statistics and plots&#34; title=&#34;statistics and plots&#34;/&gt;&lt;/a&gt;

&lt;h5 id=&#34;r-codes---descriptive-statistics&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes---descriptive-statistics&#34;&gt;R codes - Descriptive statistics&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following is the R code generated by &lt;strong&gt;StatsNotebook&lt;/strong&gt;. We will explain these codes in the  &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/#r-codes-explained---descriptive-statistics&#34; title=&#34;R codes explained&#34;&gt;next section&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(e1071)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(ggplot2)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(GGally)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Sample size and missing data&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;(), 
  mis_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Neuroticism)), 
  mis_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Depression)), 
  mis_Sex &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Sex))
  )

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Descriptive Statistics for numeric variables&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;(),
  M_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(Neuroticism, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  M_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(Depression, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  SD_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(Neuroticism, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  SD_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(Depression, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
  ) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;print&lt;/span&gt;(width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1000&lt;/span&gt;, n &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;500&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism))

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression))

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism), color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression), color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Counts for categorical variables&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Sex) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;group_by&lt;/span&gt;(Sex) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;()) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;spread&lt;/span&gt;(key &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Sex, value &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; count)


&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_bar&lt;/span&gt;(stat &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;count&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Sex))

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;r-codes-explained---descriptive-statistics&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---descriptive-statistics&#34;&gt;R codes explained - Descriptive statistics&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The following is from the top section of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(e1071)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(ggplot2)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(GGally)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Sample size and missing data&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;(), 
  mis_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Neuroticism)), 
  mis_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Depression)), 
  mis_Sex &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Sex))
  )
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;First we load all the necessary libraries for this analysis, and then calculate the sample size and missing data in each of the variables. The above codes produce the summary below. Overall, there are 231 rows of data (&lt;strong&gt;N = 231&lt;/strong&gt;). There are &lt;strong&gt;14&lt;/strong&gt; missing data points for &lt;em&gt;Neuroticism&lt;/em&gt; and &lt;strong&gt;33&lt;/strong&gt; missing data points for &lt;em&gt;Depression&lt;/em&gt;. There is no missing data for &lt;em&gt;Sex&lt;/em&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;######################################################
[1] &amp;quot;Sample size and missing data&amp;quot;

######################################################
# A tibble: 1 x 4
  count mis_Neuroticism mis_Depression mis_Sex
  &amp;lt;int&amp;gt;           &amp;lt;int&amp;gt;          &amp;lt;int&amp;gt;   &amp;lt;int&amp;gt;
1   231              14             33       0


######################################################
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;The following code is then used to calculate the descriptive statistics for the numeric variables (&lt;em&gt;Neuroticism&lt;/em&gt; and &lt;em&gt;Depression&lt;/em&gt;).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Descriptive Statistics&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Descriptive Statistics for numeric variables&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;(),
  M_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(Neuroticism, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  M_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(Depression, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  SD_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(Neuroticism, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  SD_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(Depression, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
  ) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;print&lt;/span&gt;(width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1000&lt;/span&gt;, n &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;500&lt;/span&gt;)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;This code produces the following output. The mean of &lt;em&gt;Neuroticism&lt;/em&gt; and &lt;em&gt;Depression&lt;/em&gt; are &lt;strong&gt;87.7&lt;/strong&gt; (SD = 7.06) and &lt;strong&gt;23.1&lt;/strong&gt; (SD = 5.81) respectively.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;######################################################
[1] &amp;quot;Descriptive Statistics for numeric variables&amp;quot;

######################################################
# A tibble: 1 x 5
  count M_Neuroticism M_Depression SD_Neuroticism SD_Depression
  &amp;lt;int&amp;gt;         &amp;lt;dbl&amp;gt;        &amp;lt;dbl&amp;gt;          &amp;lt;dbl&amp;gt;         &amp;lt;dbl&amp;gt;
1   231          87.7         7.06           23.1          5.81

######################################################
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;The following code is then used to produce normality plots and histograms.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism))

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression))

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism), color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression), color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The top two plots are for &lt;em&gt;Neuroticism&lt;/em&gt; and the bottom two for &lt;em&gt;Depression&lt;/em&gt;. The left plots are normality plots. If the data is normally distributed, the points will roughly follow a straight line. The histograms on the right show the distribution of the variables. These plots show that the distribution of &lt;em&gt;Neuroticism&lt;/em&gt; is approximately normal, but &lt;em&gt;Depression&lt;/em&gt; is skewed to the right.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io//blog/analysis/img/descriptive_plots.png&#34; alt=&#34;normality plots and histogram&#34; title=&#34;normality plots and histogram&#34;/&gt;&lt;/a&gt;
&lt;p&gt;Lastly, the following codes are used to calculate the frequency count for the categorical variable &lt;em&gt;Sex&lt;/em&gt; and to generate a simple bar graph.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Counts for categorical variables&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(Sex) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;group_by&lt;/span&gt;(Sex) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;()) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;spread&lt;/span&gt;(key &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Sex, value &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; count)


&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_bar&lt;/span&gt;(stat &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;count&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Sex))

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Below is the output from &lt;strong&gt;StatsNotebook&lt;/strong&gt;. Of the 231 participants, 70 are female and 161 are male.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# A tibble: 1 x 2
  Female  Male
   &amp;lt;int&amp;gt; &amp;lt;int&amp;gt;
1     70   161
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;

&lt;h4 id=&#34;descriptive-statistics-by-group&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#descriptive-statistics-by-group&#34;&gt;Descriptive statistics by group&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In this example, we will generate the descriptive statistics of &lt;em&gt;Neuroticism&lt;/em&gt; and &lt;em&gt;Depression&lt;/em&gt; by &lt;em&gt;Sex&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;To do this, we can&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Explore&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Descriptive statistics&lt;/strong&gt; on the menu&lt;/li&gt;
&lt;li&gt;Select variables into &lt;strong&gt;Target Variables&lt;/strong&gt; on the right. In this example, we will select &lt;em&gt;Neuroticism&lt;/em&gt; and &lt;em&gt;Depression&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Select the grouping variable (&lt;em&gt;Sex&lt;/em&gt;) into &lt;strong&gt;Split by&lt;/strong&gt; box on the right.
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Sex&lt;/strong&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, we will need to manually &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable conversion&#34;&gt;convert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expand the &lt;strong&gt;Statistics and plots&lt;/strong&gt; panel, by default, &lt;strong&gt;mean&lt;/strong&gt; and &lt;strong&gt;standard deviation&lt;/strong&gt; are calculated for numeric variables (&lt;em&gt;Neuroticism&lt;/em&gt; and &lt;em&gt;Depression&lt;/em&gt;). Additional statistics, such as &lt;strong&gt;median&lt;/strong&gt; and &lt;strong&gt;interquartile range&lt;/strong&gt; can be requested here.&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;r-codes---descriptive-statistics-by-group&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes---descriptive-statistics-by-group&#34;&gt;R codes - Descriptive statistics by group&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;This code is very similar to those above, except now we have specified that the analysis split by group (&lt;em&gt;Sex&lt;/em&gt;).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(e1071)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(ggplot2)
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(GGally)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Sample size and missing data&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;(), 
  mis_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Neuroticism)), 
  mis_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Depression)), 
  mis_Sex &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;is.na&lt;/span&gt;(Sex))
  )

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Descriptive Statistics for numeric variables&amp;#34;&lt;/span&gt;

currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;group_by&lt;/span&gt;(Sex) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;summarize&lt;/span&gt;(count &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;n&lt;/span&gt;(),
  M_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(Neuroticism, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  M_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;mean&lt;/span&gt;(Depression, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  SD_Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(Neuroticism, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;),
  SD_Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;sd&lt;/span&gt;(Depression, na.rm &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
  ) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt; 
  &lt;span style=&#34;color:#06287e&#34;&gt;print&lt;/span&gt;(width &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;1000&lt;/span&gt;, n &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;500&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt;Sex)

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt;Sex)

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism), color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt;Sex)

&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(currentDataset) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_histogram&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(x&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression), color &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;white&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt;Sex)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The output from &lt;strong&gt;StatsNotebook&lt;/strong&gt; are very similar to what we have before but is now stratified by &lt;em&gt;Sex&lt;/em&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;######################################################
# A tibble: 2 x 6
  Sex    count M_Neuroticism M_Depression SD_Neuroticism SD_Depression
  &amp;lt;fct&amp;gt;  &amp;lt;int&amp;gt;         &amp;lt;dbl&amp;gt;        &amp;lt;dbl&amp;gt;          &amp;lt;dbl&amp;gt;         &amp;lt;dbl&amp;gt;
1 Female    70          96.2         8.74           23.0          5.87
2 Male     161          83.8         6.16           22.2          5.60

######################################################
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Set reference for categorical variables</title>
      <link>https://statsnotebook.io/blog/data_management/set_reference/</link>
      <pubDate>Sun, 20 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/data_management/set_reference/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;For categorical variable, it is important to set a &amp;ldquo;reference&amp;rdquo; category in many analyses. For example, for the variable &lt;em&gt;Sex&lt;/em&gt; in our &lt;a href=&#34;../../analysis/regression&#34;&gt;regression analysis tutorial&lt;/a&gt;, the default reference is &lt;em&gt;Female&lt;/em&gt;. The coefficient of &lt;em&gt;SexMale&lt;/em&gt; from the regression represents the effect of &lt;em&gt;male&lt;/em&gt; relative to &lt;em&gt;female&lt;/em&gt;. In this case, the coefficient &lt;strong&gt;-0.87&lt;/strong&gt; means that the &lt;em&gt;depression&lt;/em&gt; score (the dependent variable in that analysis) for male is 0.87 lower than female.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Coefficients:
                  Estimate Std. Error t value Pr(&amp;gt;|t|)    
(Intercept)        7.98352    3.57490   2.233   0.0270 *  
Agreeableness     -0.01498    0.02859  -0.524   0.6011    
Conscientiousness -0.01702    0.02231  -0.763   0.4467    
Extraversion      -0.02104    0.01839  -1.144   0.2546    
Neuroticism        0.14296    0.01891   7.559 3.94e-12 ***
Openness          -0.05455    0.02454  -2.222   0.0278 *  
SexMale           -0.87264    0.88739  -0.983   0.3270    
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;

&lt;h4 id=&#34;set-reference-category&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#set-reference-category&#34;&gt;Set reference category&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Changing reference category is easy. It takes only one line of code in R. Alternatively, we can set the reference with a few clicks in &lt;strong&gt;StatsNotebook&lt;/strong&gt;.&lt;/p&gt;

&lt;h5 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;relevel&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex, ref&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Male&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;using-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Data&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Reference&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;In the column &lt;strong&gt;Update Reference Level&lt;/strong&gt;, we can now set the reference category for any categorical variable.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/set_reference.png&#34; alt=&#34;Set reference category&#34; title=&#34;Set reference category&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Variable types in R and StatsNotebook</title>
      <link>https://statsnotebook.io/blog/data_management/variable_conversion/</link>
      <pubDate>Sun, 20 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/data_management/variable_conversion/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;There are four major variable types in StatsNotebook: &lt;strong&gt;Categorical&lt;/strong&gt;, &lt;strong&gt;Numeric&lt;/strong&gt;, &lt;strong&gt;Date&lt;/strong&gt; and &lt;strong&gt;Character&lt;/strong&gt;. By default, when data is loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt;, the variables are either &lt;strong&gt;Numeric&lt;/strong&gt; or &lt;strong&gt;Character&lt;/strong&gt; variables.&lt;/p&gt;

&lt;h5 id=&#34;categorical-variables&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#categorical-variables&#34;&gt;Categorical variables&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Categorical variables are variables that have two or more categories. For example, &lt;em&gt;sex&lt;/em&gt; is a categorical variable that we can code into &lt;em&gt;male&lt;/em&gt; and &lt;em&gt;female&lt;/em&gt;. Another exapmle is &lt;em&gt;color&lt;/em&gt;, which we can code into &lt;em&gt;Yellow&lt;/em&gt;, &lt;em&gt;Red&lt;/em&gt;, &lt;em&gt;Orange&lt;/em&gt;, etc. For many analyses, we will also need to &lt;a href=&#34;../set_reference&#34; title=&#34;Set reference category&#34;&gt;specify the reference category&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In R, we will need to specify categorical variables as &lt;strong&gt;factor&lt;/strong&gt; variables.&lt;/p&gt;

&lt;h5 id=&#34;numeric-variables&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#numeric-variables&#34;&gt;Numeric variables&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Numeric variables are variables that measured in number. Examples are &lt;em&gt;height&lt;/em&gt; and &lt;em&gt;weight&lt;/em&gt;.&lt;/p&gt;

&lt;h5 id=&#34;date-variables&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#date-variables&#34;&gt;Date variables&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Date is a variation of numeric variable that is used for Time Series analysis.&lt;/p&gt;

&lt;h5 id=&#34;character-variables&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#character-variables&#34;&gt;Character variables&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Chracter variables contain character string. &lt;em&gt;Address&lt;/em&gt; and &lt;em&gt;Name&lt;/em&gt; are examples of character variable. These variables contains textual information and are not normally used for statistical analysis. By default, &lt;strong&gt;Categorical&lt;/strong&gt; variable such as &lt;em&gt;Sex&lt;/em&gt; (Male/ Female) will be coded as &lt;strong&gt;Character&lt;/strong&gt; variable and we will need to convert them into &lt;strong&gt;Categorical&lt;/strong&gt; variable manually.&lt;/p&gt;

&lt;h4 id=&#34;converting-variable-type&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#converting-variable-type&#34;&gt;Converting variable type&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;To change the type of a variable, we can&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Data&lt;/strong&gt; on the top&lt;/li&gt;
&lt;li&gt;Click the &lt;span style=&#34;color: orange&#34;&gt;&lt;b&gt;orange&lt;/b&gt;&lt;/span&gt; icon next to a variable&amp;rsquo;s name.&lt;/li&gt;
&lt;li&gt;Select the variable type that we need.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;../img/variable_conversion.png&#34; alt=&#34;Variable Type Conversion&#34; title=&#34;Converting variable type.&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;r-code-converting-character-into-factor&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-code-converting-character-into-factor&#34;&gt;R code (Converting Character into Factor)&lt;/a&gt;&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;factor&lt;/span&gt;(currentDataset&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex, exclude &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;NA&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Violin plot</title>
      <link>https://statsnotebook.io/blog/dataviz/violinplot/</link>
      <pubDate>Sun, 20 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/dataviz/violinplot/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Violin plot can be used to visualise the distribution of a numeric variable across several groups. &lt;strong&gt;StatsNotebook&lt;/strong&gt; uses &lt;code&gt;geom_violin()&lt;/code&gt; from &lt;code&gt;ggplot2&lt;/code&gt; to build violin plot.&lt;/p&gt;
&lt;p&gt;We use the built-in &lt;strong&gt;alcohol&lt;/strong&gt; dataset in this example. This dataset can be loaded into &lt;strong&gt;StatsNotebook&lt;/strong&gt; using instruction &lt;a href=&#34;../../data_management/load_example_data&#34;&gt;here&lt;/a&gt;. This is a simulated data of alcohol consumption from 3666 individuals.&lt;/p&gt;
&lt;p&gt;This dataset can also be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/alcohol.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We will use the following three variables from this dataset&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;alcohol - Number of standard drinks consumed in a month&lt;/li&gt;
&lt;li&gt;Remoteness - Capital city or regional area&lt;/li&gt;
&lt;li&gt;State - Seven states/territories in Australia: Queensland, New South Wales, Northern Territory, South Australia, Tasmania, Victoria and Western Australia.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this example, we will build&lt;/p&gt;
&lt;div style=&#34;display: flex; flex-wrap: wrap; padding: 0px&#34;&gt; 
    &lt;div&gt;
        &lt;a href=&#34;#violinplot-by-one-grouping-variable&#34;&gt;Violin plot (1 grouping variable)&lt;/a&gt;
        &lt;a href=&#34;#violinplot-by-one-grouping-variable&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/violinplot_by_1group.png&#34; alt=&#34;Boxplot by one group&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#violinplot-by-two-grouping-variables&#34;&gt;Violin plot (2 grouping variables)&lt;/a&gt;
        &lt;a href=&#34;#violinplot-by-two-grouping-variables&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/violinplot_by_2groups.png&#34; alt=&#34;Boxplot by two groups&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;a href=&#34;#multiple-violin-plots&#34;&gt;Multiple violin plots&lt;/a&gt;
        &lt;a href=&#34;#multiple-violin-plots&#34;&gt;&lt;img style=&#34;min-width: 100px; max-width: 250px; align: left&#34; src=&#34;../img/multiple_violinplot_by_facet.png&#34; alt=&#34;Multiple boxplots by facets&#34;&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;a violin plot comparing distributions by one grouping variable&lt;/li&gt;
&lt;li&gt;a violin plot comparing distributions by two grouping variables&lt;/li&gt;
&lt;li&gt;multiple violin plots in different facets&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&#34;violin-plot-by-one-grouping-variable&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#violin-plot-by-one-grouping-variable&#34;&gt;Violin plot by one grouping variable&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a violin plot for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;State&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Boxplot/ Violin plot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Boxplot/ violin plot&lt;/strong&gt; panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Vertical axis&lt;/em&gt; and select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal aixs&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expand &lt;strong&gt;Boxplot/ Violin plot Setting&lt;/strong&gt; panel, check &lt;strong&gt;Violin plot&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_violin&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/violinplot_by_1group.png&#34; alt=&#34;Violin plot by a grouping variable&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;violin-plot-by-two-grouping-variables&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#violin-plot-by-two-grouping-variables&#34;&gt;Violin plot by two grouping variables&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build a violin plot for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by two grouping variables (e.g. &lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Boxplot/ Violin plot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;boxplot/ violin plot&lt;/strong&gt; panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Vertical axis&lt;/em&gt;, select &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal aixs&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Split by Fill color&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;State&lt;/em&gt; and &lt;em&gt;Year&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expand &lt;strong&gt;Boxplot/ Violin plot Setting&lt;/strong&gt; panel, check &lt;strong&gt;Violin plot&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State, Year) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_violin&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-1&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-1&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/violinplot_by_2groups.png&#34; alt=&#34;Violin plot by two grouping variables&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;multiple-violin-plots&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#multiple-violin-plots&#34;&gt;Multiple violin plots&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;To build multiple violin plot for a single numeric variable (e.g. &lt;em&gt;alcohol&lt;/em&gt;) by groups (e.g. &lt;em&gt;States&lt;/em&gt; abd &lt;em&gt;Year&lt;/em&gt;) in multiple facets (by another variable, e.g. &lt;em&gt;Remoteness&lt;/em&gt;),&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;DataViz&lt;/strong&gt; at the top&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Numeric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Boxplot/ Violin plot&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Boxplot/ violin plot&lt;/strong&gt; panel, select &lt;em&gt;alcohol&lt;/em&gt; to &lt;em&gt;Vertical axis&lt;/em&gt;, &lt;em&gt;State&lt;/em&gt; to &lt;em&gt;Horizontal axis&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; to &lt;em&gt;Split by: Fill Color&lt;/em&gt; and &lt;em&gt;Remoteness&lt;/em&gt; to &lt;em&gt;Facet&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Remoteness&lt;/em&gt;, &lt;em&gt;Year&lt;/em&gt; and &lt;em&gt;State&lt;/em&gt; are categorical variables. If they are not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, you will need to manually &lt;a href=&#34;../data_management/variable_conversion&#34;&gt;covert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Expand &lt;strong&gt;Boxplot/ Violin plot Setting&lt;/strong&gt; panel, check &lt;strong&gt;Violin plot&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;currentDataset &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;drop_na&lt;/span&gt;(State, Year, Remoteness) &lt;span style=&#34;color:#666&#34;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; alcohol, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; State, fill &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; Year)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_violin&lt;/span&gt;(alpha &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.6&lt;/span&gt;, na.rm&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_fill_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;scale_color_brewer&lt;/span&gt;(palette &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Set2&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;facet_wrap&lt;/span&gt;( &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Remoteness)&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
    &lt;span style=&#34;color:#06287e&#34;&gt;theme&lt;/span&gt;(legend.position &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h5 id=&#34;output-from-the-above-r-codes-2&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#output-from-the-above-r-codes-2&#34;&gt;Output from the above R codes&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;img src=&#34;../img/multiple_violinplot_by_facet.png&#34; alt=&#34;Multiple violin plot plots by facet&#34;&gt;&lt;/p&gt;

&lt;h5 id=&#34;citation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citation&#34;&gt;Citation&lt;/a&gt;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. [Computer Software]. Retrieved from https://www.statsnotebook.io
R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org
Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Linear Regression</title>
      <link>https://statsnotebook.io/blog/analysis/regression/</link>
      <pubDate>Fri, 18 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/regression/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;Linear regression is a technique for examining the relationship between a &lt;em&gt;dependent variable&lt;/em&gt; (&lt;em&gt;outcome&lt;/em&gt;) and a set of &lt;em&gt;independent variables&lt;/em&gt; (&lt;em&gt;predictors&lt;/em&gt;). This tutorial demonstrates how to conduct a linear regression in &lt;strong&gt;StatsNotebook&lt;/strong&gt; using the following example. We will also provide an example write-up in APA style.&lt;/p&gt;

&lt;h4 id=&#34;example-research-questions&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#example-research-questions&#34;&gt;Example research questions&lt;/a&gt;&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Are the Big 5 personality traits, Agreeableness, Conscientiousness, Extraversion, Neuroticism, and Openness, associated with depression?&lt;/li&gt;
&lt;li&gt;Is sex associated with depression? (i.e. Are there sex differences in depression?)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this setup, the &lt;em&gt;dependent&lt;/em&gt; variable is depression; the &lt;em&gt;independent&lt;/em&gt; variables are Agreeableness, Conscientiousness, Extraversion, Neuroticism, Openness and sex. The above two research questions will be addressed by &lt;strong&gt;linear regression&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;We will first show the R code for this analysis below, and we will provide a step-by-step guide on how to complete this analysis. We use the &lt;strong&gt;Personality&lt;/strong&gt;, which can be loaded using the following codes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/personality.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h4 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The following is the compete codes for our linear regression and multiple imputation example.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))

&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(car)

res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rstandard&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .01 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Residual plots, curvature tests and normality plot&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;residualPlots&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Variance inflation factor (VIF &amp;gt;=5 indicates high level of multicollinearity)&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;vif&lt;/span&gt;(res)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;



&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h4 id=&#34;using-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Prior to running the linear regression analysis, it is always a good practice to &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;DataViz&#34;&gt;visualise the data&lt;/a&gt; and conduct a &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/&#34; title=&#34;descriptive statistics&#34;&gt;descriptive analysis&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To run a linear regression,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear Regression (Numeric outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;Depression&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, and select &lt;em&gt;Agreeableness&lt;/em&gt;, &lt;em&gt;Conscientiousness&lt;/em&gt;, &lt;em&gt;Extraversion&lt;/em&gt;, &lt;em&gt;Neuroticism&lt;/em&gt;, &lt;em&gt;Openness&lt;/em&gt; and &lt;em&gt;Sex&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Sex&lt;/strong&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, we will need to manually &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;convert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Female is chosen as the &lt;strong&gt;reference&lt;/strong&gt; level for sex by default. To change the reference level, see &lt;a href=&#34;https://statsnotebook.io/blog/data_management/set_reference/&#34; title=&#34;set reference&#34;&gt;setting reference level for categorical variable&lt;/a&gt; for step-by-step guide..&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Code and Run&lt;/strong&gt; at top. The above R code will be generated in a block on the right panel and the results will be presented below the R codes.&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/regression1.png&#34; alt=&#34;regression in statsnotebook&#34; title=&#34;regression in statsnotebook&#34;/&gt;&lt;/a&gt;

&lt;h4 id=&#34;r-codes-explained---regression-analysis&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---regression-analysis&#34;&gt;R codes explained - Regression analysis&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The following is from the top section of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex,
  data&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;currentDataset)
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;cbind&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;coef&lt;/span&gt;(res), &lt;span style=&#34;color:#06287e&#34;&gt;confint&lt;/span&gt;(res, level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;This code tells R to run a linear regression using the &lt;strong&gt;lm&lt;/strong&gt; function. The left side of the &lt;strong&gt;&amp;ldquo;~&amp;rdquo;&lt;/strong&gt; symbol specifies the &lt;em&gt;dependent variable&lt;/em&gt;; the right side specifies the &lt;em&gt;independent variables&lt;/em&gt;. The results from this regression analysis is then printed out using the &lt;strong&gt;summary&lt;/strong&gt; function. Lastly, the &lt;strong&gt;cbind&lt;/strong&gt;, &lt;strong&gt;coef&lt;/strong&gt; and &lt;strong&gt;confint&lt;/strong&gt; functions are used to print the model coefficients with the corresponding 95% confidence intervals.&lt;/p&gt;
&lt;p&gt;This code produces the model summary below.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;######################################################

Call:
lm(formula = Depression ~ Agreeableness + Conscientiousness + 
    Extraversion + Neuroticism + Openness + Sex, data = currentDataset)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.3954  -3.5621  -0.5515   2.1011  18.2826 

Coefficients:
                  Estimate Std. Error t value Pr(&amp;gt;|t|)    
(Intercept)        7.98352    3.57490   2.233   0.0270 *  
Agreeableness     -0.01498    0.02859  -0.524   0.6011    
Conscientiousness -0.01702    0.02231  -0.763   0.4467    
Extraversion      -0.02104    0.01839  -1.144   0.2546    
Neuroticism        0.14296    0.01891   7.559 3.94e-12 ***
Openness          -0.05455    0.02454  -2.222   0.0278 *  
SexMale           -0.87264    0.88739  -0.983   0.3270    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 5.091 on 148 degrees of freedom
  (76 observations deleted due to missingness)
Multiple R-squared:  0.3319,	Adjusted R-squared:  0.3048 
F-statistic: 12.26 on 6 and 148 DF,  p-value: 3.608e-11


######################################################
                                    2.5 %       97.5 %
(Intercept)        7.98352411  0.91909104 15.047957174
Agreeableness     -0.01497977 -0.07148527  0.041525721
Conscientiousness -0.01701989 -0.06110049  0.027060703
Extraversion      -0.02103749 -0.05738767  0.015312701
Neuroticism        0.14295833  0.10558358  0.180333083
Openness          -0.05454570 -0.10304908 -0.006042319
SexMale           -0.87264011 -2.62623258  0.880952360

######################################################

&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;

&lt;h5 id=&#34;interpretation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation&#34;&gt;Interpretation&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The R-sq indicates that the model explains 33.19% of the variance in depression. It should be noted that 76 observations have missing data and thus have been removed from the analysis. See &lt;a href=&#34;https://statsnotebook.io/blog/analysis/regression_missingdata/&#34; title=&#34;Linear regression with missing data&#34;&gt;Regression with missing data&lt;/a&gt; for a more appropriate way to handle the missing data in this analysis.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Residual standard error: 5.091 on 148 degrees of freedom
  (76 observations deleted due to missingness)
Multiple R-squared:  0.3319,	Adjusted R-squared:  0.3048 
F-statistic: 12.26 on 6 and 148 DF,  p-value: 3.608e-11
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;The model coefficients are shown in the section below.&lt;/p&gt;
&lt;p&gt;The p-value provides an indication of the level of evidence against a null effect (i.e. zero association) for each of the variables. Traditionally, a p-value under 0.05 represents a statistically significant finding. It should be noted that there is debate on how the p-value should be used, and conclusion should &lt;strong&gt;not&lt;/strong&gt; be drawn solely on the reliance on on the p-value.&lt;/p&gt;
&lt;p&gt;There is evidence that a higher level of neuroticism is associated with a higher level of depression. The coefficient of neuroticism is 0.14, indicating that one unit increase in neuroticism is associated with 0.14 unit decrease in depression. The result also shows that a higher level of openness is associated with a lower level of depression. The coefficient of openness is -0.05, indicating that a one unit increase in openness is associated with 0.05 unit decrease in depression.  The other three traits, agreeableness, conscientiousness and extraversion are not significantly associated with depression. The estimated coefficients are very close to zero.&lt;/p&gt;
&lt;p&gt;Using a significance level of 0.05, we conclude that openness and neuroticism are significantly associated with depression, but agreeableness, conscientiousness and extraversion are not. Depression for males on average is 0.87 unit lower than females, but the effect is not statistically significant.&lt;/p&gt;
&lt;br/&gt;
&lt;pre&gt;&lt;code&gt;Coefficients:
                  Estimate Std. Error t value Pr(&amp;gt;|t|)    
(Intercept)        7.98352    3.57490   2.233   0.0270 *  
Agreeableness     -0.01498    0.02859  -0.524   0.6011    
Conscientiousness -0.01702    0.02231  -0.763   0.4467    
Extraversion      -0.02104    0.01839  -1.144   0.2546    
Neuroticism        0.14296    0.01891   7.559 3.94e-12 ***
Openness          -0.05455    0.02454  -2.222   0.0278 *  
SexMale           -0.87264    0.88739  -0.983   0.3270    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;Emphasis should be placed on the 95% confidence interval of these coefficients because statistical significance provides no information about the effect size. From this analysis, we are 95% confident that the effect of neuroticism on depression is between 0.11 and 0.18. The 95% confidence interval for openness is (-0.103, -0.006). Thus the effect of openness could be close to zero because one end of the confidence interval (the upper end in this case) is very close to zero.&lt;/p&gt;
&lt;br/&gt;
&lt;pre&gt;&lt;code&gt;                                    2.5 %       97.5 %
(Intercept)        7.98352411  0.91909104 15.047957174
Agreeableness     -0.01497977 -0.07148527  0.041525721
Conscientiousness -0.01701989 -0.06110049  0.027060703
Extraversion      -0.02103749 -0.05738767  0.015312701
Neuroticism        0.14295833  0.10558358  0.180333083
Openness          -0.05454570 -0.10304908 -0.006042319
SexMale           -0.87264011 -2.62623258  0.880952360
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;

&lt;h4 id=&#34;r-codes-explained---model-diagnostic&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---model-diagnostic&#34;&gt;R codes explained - Model diagnostic&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;To evaluate the validity of the above results, we will need to check if the assumptions of linear regression are satisfied. There are four key assumptions of linear regression.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Linearity&lt;/li&gt;
&lt;li&gt;Homoscedasticity (constant variance of the residuals)&lt;/li&gt;
&lt;li&gt;Normality (residuals are normally distributed)&lt;/li&gt;
&lt;li&gt;Independence of observations&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;strong&gt;independence&lt;/strong&gt; assumption can be ensured if the sample is a random sample. When there is dependency in the data, other statistical methods, such as &lt;a href=&#34;https://statsnotebook.io/blog/analysis/linear_mixed_model/&#34; title=&#34;Linear mixed model (Multilevel model)&#34;&gt;Linear mixed model&lt;/a&gt;, can be used.&lt;/p&gt;
&lt;p&gt;In addition, we also need to check for multicollinearity, outliers and/or influential observations (i.e. observations that may have a large impact on the model coefficients).&lt;/p&gt;
&lt;p&gt;To check the other three assumptions (i.e. Linearity, homoscedasticity and normality) and perform model diagnostic, we will need to use several functions from the &lt;strong&gt;car&lt;/strong&gt; library. To load this library, we use the following code.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(car)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;The following two lines of codes are used to generate a residual plot.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rstandard&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;All the points should be randomly scattered around 0, with approximately 95% of the points falling between -2 and 2 standardized residuals. Points with a large standardized residual may be outliers.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/residual.png&#34; alt=&#34;residual plot&#34; title=&#34;residual plot&#34;/&gt;&lt;/a&gt;
&lt;p&gt;The following lines of codes allow us to examine if there are outliers and if there are any observations that might have a large influence on the model estimates.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .01 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;This code first produces results from an outlier test. While there is no clear guideline on the cut-off, observations with a Bonferroni corrected p-value &amp;lt; .01 may need further investigation. For example, these observations will need to be checked for errors. Researchers can also perform sensitivity analyses by removing the outliers and comparing the results from the full analysis with their inclusion.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;######################################################
[1] &amp;quot;Outlier Test. Observations with a Bonferroni p &amp;lt; .01 might be considered as outliers and might need further investigation.&amp;quot;

######################################################
   rstudent unadjusted p-value Bonferroni p
76 3.824964         0.00019277     0.029879
66 3.722572         0.00028023     0.043436

######################################################
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;The following plot is produced by the &lt;strong&gt;infIndexPlot&lt;/strong&gt; function. We can focus on the top panel on &lt;strong&gt;Cook&amp;rsquo;s distance&lt;/strong&gt;. Observations with a &lt;strong&gt;Cook&amp;rsquo;s distance&lt;/strong&gt; close to 1 indicates a high impact on the model coefficients. There is no influence observation in this analysis despite the existence of two observations with large residuals.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/diagnosticplot.png&#34; alt=&#34;diagnostic plot&#34; title=&#34;diagnostic plot&#34;/&gt;&lt;/a&gt;
&lt;p&gt;The following code is used to produce more diagnostic plots and a normality plot.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Residual plots, curvature tests and normality plot&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;residualPlots&lt;/span&gt;(res)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Below is a set of diagnostic plots.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/diagnostic2.png&#34; alt=&#34;a set of diagnostic plots&#34; title=&#34;a set of diagnostic plots&#34;/&gt;&lt;/a&gt;
&lt;p&gt;The residuals are plotted against each of the independent variables and the fitted values. Ideally, points on these plots need to be randomly scattered around 0. Any non-linear pattern (e.g. curvature) in the residual plots indicate that the linearity assumption is violated. A fanning in or fanning out pattern indicates the homoscedasticity assumption is violated. See &lt;a href=&#34;https://statsnotebook.io/blog/analysis/linearity_homoscedasticity/&#34; title=&#34;Residual plots and assumption checking for linear regression&#34;&gt;Residual plots and assumption checking&lt;/a&gt; for examples of plots that demonstrate a violation of the linearity assumption and the homoscedasticity assumption.&lt;/p&gt;
&lt;p&gt;The following are the results from curvature tests for each of the variables. A quadratic term is added to each of the plots and a curvature test tests if the quadratic term is zero. A test with a p-value &amp;lt; .01 may indicate the presence of a non-linear trend (U-shape or inverted U-shape).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;                  Test stat Pr(&amp;gt;|Test stat|)  
Agreeableness       -1.0679          0.28730  
Conscientiousness   -0.0964          0.92332  
Extraversion         1.5893          0.11414  
Neuroticism          1.8781          0.06235 .
Openness             0.7340          0.46410  
Sex                                           
Tukey test           1.7834          0.07452 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;
&lt;p&gt;Below is a normality plot. If the residual is normally distributed, the points need to follow a straight line. In this case, there is evidence that the normality assumption is violated. When the normality assumption is violated, we can try a &lt;a href=&#34;https://statsnotebook.io/blog/data_management/compute_variable/&#34; title=&#34;log transformation&#34;&gt;log-transformation&lt;/a&gt; of the dependent variable or use other analytic methods such as &lt;a href=&#34;https://statsnotebook.io/blog/analysis/robust_regression/&#34; title=&#34;Robust regression&#34;&gt;robust regression&lt;/a&gt; to evaluate whether the violation has a substantial impact on the model estimates.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/normality.png&#34; alt=&#34;normality plot&#34; title=&#34;normality plot&#34;/&gt;&lt;/a&gt;
&lt;p&gt;Lastly, the following codes compute the &lt;strong&gt;Variance Inflation Factor&lt;/strong&gt; (VIF).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Variance inflation factor (VIF &amp;gt;=5 indicates high level of multicollinearity)&amp;quot;
vif(res)
&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt; 
&lt;p&gt;A VIF over 5 indicates a high level of multicollinearity. In this analysis, multicollinearity is not a concern as all the VIFs are small.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    Agreeableness Conscientiousness      Extraversion       Neuroticism 
         1.726463          1.467871          1.466692          1.176284 
         Openness               Sex 
         1.535307          1.117182 

&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;

&lt;h4 id=&#34;example-write-up-apa-style&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#example-write-up-apa-style&#34;&gt;Example write-up (APA style)&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Table 1. Results from linear regression.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Variables&lt;/th&gt;
&lt;th&gt;b&lt;/th&gt;
&lt;th&gt;95% CI&lt;/th&gt;
&lt;th&gt;p&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Agreeableness&lt;/td&gt;
&lt;td&gt;-0.01&lt;/td&gt;
&lt;td&gt;(-0.07, 0.04)&lt;/td&gt;
&lt;td&gt;0.601&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Conscientiousness&lt;/td&gt;
&lt;td&gt;-0.02&lt;/td&gt;
&lt;td&gt;(-0.06, 0.03)&lt;/td&gt;
&lt;td&gt;0.447&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Extraversion&lt;/td&gt;
&lt;td&gt;-0.02&lt;/td&gt;
&lt;td&gt;(-0.06, 0.01)&lt;/td&gt;
&lt;td&gt;0.255&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Neuroticism&lt;/td&gt;
&lt;td&gt;0.14&lt;/td&gt;
&lt;td&gt;(0.11, 0.18)&lt;/td&gt;
&lt;td&gt;&amp;lt; .001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Openness&lt;/td&gt;
&lt;td&gt;-0.05&lt;/td&gt;
&lt;td&gt;(-0.10, -0.01)&lt;/td&gt;
&lt;td&gt;.028&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Sex (Ref: Female)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;  Male&lt;/td&gt;
&lt;td&gt;-0.87&lt;/td&gt;
&lt;td&gt;(-2.62, 0.88)&lt;/td&gt;
&lt;td&gt;0.327&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Linear regression is used to examine the association between depression and agreeableness, conscientiousness, extraversion, neuroticism, openness and sex. Results are shown in Table 1. Using a significance level of 0.05, results indicate that higher neuroticism (&lt;em&gt;b&lt;/em&gt; = 0.14, 95% CI [0.11, 0.18], &lt;em&gt;p&lt;/em&gt; &amp;lt; .001) and lower openness (&lt;em&gt;b&lt;/em&gt; = -0.05, 95% CI [-0.10, -0.01], &lt;em&gt;p&lt;/em&gt; = .028) are associated with depression. Other variables were not significantly associated with depression, and their effects are close to zero. Overall, the model explains 33.19% of the variance in depression. Analyses were conducted in StatsNotebook (Chan and StatsNotebook Team, 2020) with R (R Core Team, 2020).&lt;/p&gt;

&lt;h4 id=&#34;citation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citation&#34;&gt;Citation&lt;/a&gt;&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. [Computer Software]. Retrieved from https://www.statsnotebook.io
Chan, G (2020). Linear regression. Retrieved from https://www.statsnotebook.io/blog/analysis/regression/
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Linear regression with missing data</title>
      <link>https://statsnotebook.io/blog/analysis/regression_missingdata/</link>
      <pubDate>Fri, 18 Sep 2020 00:00:00 +0000</pubDate>
      
      <guid>https://statsnotebook.io/blog/analysis/regression_missingdata/</guid>
      <description>&lt;p&gt;The tutorial is based on &lt;a href=&#34;https://r-project.org&#34; title=&#34;The R project for statistical computing&#34;&gt;R&lt;/a&gt; and &lt;a href=&#34;https://statsnotebook.io&#34; title=&#34;StatsNotebook&#34;&gt;StatsNotebook&lt;/a&gt;, a graphical interface for R.&lt;/p&gt;
&lt;p&gt;In many area of research, missing data is a norm rather than an exception. Dropping observations/ participants with missing data is usually not appropriate as it reduces statistical power and also may introduce bias in analysis. This tutorial will demonstrate a simple way in &lt;strong&gt;StatsNotebook&lt;/strong&gt; to handle missing data using &lt;a href=&#34;https://statsnotebook.io/blog/analysis/multiple_imputation/&#34; title=&#34;Multiple imputation for missing data&#34;&gt;multiple imputation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In our &lt;a href=&#34;https://statsnotebook.io/blog/analysis/regression/&#34; title=&#34;Linear regression&#34;&gt;linear regression tutorial&lt;/a&gt;, we use the personality dataset to examine two research qeustions.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Are the Big 5 personality traits, Agreeableness, Conscientiousness, Extraversion, Neuroticism, and Openness, associated with depression?&lt;/li&gt;
&lt;li&gt;Is sex associated with depression?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In our original analysis, participants with missing data in any of the analysis variables are excluded. The initial sample size is 231. After excluding participants with missing data, the sample size reduces to 155 - a reduction of 33%.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://statsnotebook.io/blog/analysis/multiple_imputation/&#34; title=&#34;Multiple imputation for missing data&#34;&gt;Multiple imputation&lt;/a&gt; is a widely used method to handle missing data. This can generally increase power and reduce bias due to missingness. &lt;strong&gt;StatsNotebook&lt;/strong&gt; provides a simple interface to incorporate multiple imputation into linear regression analysis.&lt;/p&gt;
&lt;p&gt;This tutorial builds on our tutorial on &lt;a href=&#34;https://statsnotebook.io/blog/analysis/regression/&#34; title=&#34;Linear regression&#34;&gt;linear regression&lt;/a&gt;, and re-examine the above two research questions using multiple imputation and linear regression. We firstly show the R codes for this analysis, and will provide a step-by-step guide on how to complete this analysis. We use the &lt;strong&gt;Personality&lt;/strong&gt; dataset in this example, which can be loaded into using the following codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(tidyverse)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;read_csv&lt;/span&gt;(&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;https://statsnotebook.io/blog/data_management/example_data/personality.csv&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Two variables, &lt;strong&gt;.imp&lt;/strong&gt; and &lt;strong&gt;.id&lt;/strong&gt; will be added to the dataset on successful imputation. The &lt;strong&gt;.imp&lt;/strong&gt; is the imputation number, and zero indicates the original dataset. The &lt;strong&gt;.id&lt;/strong&gt; is a unique identifier for each observation in the dataset.&lt;/p&gt;

&lt;h4 id=&#34;r-codes&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes&#34;&gt;R codes&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The following is the compete codes for our linear regression example.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Impute missing data&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(mice)

formulas &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.formulas&lt;/span&gt;(currentDataset)

formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Agreeableness &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Agreeableness &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Extraversion &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Extraversion &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Openness &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Openness &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Sex &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex

meth &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.method&lt;/span&gt;(currentDataset)
meth[&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Trait_anxiety&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
meth[&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;State_anxiety&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;

imputedDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;parlmice&lt;/span&gt;(currentDataset,
  method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; meth,
  formulas &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; formulas,
  m &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;35&lt;/span&gt;,
  n.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;15&lt;/span&gt;, 
  n.imp.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(imputedDataset)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;complete&lt;/span&gt;(imputedDataset, action &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;long&amp;#34;&lt;/span&gt;, include &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;with&lt;/span&gt;(imputedDataset,
  &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex))
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;pool&lt;/span&gt;(res), conf.int &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, conf.level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)

res1 &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; res&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;analyses[[1]]
&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(car)

res.std &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;rstandard&lt;/span&gt;(res1)
&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(res.std, ylab&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Standardized Residuals&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Outlier Test. Observations with a Bonferroni p &amp;lt; .05 might be considered as outliers and might need further investigation.&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;outlierTest&lt;/span&gt;(res1)
&lt;span style=&#34;color:#06287e&#34;&gt;infIndexPlot&lt;/span&gt;(res1)

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Residual plots, curvature tests and normality plot&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;residualPlots&lt;/span&gt;(res1)
&lt;span style=&#34;color:#06287e&#34;&gt;ggplot&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;as.data.frame&lt;/span&gt;(res.std), &lt;span style=&#34;color:#06287e&#34;&gt;aes&lt;/span&gt;(sample &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; res.std)) &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq&lt;/span&gt;() &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;
  &lt;span style=&#34;color:#06287e&#34;&gt;geom_qq_line&lt;/span&gt;()

&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Variance inflation factor (VIF &amp;gt;=5 indicates high level of multicollinearity)&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#06287e&#34;&gt;vif&lt;/span&gt;(res1)


&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Chan, G. and StatsNotebook Team (2020). StatsNotebook. (Version 0.1.0) [Computer Software]. Retrieved from https://www.statsnotebook.io&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org&amp;#34;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;

&lt;h4 id=&#34;using-statsnotebook&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#using-statsnotebook&#34;&gt;Using StatsNotebook&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Prior to running the linear regression analysis, it is always a good practice to &lt;a href=&#34;https://statsnotebook.io/blog/dataviz/&#34; title=&#34;DataViz&#34;&gt;visualise the data&lt;/a&gt; and conduct &lt;a href=&#34;https://statsnotebook.io/blog/analysis/descriptive/&#34; title=&#34;descriptive statistics&#34;&gt;descriptive analysis&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To conduct multiple imputation and linear regression analysis,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Click &lt;strong&gt;Analysis&lt;/strong&gt; at the top;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Regression&lt;/strong&gt; and select &lt;strong&gt;Linear Regression (Numberic outcome)&lt;/strong&gt; from the menu&lt;/li&gt;
&lt;li&gt;In the left panel, select &lt;em&gt;Depression&lt;/em&gt; into &lt;em&gt;Outcome&lt;/em&gt;, and select &lt;em&gt;Agreeableness&lt;/em&gt;, &lt;em&gt;Conscientiousness&lt;/em&gt;, &lt;em&gt;Extraversion&lt;/em&gt;, &lt;em&gt;Neuroticism&lt;/em&gt;, &lt;em&gt;Openness&lt;/em&gt; and &lt;em&gt;Sex&lt;/em&gt; into &lt;em&gt;Covariates&lt;/em&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Sex&lt;/strong&gt; is a categorical variable. If it is not yet coded as &lt;strong&gt;factor&lt;/strong&gt;, we will need to manually &lt;a href=&#34;https://statsnotebook.io/blog/data_management/variable_conversion/&#34; title=&#34;variable converstion&#34;&gt;convert it into a &lt;strong&gt;factor&lt;/strong&gt; variable&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/regression1.png&#34; alt=&#34;Regression in StatsNotebook&#34; title=&#34;Regression in StatsNotebook&#34;/&gt;&lt;/a&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;On the left panel, scroll down and expand the &lt;strong&gt;Analysis setting&lt;/strong&gt; panel. Check &lt;em&gt;Impute missing data&lt;/em&gt; and enter the number of imputation required. In this example, we request 35 imputations.
&lt;ul&gt;
&lt;li&gt;As a rule of thumb, the number of imputation should be close to the percentage of observations with missing data.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/regression_impute_missing.png&#34; alt=&#34;Multiple imputation and regression in StatsNotebook&#34; title=&#34;Multiple imputation and regression in StatsNotebook&#34;/&gt;&lt;/a&gt;

&lt;h4 id=&#34;r-codes-explained---multiple-imputation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#r-codes-explained---multiple-imputation&#34;&gt;R codes explained - Multiple imputation&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The following is from the top section of the generated codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#06287e&#34;&gt;library&lt;/span&gt;(mice)

formulas &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.formulas&lt;/span&gt;(currentDataset)

formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Agreeableness &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Agreeableness &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Extraversion &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Extraversion &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Neuroticism &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Neuroticism &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Openness &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Openness &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Sex &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Sex &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Depression
formulas&lt;span style=&#34;color:#666&#34;&gt;$&lt;/span&gt;Depression &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex

meth &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;make.method&lt;/span&gt;(currentDataset)
meth[&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Trait_anxiety&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
meth[&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;State_anxiety&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;

imputedDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;parlmice&lt;/span&gt;(currentDataset,
  method &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; meth,
  formulas &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; formulas,
  m &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;35&lt;/span&gt;,
  n.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;15&lt;/span&gt;, 
  n.imp.core &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;3&lt;/span&gt;)

&lt;span style=&#34;color:#06287e&#34;&gt;plot&lt;/span&gt;(imputedDataset)
currentDataset &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;complete&lt;/span&gt;(imputedDataset, action &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;long&amp;#34;&lt;/span&gt;, include &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;We use the &lt;strong&gt;mice&lt;/strong&gt; library in R to perform multiple imputation. The above codes firstly specifies how each variables are imputed. Only variables used in the regression analysis will be used for imputation. To include additional variables in the imputation, see the &lt;a href=&#34;https://statsnotebook.io/blog/analysis/multiple_imputation/&#34; title=&#34;Multiple imputation for missing data&#34;&gt;multiple imputation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The only visible output is a set of diagnostic plot. The lines in all plots should be freely intermingled. Non-convergence will be indicated by clearly separated lines.&lt;/p&gt;
&lt;img src=&#34;https://statsnotebook.io/blog/analysis/img/diagnostic_imputation.png&#34; alt=&#34;Diagnostic plot for imputation&#34; title=&#34;Diagnostic plot for imputation&#34;/&gt;&lt;/a&gt;
&lt;p&gt;The following codes are then used to conduct linear regression using the imputed datasets.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;color:#4070a0&#34;&gt;&amp;#34;Linear regression&amp;#34;&lt;/span&gt;
res &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#06287e&#34;&gt;with&lt;/span&gt;(imputedDataset,
  &lt;span style=&#34;color:#06287e&#34;&gt;lm&lt;/span&gt;(Depression &lt;span style=&#34;color:#666&#34;&gt;~&lt;/span&gt; Agreeableness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Conscientiousness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Extraversion &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Neuroticism &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Openness &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; Sex))
&lt;span style=&#34;color:#06287e&#34;&gt;summary&lt;/span&gt;(&lt;span style=&#34;color:#06287e&#34;&gt;pool&lt;/span&gt;(res), conf.int &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#007020;font-weight:bold&#34;&gt;TRUE&lt;/span&gt;, conf.level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#40a070&#34;&gt;0.95&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;br/&gt;
&lt;p&gt;Below is the output from this analysis.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;               term     estimate  std.error   statistic       df      p.value
1       (Intercept)  7.715447666 3.12663997  2.46764825 174.0538 1.456720e-02
2     Agreeableness -0.001189368 0.02497579 -0.04762083 158.8576 9.620782e-01
3 Conscientiousness -0.018990634 0.01964996 -0.96644620 130.7906 3.356046e-01
4      Extraversion -0.013549340 0.01559403 -0.86887995 176.7667 3.860910e-01
5       Neuroticism  0.128537235 0.01657551  7.75464787 165.6124 8.557599e-13
6          Openness -0.060743216 0.02205921 -2.75364405 134.9948 6.705879e-03
7           SexMale -1.227802866 0.76103616 -1.61333051 195.1378 1.082887e-01
        2.5 %      97.5 %
1  1.54443849 13.88645685
2 -0.05051680  0.04813806
3 -0.05786353  0.01988226
4 -0.04432377  0.01722509
5  0.09581069  0.16126378
6 -0.10436956 -0.01711687
7 -2.72871486  0.27310912
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;interpretation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#interpretation&#34;&gt;Interpretation&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In this example, the coefficients of the 5 personality traits from the analysis using imputation are similar to those from &lt;a href=&#34;https://statsnotebook.io/blog/analysis/regression/&#34; title=&#34;Linear regression&#34;&gt;complete data analysis&lt;/a&gt;. However, it should be noted that the p-value of &lt;em&gt;openness&lt;/em&gt; is now much smaller, indicating that the evidence for the association between openness and depression was stronger (despite the effect size being similar). This is due to increase power from multiple imputation.&lt;/p&gt;

&lt;h4 id=&#34;example-write-up&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#example-write-up&#34;&gt;Example Write-up&lt;/a&gt;&lt;/h4&gt;
&lt;br/&gt;
&lt;p&gt;Table 1. Results from linear regression.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Variables&lt;/th&gt;
&lt;th&gt;b&lt;/th&gt;
&lt;th&gt;95% CI&lt;/th&gt;
&lt;th&gt;p&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Agreeableness&lt;/td&gt;
&lt;td&gt;-0.00&lt;/td&gt;
&lt;td&gt;(-0.05, 0.05)&lt;/td&gt;
&lt;td&gt;0.962&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Conscientiousness&lt;/td&gt;
&lt;td&gt;-0.02&lt;/td&gt;
&lt;td&gt;(-0.02, 0.02)&lt;/td&gt;
&lt;td&gt;0.336&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Extraversion&lt;/td&gt;
&lt;td&gt;-0.01&lt;/td&gt;
&lt;td&gt;(-0.04, 0.02)&lt;/td&gt;
&lt;td&gt;0.386&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Neuroticism&lt;/td&gt;
&lt;td&gt;0.13&lt;/td&gt;
&lt;td&gt;(0.10, 0.16)&lt;/td&gt;
&lt;td&gt;&amp;lt; .001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Openness&lt;/td&gt;
&lt;td&gt;-0.06&lt;/td&gt;
&lt;td&gt;(-0.10, -0.02)&lt;/td&gt;
&lt;td&gt;.007&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Sex (Ref: Female)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;  Male&lt;/td&gt;
&lt;td&gt;-1.23&lt;/td&gt;
&lt;td&gt;(-2.73, 0.27)&lt;/td&gt;
&lt;td&gt;0.108&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The intial sample consists of 231 participants. Seventy six participants (33%) have missing data in at least one of the analysis variable. Thirty-five datasets were imputed using multiple imputation to fill in the missing values (Rubin, 2009). Linear regression is used to examine the association between depression and agreeableness, conscientiousness, extraversion, neuroticism, openness and sex. Results are shown in Table 1. Using a significance level of 0.05, results indicate that higher neuroticism (&lt;em&gt;b&lt;/em&gt; = 0.13, 95% CI [0.09, 0.16], &lt;em&gt;p&lt;/em&gt; &amp;lt; .001) and lower openness (&lt;em&gt;b&lt;/em&gt; = -0.06, 95% CI [-0.10, -0.02], &lt;em&gt;p&lt;/em&gt; = .007) are associated with depression. Other variables are not significantly associated with depression, and their effects are close to zero. Analyses are conducted in StatsNotebook (Chan and StatsNotebook Team, 2020) with R (R Core Team, 2020)&lt;/p&gt;

&lt;h4 id=&#34;model-diagnostic&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#model-diagnostic&#34;&gt;Model diagnostic&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;At the moment, model diagnostic is only based on the first imputed dataset. The interpretation for the model diagnostic is thus the same as those for analysis based on &lt;a href=&#34;https://statsnotebook.io/blog/analysis/regression/#r-codes-explained---model-diagnostic&#34;&gt;complete data analysis&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&#34;citation&#34; class=&#34;anchor-link&#34;&gt;&lt;a href=&#34;#citation&#34;&gt;Citation&lt;/a&gt;&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;Chan, G. and StatsNotebook Team (2020). StatsNotebook. [Computer Software]. Retrieved from https://www.statsnotebook.io
Chan, G (2020). Linear regression with missing data. Retrieved from https://www.statsnotebook.io/blog/analysis/regression_missingdata/
R Core Team (2020). The R Project for Statistical Computing. [Computer software]. Retrieved from https://r-project.org
Rubin, D. B. (2009). Multiple imputation for nonresponse in surveys. New York, John Wiley &amp;amp; Sons.
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
  </channel>
</rss>